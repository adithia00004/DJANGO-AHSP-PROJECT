# Production Environment Configuration
# CRITICAL: Never commit this file with real values!
# Copy to .env.production and fill in real values

# ============================================================================
# Django Core Settings
# ============================================================================

DJANGO_ENV=production
DJANGO_DEBUG=False

# CRITICAL: Generate a secure secret key
# Python command: python -c 'from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())'
DJANGO_SECRET_KEY=replace-me-with-a-secure-50-character-random-string

# Production domain(s)
DJANGO_ALLOWED_HOSTS=example.com,www.example.com,api.example.com

# CSRF trusted origins (HTTPS URLs)
DJANGO_CSRF_TRUSTED_ORIGINS=https://example.com,https://www.example.com,https://api.example.com

# Application version (for health checks and monitoring)
APP_VERSION=1.0.0


# ============================================================================
# Database Configuration (PostgreSQL)
# ============================================================================

POSTGRES_DB=ahsp_sni_db
POSTGRES_USER=postgres
POSTGRES_PASSWORD=CHANGE-ME-strong-random-password-min-32-chars
POSTGRES_HOST=postgres
POSTGRES_PORT=5432

# Connection pool settings
POSTGRES_CONN_MAX_AGE=600


# ============================================================================
# Redis Cache Configuration (REQUIRED)
# ============================================================================

# Redis connection URL
# For Redis with authentication: redis://:password@host:port/db
# For Redis Sentinel: redis-sentinel://host:port/db
REDIS_URL=redis://redis:6379/1

# Redis password (HIGHLY RECOMMENDED for production)
REDIS_PASSWORD=CHANGE-ME-redis-password

# Connection pool settings
REDIS_MAX_CONNECTIONS=100


# ============================================================================
# Gunicorn Configuration
# ============================================================================

# Number of workers: (2 x CPU cores) + 1
# For 4 CPU cores: 9 workers
GUNICORN_WORKERS=9

# Worker timeout (seconds) - increase for long operations
GUNICORN_TIMEOUT=120

# Bind address (usually 0.0.0.0:8000 behind Nginx)
GUNICORN_BIND=0.0.0.0:8000

# Worker class (sync for Django, gevent for async)
GUNICORN_WORKER_CLASS=sync

# Max requests per worker (prevents memory leaks)
GUNICORN_MAX_REQUESTS=1000
GUNICORN_MAX_REQUESTS_JITTER=50

# Logging
GUNICORN_LOG_LEVEL=warning
GUNICORN_ACCESS_LOG=-
GUNICORN_ERROR_LOG=-

# Process name
GUNICORN_PROC_NAME=ahsp-production

# Preload application (faster worker spawn)
GUNICORN_PRELOAD=True


# ============================================================================
# Logging & Monitoring
# ============================================================================

DJANGO_LOG_LEVEL=WARNING
DJANGO_PERF_THRESHOLD=1.0

# Sentry DSN (error tracking)
# Get from https://sentry.io
SENTRY_DSN=

# Sentry environment
SENTRY_ENVIRONMENT=production

# Sentry traces sample rate (0.0 to 1.0)
SENTRY_TRACES_SAMPLE_RATE=0.1


# ============================================================================
# Email Configuration
# ============================================================================

DJANGO_EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend
DJANGO_DEFAULT_FROM_EMAIL=no-reply@example.com
DJANGO_SERVER_EMAIL=server@example.com

# SMTP settings
EMAIL_HOST=smtp.example.com
EMAIL_PORT=587
EMAIL_HOST_USER=smtp-user@example.com
EMAIL_HOST_PASSWORD=CHANGE-ME-smtp-password
EMAIL_USE_TLS=True
EMAIL_USE_SSL=False


# ============================================================================
# Static & Media Files
# ============================================================================

# Static files root (collected by collectstatic)
DJANGO_STATIC_ROOT=/var/www/ahsp/static

# Media files root (user uploads)
DJANGO_MEDIA_ROOT=/var/www/ahsp/media

# CDN URLs (optional)
# DJANGO_STATIC_URL=https://cdn.example.com/static/
# DJANGO_MEDIA_URL=https://cdn.example.com/media/


# ============================================================================
# Security Settings (Production)
# ============================================================================

# HTTPS enforcement
DJANGO_SECURE_SSL_REDIRECT=True
DJANGO_SESSION_COOKIE_SECURE=True
DJANGO_CSRF_COOKIE_SECURE=True

# HSTS settings (HTTPS strict transport security)
DJANGO_SECURE_HSTS_SECONDS=31536000
DJANGO_SECURE_HSTS_INCLUDE_SUBDOMAINS=True
DJANGO_SECURE_HSTS_PRELOAD=True

# Other security headers
DJANGO_SECURE_CONTENT_TYPE_NOSNIFF=True
DJANGO_SECURE_BROWSER_XSS_FILTER=True
DJANGO_X_FRAME_OPTIONS=DENY

# Session settings
DJANGO_SESSION_COOKIE_HTTPONLY=True
DJANGO_SESSION_COOKIE_SAMESITE=Lax
DJANGO_SESSION_COOKIE_AGE=86400


# ============================================================================
# Rate Limiting Configuration
# ============================================================================

RATE_LIMITING_ENABLED=True

# Stricter production limits
RATE_LIMIT_DEFAULT_MAX_REQUESTS=50
RATE_LIMIT_DEFAULT_WINDOW=60

# Per-category limits (optional overrides)
RATE_LIMIT_BULK_MAX_REQUESTS=5
RATE_LIMIT_BULK_WINDOW=300
RATE_LIMIT_WRITE_MAX_REQUESTS=20
RATE_LIMIT_WRITE_WINDOW=60
RATE_LIMIT_READ_MAX_REQUESTS=100
RATE_LIMIT_READ_WINDOW=60


# ============================================================================
# Backup & Maintenance
# ============================================================================

# Backup retention (days)
BACKUP_RETENTION_DAYS=30

# Maintenance mode
MAINTENANCE_MODE=False

# Feature flags
FEATURE_DEEP_COPY_ENABLED=True
FEATURE_BATCH_OPERATIONS_ENABLED=True
FEATURE_EXPORT_PDF_ENABLED=True


# ============================================================================
# Third-Party Integrations
# ============================================================================

# AWS credentials (if using S3 for static/media files)
# AWS_ACCESS_KEY_ID=
# AWS_SECRET_ACCESS_KEY=
# AWS_STORAGE_BUCKET_NAME=
# AWS_S3_REGION_NAME=ap-southeast-1
