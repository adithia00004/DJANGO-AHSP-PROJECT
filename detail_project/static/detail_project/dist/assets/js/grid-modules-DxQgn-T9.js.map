{"version":3,"file":"grid-modules-DxQgn-T9.js","sources":["../../../js/src/modules/shared/event-delegation.js","../../../js/src/modules/shared/performance-utils.js","../../../js/src/modules/shared/validation-utils.js","../../../js/src/modules/grid/grid-event-handlers.js","../../../js/src/modules/grid/column-definitions.js","../../../js/src/modules/grid/ag-grid-setup.js"],"sourcesContent":["/**\n * Event Delegation Module\n * Provides memory-efficient event handling using delegation pattern\n * Prevents memory leaks from thousands of individual event listeners\n * License: MIT\n */\n\n/**\n * Event Delegation Manager\n * Manages delegated event listeners on a parent element\n */\nexport class EventDelegationManager {\n  constructor(rootElement) {\n    this.rootElement = rootElement;\n    this.handlers = new Map(); // event type -> array of handler configs\n    this.activeListeners = new Map(); // event type -> actual listener function\n  }\n\n  /**\n   * Registers a delegated event handler\n   *\n   * @param {string} eventType - Event type (e.g., 'click', 'input')\n   * @param {string} selector - CSS selector to match target elements\n   * @param {Function} handler - Event handler function\n   * @param {Object} options - Configuration options\n   * @param {boolean} options.capture - Use capture phase\n   * @param {boolean} options.passive - Mark as passive listener\n   *\n   * @example\n   * manager.on('click', '.time-cell.editable', (event, target) => {\n   *   console.log('Clicked cell:', target.dataset.cellId);\n   * });\n   */\n  on(eventType, selector, handler, options = {}) {\n    if (!this.handlers.has(eventType)) {\n      this.handlers.set(eventType, []);\n      this._attachListener(eventType, options);\n    }\n\n    this.handlers.get(eventType).push({\n      selector,\n      handler,\n      options,\n    });\n  }\n\n  /**\n   * Removes a delegated event handler\n   *\n   * @param {string} eventType - Event type\n   * @param {string} selector - CSS selector\n   * @param {Function} handler - Handler function to remove\n   */\n  off(eventType, selector, handler) {\n    if (!this.handlers.has(eventType)) {\n      return;\n    }\n\n    const handlers = this.handlers.get(eventType);\n    const index = handlers.findIndex(\n      (h) => h.selector === selector && h.handler === handler\n    );\n\n    if (index !== -1) {\n      handlers.splice(index, 1);\n\n      // If no more handlers for this event type, remove the listener\n      if (handlers.length === 0) {\n        this._detachListener(eventType);\n        this.handlers.delete(eventType);\n      }\n    }\n  }\n\n  /**\n   * Removes all handlers for an event type\n   *\n   * @param {string} eventType - Event type to clear\n   */\n  clearEvent(eventType) {\n    if (!this.handlers.has(eventType)) {\n      return;\n    }\n\n    this._detachListener(eventType);\n    this.handlers.delete(eventType);\n  }\n\n  /**\n   * Removes all handlers and cleans up\n   */\n  destroy() {\n    for (const eventType of this.handlers.keys()) {\n      this._detachListener(eventType);\n    }\n\n    this.handlers.clear();\n    this.activeListeners.clear();\n    this.rootElement = null;\n  }\n\n  /**\n   * Internal: Attaches the actual event listener to root element\n   */\n  _attachListener(eventType, options = {}) {\n    const listener = (event) => {\n      const handlers = this.handlers.get(eventType) || [];\n\n      for (const { selector, handler } of handlers) {\n        // Find the matching target (could be event.target or an ancestor)\n        const target = event.target.closest(selector);\n\n        if (target && this.rootElement.contains(target)) {\n          handler.call(target, event, target);\n        }\n      }\n    };\n\n    this.rootElement.addEventListener(eventType, listener, {\n      capture: options.capture || false,\n      passive: options.passive || false,\n    });\n\n    this.activeListeners.set(eventType, listener);\n  }\n\n  /**\n   * Internal: Detaches the event listener from root element\n   */\n  _detachListener(eventType) {\n    const listener = this.activeListeners.get(eventType);\n\n    if (listener) {\n      this.rootElement.removeEventListener(eventType, listener);\n      this.activeListeners.delete(eventType);\n    }\n  }\n}\n\n/**\n * Simplified event delegation helper function\n *\n * @param {HTMLElement} rootElement - Parent element to attach listener to\n * @param {string} eventType - Event type (e.g., 'click')\n * @param {string} selector - CSS selector for target elements\n * @param {Function} handler - Event handler\n * @param {Object} options - Event options\n * @returns {Function} Cleanup function\n *\n * @example\n * const cleanup = delegate(\n *   document.getElementById('grid-container'),\n *   'click',\n *   '.time-cell',\n *   (event, target) => {\n *     handleCellClick(target);\n *   }\n * );\n *\n * // Later, to cleanup:\n * cleanup();\n */\nexport function delegate(rootElement, eventType, selector, handler, options = {}) {\n  const listener = (event) => {\n    const target = event.target.closest(selector);\n\n    if (target && rootElement.contains(target)) {\n      handler.call(target, event, target);\n    }\n  };\n\n  rootElement.addEventListener(eventType, listener, options);\n\n  // Return cleanup function\n  return () => {\n    rootElement.removeEventListener(eventType, listener);\n  };\n}\n\n/**\n * Creates multiple delegated event listeners and returns cleanup function\n *\n * @param {HTMLElement} rootElement - Parent element\n * @param {Object} eventMap - Map of event configs\n * @returns {Function} Cleanup function for all listeners\n *\n * @example\n * const cleanup = delegateMultiple(gridContainer, {\n *   click: {\n *     '.time-cell': handleCellClick,\n *     '.expand-btn': handleExpand,\n *   },\n *   input: {\n *     '.time-cell input': handleInput,\n *   },\n *   blur: {\n *     '.time-cell input': handleBlur,\n *   },\n * });\n *\n * // Cleanup all listeners\n * cleanup();\n */\nexport function delegateMultiple(rootElement, eventMap) {\n  const cleanupFunctions = [];\n\n  for (const [eventType, selectorHandlers] of Object.entries(eventMap)) {\n    for (const [selector, handler] of Object.entries(selectorHandlers)) {\n      const cleanup = delegate(rootElement, eventType, selector, handler);\n      cleanupFunctions.push(cleanup);\n    }\n  }\n\n  // Return function that cleans up all listeners\n  return () => {\n    cleanupFunctions.forEach((cleanup) => cleanup());\n  };\n}\n\n/**\n * Safely removes old event listeners from an element\n * Useful for cleaning up before re-attaching new listeners\n *\n * @param {HTMLElement} element - Element to clean\n *\n * @example\n * cleanupEventListeners(gridContainer);\n * // Now safe to attach new listeners without duplicates\n */\nexport function cleanupEventListeners(element) {\n  if (!element || !element._delegatedHandlers) {\n    return;\n  }\n\n  const handlers = element._delegatedHandlers || [];\n\n  handlers.forEach(({ event, handler, options }) => {\n    element.removeEventListener(event, handler, options);\n  });\n\n  delete element._delegatedHandlers;\n}\n\n/**\n * Stores event listener references for later cleanup\n *\n * @param {HTMLElement} element - Element to track\n * @param {string} eventType - Event type\n * @param {Function} handler - Handler function\n * @param {Object} options - Event options\n */\nexport function trackEventListener(element, eventType, handler, options = {}) {\n  if (!element._delegatedHandlers) {\n    element._delegatedHandlers = [];\n  }\n\n  element._delegatedHandlers.push({\n    event: eventType,\n    handler,\n    options,\n  });\n}\n\n/**\n * One-time event listener with automatic cleanup\n *\n * @param {HTMLElement} element - Element to listen on\n * @param {string} eventType - Event type\n * @param {Function} handler - Handler function\n *\n * @example\n * once(saveButton, 'click', () => {\n *   console.log('This will only fire once');\n * });\n */\nexport function once(element, eventType, handler) {\n  const onceHandler = (event) => {\n    handler(event);\n    element.removeEventListener(eventType, onceHandler);\n  };\n\n  element.addEventListener(eventType, onceHandler);\n\n  return () => {\n    element.removeEventListener(eventType, onceHandler);\n  };\n}\n","/**\n * Performance Utilities Module\n * Provides debounce, throttle, and requestAnimationFrame helpers\n * License: MIT\n */\n\n/**\n * Debounces a function - delays execution until after wait time has elapsed\n * since the last call. Useful for input events, window resize.\n *\n * @param {Function} func - Function to debounce\n * @param {number} wait - Wait time in milliseconds\n * @param {boolean} immediate - Execute on leading edge instead of trailing\n * @returns {Function} Debounced function\n *\n * @example\n * const debouncedSearch = debounce((query) => {\n *   console.log('Searching for:', query);\n * }, 300);\n *\n * input.addEventListener('input', (e) => debouncedSearch(e.target.value));\n */\nexport function debounce(func, wait, immediate = false) {\n  let timeout;\n\n  const debounced = function (...args) {\n    const context = this;\n\n    const later = () => {\n      timeout = null;\n      if (!immediate) {\n        func.apply(context, args);\n      }\n    };\n\n    const callNow = immediate && !timeout;\n\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n\n    if (callNow) {\n      func.apply(context, args);\n    }\n  };\n\n  // Cancel method to clear pending execution\n  debounced.cancel = () => {\n    clearTimeout(timeout);\n    timeout = null;\n  };\n\n  return debounced;\n}\n\n/**\n * Throttles a function - ensures it's called at most once per specified time period.\n * Useful for scroll events, mousemove.\n *\n * @param {Function} func - Function to throttle\n * @param {number} limit - Minimum time between calls in milliseconds\n * @param {Object} options - Configuration options\n * @param {boolean} options.leading - Execute on leading edge (default: true)\n * @param {boolean} options.trailing - Execute on trailing edge (default: true)\n * @returns {Function} Throttled function\n *\n * @example\n * const throttledScroll = throttle(() => {\n *   console.log('Scroll position:', window.scrollY);\n * }, 16); // ~60fps\n *\n * window.addEventListener('scroll', throttledScroll);\n */\nexport function throttle(func, limit, options = {}) {\n  const { leading = true, trailing = true } = options;\n\n  let inThrottle;\n  let lastFunc;\n  let lastRan;\n\n  const throttled = function (...args) {\n    const context = this;\n\n    if (!inThrottle) {\n      if (leading) {\n        func.apply(context, args);\n        lastRan = Date.now();\n      }\n      inThrottle = true;\n    } else {\n      clearTimeout(lastFunc);\n      lastFunc = setTimeout(() => {\n        if (Date.now() - lastRan >= limit) {\n          if (trailing) {\n            func.apply(context, args);\n          }\n          lastRan = Date.now();\n        }\n      }, Math.max(limit - (Date.now() - lastRan), 0));\n    }\n\n    setTimeout(() => {\n      inThrottle = false;\n    }, limit);\n  };\n\n  // Cancel method to clear pending execution\n  throttled.cancel = () => {\n    clearTimeout(lastFunc);\n    inThrottle = false;\n  };\n\n  return throttled;\n}\n\n/**\n * requestAnimationFrame-based throttle for smooth animations\n * Ensures function is called at most once per animation frame (~60fps)\n *\n * @param {Function} func - Function to throttle\n * @returns {Function} RAF-throttled function\n *\n * @example\n * const rafScroll = rafThrottle(() => {\n *   // Sync scroll positions\n *   rightContainer.scrollLeft = leftContainer.scrollLeft;\n * });\n *\n * leftContainer.addEventListener('scroll', rafScroll);\n */\nexport function rafThrottle(func) {\n  let rafId = null;\n  let lastArgs = null;\n\n  const throttled = function (...args) {\n    lastArgs = args;\n\n    if (rafId === null) {\n      rafId = requestAnimationFrame(() => {\n        func.apply(this, lastArgs);\n        rafId = null;\n        lastArgs = null;\n      });\n    }\n  };\n\n  // Cancel method to clear pending execution\n  throttled.cancel = () => {\n    if (rafId !== null) {\n      cancelAnimationFrame(rafId);\n      rafId = null;\n      lastArgs = null;\n    }\n  };\n\n  return throttled;\n}\n\n/**\n * Batches multiple synchronous DOM reads/writes to prevent layout thrashing\n *\n * @param {Function} readFunc - Function that reads from DOM\n * @param {Function} writeFunc - Function that writes to DOM\n *\n * @example\n * batchDOMOperations(\n *   () => {\n *     // Read phase\n *     const width = element.offsetWidth;\n *     return { width };\n *   },\n *   (readResults) => {\n *     // Write phase\n *     element.style.height = readResults.width + 'px';\n *   }\n * );\n */\nexport function batchDOMOperations(readFunc, writeFunc) {\n  requestAnimationFrame(() => {\n    const readResults = readFunc();\n\n    requestAnimationFrame(() => {\n      writeFunc(readResults);\n    });\n  });\n}\n\n/**\n * Creates a performance monitor for measuring execution time\n *\n * @param {string} label - Label for the measurement\n * @returns {Object} Monitor object with start/end methods\n *\n * @example\n * const monitor = createPerformanceMonitor('Grid Render');\n * monitor.start();\n * // ... expensive operation\n * const duration = monitor.end(); // Returns duration in ms\n */\nexport function createPerformanceMonitor(label) {\n  let startTime = null;\n\n  return {\n    start() {\n      startTime = performance.now();\n      if (typeof performance.mark === 'function') {\n        performance.mark(`${label}-start`);\n      }\n    },\n\n    end() {\n      if (startTime === null) {\n        console.warn(`Performance monitor \"${label}\" was not started`);\n        return 0;\n      }\n\n      const endTime = performance.now();\n      const duration = endTime - startTime;\n\n      if (typeof performance.mark === 'function') {\n        performance.mark(`${label}-end`);\n        performance.measure(label, `${label}-start`, `${label}-end`);\n      }\n\n      console.log(`⏱️ ${label}: ${duration.toFixed(2)}ms`);\n      startTime = null;\n\n      return duration;\n    },\n\n    cancel() {\n      startTime = null;\n    },\n  };\n}\n\n/**\n * Idle callback wrapper with fallback for browsers that don't support it\n *\n * @param {Function} callback - Function to execute when idle\n * @param {Object} options - Configuration options\n * @param {number} options.timeout - Maximum wait time in ms\n *\n * @example\n * requestIdleCallback(() => {\n *   // Perform non-critical work during idle time\n *   preloadNextPageData();\n * }, { timeout: 2000 });\n */\nexport function requestIdleCallback(callback, options = {}) {\n  if (typeof window.requestIdleCallback === 'function') {\n    return window.requestIdleCallback(callback, options);\n  }\n\n  // Fallback for browsers without requestIdleCallback\n  const timeout = options.timeout || 1;\n  const start = Date.now();\n\n  return setTimeout(() => {\n    callback({\n      didTimeout: false,\n      timeRemaining: () => Math.max(0, 50 - (Date.now() - start)),\n    });\n  }, timeout);\n}\n\n/**\n * Cancels an idle callback\n *\n * @param {number} id - ID returned from requestIdleCallback\n */\nexport function cancelIdleCallback(id) {\n  if (typeof window.cancelIdleCallback === 'function') {\n    window.cancelIdleCallback(id);\n  } else {\n    clearTimeout(id);\n  }\n}\n","/**\n * Validation Utilities Module\n * Provides real-time validation with visual feedback for jadwal kegiatan\n * License: MIT\n */\n\n/**\n * Validation result structure\n * @typedef {Object} ValidationResult\n * @property {boolean} isValid - Whether validation passed\n * @property {string} message - Validation message\n * @property {string} level - Severity level: 'error', 'warning', 'info'\n * @property {any} value - Validated/corrected value\n */\n\n/**\n * Validates a single cell percentage value\n *\n * @param {any} value - Value to validate\n * @param {Object} options - Validation options\n * @param {number} options.min - Minimum value (default: 0)\n * @param {number} options.max - Maximum value (default: 100)\n * @param {number} options.precision - Decimal precision (default: 1)\n * @returns {ValidationResult}\n *\n * @example\n * const result = validateCellValue('95.5', { min: 0, max: 100 });\n * if (!result.isValid) {\n *   showToast(result.message, 'danger');\n * }\n */\nexport function validateCellValue(value, options = {}) {\n  const { min = 0, max = 100, precision = 1 } = options;\n\n  // Handle empty values\n  if (value === null || value === undefined || value === '') {\n    return {\n      isValid: true,\n      message: '',\n      level: 'info',\n      value: 0,\n    };\n  }\n\n  // Convert to number\n  const numValue = parseFloat(value);\n\n  // Check if it's a valid number\n  if (isNaN(numValue)) {\n    return {\n      isValid: false,\n      message: `Nilai harus berupa angka (0-${max})`,\n      level: 'error',\n      value: 0,\n    };\n  }\n\n  // Check range\n  if (numValue < min) {\n    return {\n      isValid: false,\n      message: `Nilai tidak boleh kurang dari ${min}`,\n      level: 'error',\n      value: min,\n    };\n  }\n\n  if (numValue > max) {\n    return {\n      isValid: false,\n      message: `Nilai tidak boleh lebih dari ${max}`,\n      level: 'error',\n      value: max,\n    };\n  }\n\n  // Round to precision\n  const roundedValue = Math.round(numValue * Math.pow(10, precision)) / Math.pow(10, precision);\n\n  return {\n    isValid: true,\n    message: '',\n    level: 'info',\n    value: roundedValue,\n  };\n}\n\n/**\n * Validates total progress across all weeks for a single pekerjaan\n *\n * @param {Array<number>} weeklyValues - Array of weekly percentage values\n * @param {Object} options - Validation options\n * @param {number} options.maxTotal - Maximum total (default: 100)\n * @param {number} options.tolerance - Tolerance for rounding errors (default: 0.1)\n * @returns {ValidationResult}\n *\n * @example\n * const weekValues = [20, 30, 25, 25]; // Total = 100\n * const result = validateTotalProgress(weekValues);\n * if (result.level === 'warning') {\n *   showWarningIndicator(pekerjaanId, result.message);\n * }\n */\nexport function validateTotalProgress(weeklyValues, options = {}) {\n  const { maxTotal = 100, tolerance = 0.1 } = options;\n\n  const total = weeklyValues.reduce((sum, val) => sum + (parseFloat(val) || 0), 0);\n  const roundedTotal = Math.round(total * 10) / 10;\n\n  // Perfect total\n  if (Math.abs(roundedTotal - maxTotal) < tolerance) {\n    return {\n      isValid: true,\n      message: `Total: ${roundedTotal}%`,\n      level: 'info',\n      value: roundedTotal,\n    };\n  }\n\n  // Over 100%\n  if (roundedTotal > maxTotal) {\n    return {\n      isValid: false,\n      message: `Total melebihi ${maxTotal}% (${roundedTotal}%)`,\n      level: 'error',\n      value: roundedTotal,\n    };\n  }\n\n  // Under 100%\n  if (roundedTotal < maxTotal - tolerance) {\n    return {\n      isValid: false,\n      message: `Total kurang dari ${maxTotal}% (${roundedTotal}%)`,\n      level: 'warning',\n      value: roundedTotal,\n    };\n  }\n\n  return {\n    isValid: true,\n    message: `Total: ${roundedTotal}%`,\n    level: 'info',\n    value: roundedTotal,\n  };\n}\n\n/**\n * Applies visual feedback to a cell based on validation result\n *\n * @param {HTMLElement} cellElement - Cell DOM element\n * @param {ValidationResult} validationResult - Validation result\n * @param {Object} options - Display options\n * @param {boolean} options.showTooltip - Show tooltip with message\n * @param {number} options.tooltipDuration - Duration to show tooltip (ms)\n *\n * @example\n * const cell = document.querySelector('.time-cell');\n * const result = validateCellValue(95.5);\n * applyValidationFeedback(cell, result, { showTooltip: true });\n */\nexport function applyValidationFeedback(cellElement, validationResult, options = {}) {\n  const { showTooltip = true, tooltipDuration = 3000 } = options;\n\n  // Remove existing validation classes\n  cellElement.classList.remove(\n    'validation-error',\n    'validation-warning',\n    'validation-success'\n  );\n\n  // Remove existing tooltip\n  const existingTooltip = cellElement.querySelector('.validation-tooltip');\n  if (existingTooltip) {\n    existingTooltip.remove();\n  }\n\n  // Apply new validation class\n  if (!validationResult.isValid) {\n    if (validationResult.level === 'error') {\n      cellElement.classList.add('validation-error');\n    } else if (validationResult.level === 'warning') {\n      cellElement.classList.add('validation-warning');\n    }\n\n    // Show tooltip if enabled and there's a message\n    if (showTooltip && validationResult.message) {\n      const tooltip = document.createElement('div');\n      tooltip.className = `validation-tooltip validation-tooltip-${validationResult.level}`;\n      tooltip.textContent = validationResult.message;\n\n      cellElement.style.position = 'relative';\n      cellElement.appendChild(tooltip);\n\n      // Auto-remove after duration\n      if (tooltipDuration > 0) {\n        setTimeout(() => {\n          tooltip.remove();\n        }, tooltipDuration);\n      }\n    }\n  } else {\n    cellElement.classList.add('validation-success');\n  }\n}\n\n/**\n * Updates progress indicator for a pekerjaan row\n *\n * @param {string} pekerjaanId - Pekerjaan ID\n * @param {number} totalProgress - Total progress percentage\n * @param {Object} state - Application state object\n *\n * @example\n * updateProgressIndicator('pekerjaan-123', 95.5, state);\n */\nexport function updateProgressIndicator(pekerjaanId, totalProgress, state) {\n  const row = document.querySelector(`[data-pekerjaan-id=\"${pekerjaanId}\"]`);\n  if (!row) return;\n\n  const indicator = row.querySelector('.progress-indicator') || createProgressIndicator(row);\n\n  const validationResult = validateTotalProgress([totalProgress], { maxTotal: 100 });\n\n  // Update indicator appearance\n  indicator.textContent = `${totalProgress.toFixed(1)}%`;\n  indicator.className = 'progress-indicator';\n\n  if (validationResult.level === 'error') {\n    indicator.classList.add('progress-error');\n  } else if (validationResult.level === 'warning') {\n    indicator.classList.add('progress-warning');\n  } else {\n    indicator.classList.add('progress-success');\n  }\n\n  // Update state\n  if (state && state.progressTotals) {\n    state.progressTotals.set(pekerjaanId, totalProgress);\n  }\n}\n\n/**\n * Creates a progress indicator element if it doesn't exist\n *\n * @param {HTMLElement} rowElement - Row element\n * @returns {HTMLElement} Progress indicator element\n */\nfunction createProgressIndicator(rowElement) {\n  const nameCell = rowElement.querySelector('.name-cell');\n  if (!nameCell) return null;\n\n  const indicator = document.createElement('span');\n  indicator.className = 'progress-indicator';\n  nameCell.appendChild(indicator);\n\n  return indicator;\n}\n\n/**\n * Batch validates all cells in the grid\n *\n * @param {Map} modifiedCells - Map of cell changes (cellKey -> value)\n * @param {Object} state - Application state\n * @returns {Object} Validation summary\n *\n * @example\n * const summary = batchValidateGrid(state.modifiedCells, state);\n * if (summary.errorCount > 0) {\n *   showToast(`${summary.errorCount} error(s) found`, 'danger');\n *   return false;\n * }\n */\nexport function batchValidateGrid(modifiedCells, state) {\n  const summary = {\n    totalCells: 0,\n    validCells: 0,\n    errorCount: 0,\n    warningCount: 0,\n    errors: [],\n    warnings: [],\n  };\n\n  // Group cells by pekerjaan ID for total progress validation\n  const pekerjaanGroups = new Map();\n\n  for (const [cellKey, value] of modifiedCells.entries()) {\n    const [pekerjaanId, weekId] = cellKey.split('-');\n\n    // Validate individual cell\n    const cellResult = validateCellValue(value);\n    summary.totalCells++;\n\n    if (cellResult.isValid) {\n      summary.validCells++;\n    } else {\n      if (cellResult.level === 'error') {\n        summary.errorCount++;\n        summary.errors.push({ cellKey, message: cellResult.message });\n      } else if (cellResult.level === 'warning') {\n        summary.warningCount++;\n        summary.warnings.push({ cellKey, message: cellResult.message });\n      }\n    }\n\n    // Group by pekerjaan\n    if (!pekerjaanGroups.has(pekerjaanId)) {\n      pekerjaanGroups.set(pekerjaanId, []);\n    }\n    pekerjaanGroups.get(pekerjaanId).push(cellResult.value);\n  }\n\n  // Validate total progress for each pekerjaan\n  for (const [pekerjaanId, values] of pekerjaanGroups.entries()) {\n    const totalResult = validateTotalProgress(values);\n\n    if (!totalResult.isValid) {\n      if (totalResult.level === 'error') {\n        summary.errorCount++;\n        summary.errors.push({\n          cellKey: pekerjaanId,\n          message: `Pekerjaan ${pekerjaanId}: ${totalResult.message}`,\n        });\n      } else if (totalResult.level === 'warning') {\n        summary.warningCount++;\n        summary.warnings.push({\n          cellKey: pekerjaanId,\n          message: `Pekerjaan ${pekerjaanId}: ${totalResult.message}`,\n        });\n      }\n    }\n\n    // Update visual indicator\n    updateProgressIndicator(pekerjaanId, totalResult.value, state);\n  }\n\n  return summary;\n}\n\n/**\n * Shows validation summary in a toast notification\n *\n * @param {Object} summary - Validation summary from batchValidateGrid\n * @param {Function} showToast - Toast notification function\n *\n * @example\n * const summary = batchValidateGrid(state.modifiedCells, state);\n * showValidationSummary(summary, window.showToast);\n */\nexport function showValidationSummary(summary, showToast) {\n  if (summary.errorCount > 0) {\n    const errorMessages = summary.errors.slice(0, 3).map((e) => e.message).join('<br>');\n    const more = summary.errorCount > 3 ? `<br>...dan ${summary.errorCount - 3} error lainnya` : '';\n\n    showToast(`❌ ${summary.errorCount} Error:<br>${errorMessages}${more}`, 'danger', 5000);\n    return false;\n  }\n\n  if (summary.warningCount > 0) {\n    showToast(`⚠️ ${summary.warningCount} Warning - periksa total progress`, 'warning', 4000);\n  } else {\n    showToast(`✅ Validasi sukses (${summary.totalCells} sel)`, 'success', 2000);\n  }\n\n  return true;\n}\n\n/**\n * Real-time cell validation handler (use with event delegation)\n *\n * @param {Event} event - Input event\n * @param {HTMLElement} cellElement - Cell element\n * @param {Object} state - Application state\n *\n * @example\n * eventManager.on('blur', '.time-cell input', (event, target) => {\n *   const cell = target.closest('.time-cell');\n *   handleCellValidation(event, cell, state);\n * });\n */\nexport function handleCellValidation(event, cellElement, state) {\n  const input = event.target;\n  const value = input.value;\n\n  // Validate the cell value\n  const result = validateCellValue(value);\n\n  // Apply visual feedback\n  applyValidationFeedback(cellElement, result, {\n    showTooltip: !result.isValid,\n    tooltipDuration: 3000,\n  });\n\n  // Update the value to validated/corrected value\n  if (result.isValid || result.value !== parseFloat(value)) {\n    input.value = result.value;\n\n    // Update state\n    const cellKey = cellElement.dataset.cellId;\n    if (cellKey && state.modifiedCells) {\n      state.modifiedCells.set(cellKey, result.value);\n    }\n  }\n\n  // Show toast for errors\n  if (!result.isValid && result.level === 'error') {\n    if (typeof window.showToast === 'function') {\n      window.showToast(result.message, 'danger', 3000);\n    }\n  }\n\n  return result;\n}\n","/**\n * Grid Event Handlers Module (Refactored with Event Delegation)\n * Fixes memory leaks by using event delegation pattern\n * License: MIT\n */\n\nimport { EventDelegationManager, cleanupEventListeners } from '@shared/event-delegation.js';\nimport { rafThrottle } from '@shared/performance-utils.js';\nimport { handleCellValidation } from '@shared/validation-utils.js';\n\n/**\n * Grid Event Manager\n * Manages all grid events using efficient delegation pattern\n */\nexport class GridEventManager {\n  constructor(state, helpers) {\n    this.state = state;\n    this.helpers = helpers;\n    this.eventManagers = new Map();\n    this.scrollHandlers = new Map();\n  }\n\n  /**\n   * Attaches all grid event listeners using delegation\n   */\n  attachEvents() {\n    const leftTbody = this.state.domRefs?.leftTbody || document.getElementById('left-tbody');\n    const rightTbody = this.state.domRefs?.rightTbody || document.getElementById('right-tbody');\n    const leftScroll = this.state.domRefs?.leftPanelScroll || document.querySelector('.left-panel-scroll');\n    const rightScroll = this.state.domRefs?.rightPanelScroll || document.querySelector('.right-panel-scroll');\n\n    if (!leftTbody || !rightTbody) {\n      console.error('Grid containers not found');\n      return false;\n    }\n\n    // Clean up any existing listeners\n    this.cleanup();\n\n    // Setup left panel events (tree toggles, expand/collapse)\n    this._setupLeftPanelEvents(leftTbody);\n\n    // Setup right panel events (cell editing)\n    this._setupRightPanelEvents(rightTbody);\n\n    // Setup scroll synchronization\n    if (leftScroll && rightScroll) {\n      this._setupScrollSync(leftScroll, rightScroll);\n    }\n\n    return true;\n  }\n\n  /**\n   * Setup left panel event delegation\n   */\n  _setupLeftPanelEvents(container) {\n    const leftManager = new EventDelegationManager(container);\n\n    // Tree toggle clicks\n    leftManager.on('click', '.tree-toggle', (event, target) => {\n      this._handleTreeToggle(event, target);\n    });\n\n    // Row selection (optional feature)\n    leftManager.on('click', '.name-cell', (event, target) => {\n      this._handleRowSelection(event, target);\n    });\n\n    this.eventManagers.set('left-panel', leftManager);\n  }\n\n  /**\n   * Setup right panel event delegation (cell editing)\n   */\n  _setupRightPanelEvents(container) {\n    const rightManager = new EventDelegationManager(container);\n\n    // Cell click (single click - select)\n    rightManager.on('click', '.time-cell.editable', (event, target) => {\n      this._handleCellClick(event, target);\n    });\n\n    // Cell double-click (enter edit mode)\n    rightManager.on('dblclick', '.time-cell.editable', (event, target) => {\n      this._handleCellDoubleClick(event, target);\n    });\n\n    // Input events on cell inputs (with validation)\n    rightManager.on('input', '.time-cell input', (event, target) => {\n      this._handleCellInput(event, target);\n    });\n\n    // Blur events (validate and save)\n    rightManager.on('blur', '.time-cell input', (event, target) => {\n      this._handleCellBlur(event, target);\n    });\n\n    // Keydown events (Enter, Escape, Tab navigation)\n    rightManager.on('keydown', '.time-cell input', (event, target) => {\n      this._handleCellKeydown(event, target);\n    });\n\n    this.eventManagers.set('right-panel', rightManager);\n  }\n\n  /**\n   * Setup scroll synchronization with RAF throttle for performance\n   */\n  _setupScrollSync(leftScroll, rightScroll) {\n    // Throttle scroll events to 60fps using requestAnimationFrame\n    const syncLeftToRight = rafThrottle(() => {\n      rightScroll.scrollTop = leftScroll.scrollTop;\n    });\n\n    const syncRightToLeft = rafThrottle(() => {\n      leftScroll.scrollTop = rightScroll.scrollTop;\n    });\n\n    // Attach scroll listeners\n    leftScroll.addEventListener('scroll', syncLeftToRight, { passive: true });\n    rightScroll.addEventListener('scroll', syncRightToLeft, { passive: true });\n\n    // Store handlers for cleanup\n    this.scrollHandlers.set('left', { element: leftScroll, handler: syncLeftToRight });\n    this.scrollHandlers.set('right', { element: rightScroll, handler: syncRightToLeft });\n  }\n\n  /**\n   * Handle tree toggle click\n   */\n  _handleTreeToggle(event, toggleElement) {\n    event.stopPropagation();\n\n    const nodeId = toggleElement.dataset.nodeId;\n    const isExpanded = !toggleElement.classList.contains('collapsed');\n\n    // Update state\n    if (isExpanded) {\n      this.state.expandedNodes.delete(nodeId);\n      toggleElement.classList.add('collapsed');\n    } else {\n      this.state.expandedNodes.add(nodeId);\n      toggleElement.classList.remove('collapsed');\n    }\n\n    // Toggle child rows\n    this._toggleNodeChildren(nodeId, !isExpanded);\n\n    // Sync row heights after DOM update\n    requestAnimationFrame(() => {\n      this._syncRowHeights();\n    });\n  }\n\n  /**\n   * Toggle visibility of child rows\n   */\n  _toggleNodeChildren(nodeId, show) {\n    const leftBody = this.state.domRefs?.leftTbody || document.getElementById('left-tbody');\n    const rightBody = this.state.domRefs?.rightTbody || document.getElementById('right-tbody');\n\n    const selector = `[data-parent-id=\"${nodeId}\"]`;\n    const leftChildren = leftBody.querySelectorAll(selector);\n    const rightChildren = rightBody.querySelectorAll(selector);\n\n    const display = show ? '' : 'none';\n\n    leftChildren.forEach((row) => {\n      row.style.display = display;\n\n      // Recursively hide/show descendants if this node is collapsed\n      if (!show) {\n        const childId = row.dataset.nodeId;\n        if (childId) {\n          this._toggleNodeChildren(childId, false);\n        }\n      }\n    });\n\n    rightChildren.forEach((row) => {\n      row.style.display = display;\n    });\n  }\n\n  /**\n   * Handle row selection (optional feature)\n   */\n  _handleRowSelection(event, cellElement) {\n    const row = cellElement.closest('tr');\n    if (!row) return;\n\n    // Toggle selected state\n    row.classList.toggle('row-selected');\n\n    // Sync with right panel\n    const rowIndex = row.dataset.rowIndex;\n    if (rowIndex) {\n      const rightRow = document.querySelector(\n        `.right-panel-scroll tr[data-row-index=\"${rowIndex}\"]`\n      );\n      if (rightRow) {\n        rightRow.classList.toggle('row-selected');\n      }\n    }\n  }\n\n  /**\n   * Handle cell click (select cell)\n   */\n  _handleCellClick(event, cellElement) {\n    // Remove selection from other cells\n    document.querySelectorAll('.time-cell.selected').forEach((cell) => {\n      cell.classList.remove('selected');\n    });\n\n    // Select this cell\n    cellElement.classList.add('selected');\n  }\n\n  /**\n   * Handle cell double-click (enter edit mode)\n   */\n  _handleCellDoubleClick(event, cellElement) {\n    event.preventDefault();\n\n    // Check if already in edit mode\n    if (cellElement.classList.contains('editing')) {\n      return;\n    }\n\n    // Enter edit mode\n    this._enterEditMode(cellElement);\n  }\n\n  /**\n   * Enter edit mode for a cell\n   */\n  _enterEditMode(cellElement) {\n    const currentValue = cellElement.dataset.value || '0';\n\n    // Create input element\n    const input = document.createElement('input');\n    input.type = 'number';\n    input.className = 'cell-input';\n    input.value = currentValue;\n    input.min = '0';\n    input.max = '100';\n    input.step = '0.1';\n\n    // Clear cell and add input\n    cellElement.innerHTML = '';\n    cellElement.appendChild(input);\n    cellElement.classList.add('editing');\n\n    // Focus and select\n    input.focus();\n    input.select();\n  }\n\n  /**\n   * Handle cell input (real-time validation)\n   */\n  _handleCellInput(event, inputElement) {\n    const cellElement = inputElement.closest('.time-cell');\n    if (!cellElement) return;\n\n    // Real-time validation is handled on blur to avoid performance issues\n    // But we can add visual feedback for obviously invalid input\n    const value = parseFloat(inputElement.value);\n\n    if (!isNaN(value)) {\n      if (value < 0 || value > 100) {\n        cellElement.classList.add('validation-warning');\n      } else {\n        cellElement.classList.remove('validation-warning');\n      }\n    }\n  }\n\n  /**\n   * Handle cell blur (validate and save)\n   */\n  _handleCellBlur(event, inputElement) {\n    const cellElement = inputElement.closest('.time-cell');\n    if (!cellElement) return;\n\n    // Validate the input\n    const validationResult = handleCellValidation(event, cellElement, this.state);\n\n    // Exit edit mode\n    this._exitEditMode(cellElement, validationResult.value);\n\n    // Update state\n    const cellKey = cellElement.dataset.cellId;\n    if (cellKey) {\n      this.state.modifiedCells = this.state.modifiedCells || new Map();\n      this.state.modifiedCells.set(cellKey, validationResult.value);\n\n      // Mark as dirty\n      this.state.isDirty = true;\n\n      // Calculate and update total progress for this pekerjaan\n      const [pekerjaanId] = cellKey.split('-');\n      this._updatePekerjaanProgress(pekerjaanId);\n    }\n  }\n\n  /**\n   * Exit edit mode and restore cell display\n   */\n  _exitEditMode(cellElement, value) {\n    cellElement.classList.remove('editing');\n    cellElement.dataset.value = value;\n\n    // Restore display\n    const formattedValue = value === 0 ? '-' : `${value}%`;\n    cellElement.innerHTML = `<span class=\"cell-value\">${formattedValue}</span>`;\n  }\n\n  /**\n   * Handle keyboard navigation in cells\n   */\n  _handleCellKeydown(event, inputElement) {\n    const cellElement = inputElement.closest('.time-cell');\n    if (!cellElement) return;\n\n    switch (event.key) {\n      case 'Enter':\n        event.preventDefault();\n        inputElement.blur(); // Will trigger blur handler\n        this._navigateToNextCell(cellElement, 'down');\n        break;\n\n      case 'Escape':\n        event.preventDefault();\n        // Restore original value\n        const originalValue = cellElement.dataset.originalValue || '0';\n        inputElement.value = originalValue;\n        inputElement.blur();\n        break;\n\n      case 'Tab':\n        event.preventDefault();\n        inputElement.blur();\n        const direction = event.shiftKey ? 'left' : 'right';\n        this._navigateToNextCell(cellElement, direction);\n        break;\n\n      case 'ArrowUp':\n        if (event.ctrlKey) {\n          event.preventDefault();\n          inputElement.blur();\n          this._navigateToNextCell(cellElement, 'up');\n        }\n        break;\n\n      case 'ArrowDown':\n        if (event.ctrlKey) {\n          event.preventDefault();\n          inputElement.blur();\n          this._navigateToNextCell(cellElement, 'down');\n        }\n        break;\n    }\n  }\n\n  /**\n   * Navigate to next cell (keyboard navigation)\n   */\n  _navigateToNextCell(currentCell, direction) {\n    const row = currentCell.closest('tr');\n    if (!row) return;\n\n    let nextCell = null;\n\n    switch (direction) {\n      case 'right':\n        nextCell = currentCell.nextElementSibling;\n        while (nextCell && !nextCell.classList.contains('editable')) {\n          nextCell = nextCell.nextElementSibling;\n        }\n        break;\n\n      case 'left':\n        nextCell = currentCell.previousElementSibling;\n        while (nextCell && !nextCell.classList.contains('editable')) {\n          nextCell = nextCell.previousElementSibling;\n        }\n        break;\n\n      case 'down':\n        const nextRow = row.nextElementSibling;\n        if (nextRow) {\n          const cellIndex = Array.from(row.children).indexOf(currentCell);\n          nextCell = nextRow.children[cellIndex];\n        }\n        break;\n\n      case 'up':\n        const prevRow = row.previousElementSibling;\n        if (prevRow) {\n          const cellIndex = Array.from(row.children).indexOf(currentCell);\n          nextCell = prevRow.children[cellIndex];\n        }\n        break;\n    }\n\n    if (nextCell && nextCell.classList.contains('editable')) {\n      this._enterEditMode(nextCell);\n    }\n  }\n\n  /**\n   * Update total progress for a pekerjaan\n   */\n  _updatePekerjaanProgress(pekerjaanId) {\n    const modifiedCells = this.state.modifiedCells || new Map();\n    const timeColumns = this.state.timeColumns || [];\n\n    let total = 0;\n\n    timeColumns.forEach((col) => {\n      const cellKey = `${pekerjaanId}-${col.id}`;\n      const value = modifiedCells.get(cellKey) || 0;\n      total += parseFloat(value) || 0;\n    });\n\n    // Update progress indicator (if validation-utils is available)\n    if (typeof this.helpers.updateProgressIndicator === 'function') {\n      this.helpers.updateProgressIndicator(pekerjaanId, total);\n    }\n  }\n\n  /**\n   * Sync row heights between left and right panels\n   */\n  _syncRowHeights() {\n    const leftBody = this.state.domRefs?.leftTbody || document.getElementById('left-tbody');\n    const rightBody = this.state.domRefs?.rightTbody || document.getElementById('right-tbody');\n\n    if (!leftBody || !rightBody) return;\n\n    const leftRows = leftBody.querySelectorAll('tr');\n    const rightRows = rightBody.querySelectorAll('tr');\n\n    leftRows.forEach((leftRow, index) => {\n      const rightRow = rightRows[index];\n      if (!rightRow) return;\n\n      // Reset heights\n      leftRow.style.height = '';\n      rightRow.style.height = '';\n\n      // Get natural heights\n      const leftHeight = leftRow.offsetHeight;\n      const rightHeight = rightRow.offsetHeight;\n\n      // Set to max\n      const maxHeight = Math.max(leftHeight, rightHeight);\n      leftRow.style.height = `${maxHeight}px`;\n      rightRow.style.height = `${maxHeight}px`;\n    });\n  }\n\n  /**\n   * Clean up all event listeners\n   */\n  cleanup() {\n    // Clean up event delegation managers\n    for (const manager of this.eventManagers.values()) {\n      manager.destroy();\n    }\n    this.eventManagers.clear();\n\n    // Clean up scroll handlers\n    for (const { element, handler } of this.scrollHandlers.values()) {\n      if (handler.cancel) {\n        handler.cancel();\n      }\n      element.removeEventListener('scroll', handler);\n    }\n    this.scrollHandlers.clear();\n  }\n}\n\n/**\n * Factory function to create and attach grid events\n *\n * @param {Object} state - Application state\n * @param {Object} helpers - Helper functions\n * @returns {GridEventManager} Event manager instance\n *\n * @example\n * const eventManager = attachGridEvents(state, {\n *   updateProgressIndicator: (id, total) => { ... },\n *   showToast: (msg, type) => { ... },\n * });\n *\n * // Later, cleanup:\n * eventManager.cleanup();\n */\nexport function attachGridEvents(state, helpers = {}) {\n  const manager = new GridEventManager(state, helpers);\n  manager.attachEvents();\n  return manager;\n}\n","/**\n * Build column definitions for AG Grid (dynamic time columns)\n */\n\n/**\n * @param {Array} timeColumns\n * @returns {Array}\n */\nexport function buildColumnDefs(timeColumns = []) {\n  const baseColumns = [\n    {\n      headerName: 'Kode',\n      field: 'code',\n      width: 150,\n      pinned: 'left',\n      suppressSizeToFit: true,\n      cellClass: 'ag-code-col',\n    },\n    {\n      headerName: 'Pekerjaan',\n      field: 'name',\n      minWidth: 240,\n      flex: 1.2,\n      pinned: 'left',\n      cellRenderer: pekerjaanCellRenderer,\n      cellClass: 'ag pekerjaan-col',\n    },\n  ];\n\n  const dynamicColumns = (timeColumns || []).map((column) => {\n    const field = column.fieldId || column.id || 'periode';\n    return {\n      headerName: column.label || column.id || 'Periode',\n      field,\n      minWidth: 120,\n      flex: 1,\n      type: 'numericColumn',\n      editable: true,\n      cellEditor: 'agNumberCellEditor',\n      cellClass: 'ag-time-col',\n      valueFormatter: (params) => {\n        if (params.value === null || typeof params.value === 'undefined' || params.value === '') {\n          return '-';\n        }\n        return `${params.value}`;\n      },\n    };\n  });\n\n  return baseColumns.concat(dynamicColumns);\n}\n\nfunction pekerjaanCellRenderer(params) {\n  const value = params.value || '';\n  const level = params.data?.level || 0;\n  const wrapper = document.createElement('div');\n  wrapper.className = 'ag-pekerjaan-label';\n  wrapper.style.paddingLeft = `${level * 16}px`;\n  wrapper.textContent = value;\n  return wrapper;\n}\n","import { createGrid } from 'ag-grid-community';\nimport { buildColumnDefs } from './column-definitions.js';\nimport { validateCellValue } from '@modules/shared/validation-utils.js';\n\n/**\n * AGGridManager\n * Membungkus inisialisasi AG Grid agar mudah diintegrasikan bertahap\n */\nexport class AGGridManager {\n  constructor(state, helpers = {}) {\n    this.state = state;\n    this.helpers = helpers;\n    this.gridApi = null;\n    this.columnApi = null;\n    this.gridOptions = null;\n    this.container = null;\n    this.currentColumns = [];\n  }\n\n  mount(containerElement) {\n    if (!containerElement) {\n      console.warn('[AGGridManager] Container not provided');\n      return;\n    }\n\n    this.container = containerElement;\n    this.gridOptions = this._createGridOptions();\n\n    this.gridApi = createGrid(containerElement, this.gridOptions);\n    if (typeof this.gridApi.getColumnApi === 'function') {\n      this.columnApi = this.gridApi.getColumnApi();\n    }\n\n    containerElement.classList.add('ag-grid-initialized');\n  }\n\n  updateData({ tree = [], timeColumns = [] } = {}) {\n    if (!this.gridApi) {\n      return;\n    }\n\n    const columnDefs = buildColumnDefs(timeColumns);\n    this.currentColumns = timeColumns;\n\n    this.gridApi.setGridOption('columnDefs', columnDefs);\n    const rowData = this._buildRowData(tree, timeColumns);\n    this.gridApi.setGridOption('rowData', rowData);\n  }\n\n  destroy() {\n    if (this.gridApi) {\n      this.gridApi.destroy();\n      this.gridApi = null;\n      this.columnApi = null;\n    }\n  }\n\n  _createGridOptions() {\n    return {\n      columnDefs: buildColumnDefs([]),\n      rowData: [],\n      animateRows: true,\n      suppressAggFuncInHeader: true,\n      defaultColDef: {\n        resizable: true,\n        sortable: false,\n        flex: 1,\n        minWidth: 120,\n      },\n      onCellValueChanged: (event) => this._handleCellValueChanged(event),\n    };\n  }\n\n  _buildRowData(tree = [], timeColumns = []) {\n    const rows = [];\n    const safeColumns = timeColumns || [];\n\n    const walk = (nodes, parentPath = []) => {\n      if (!Array.isArray(nodes)) return;\n\n      nodes.forEach((node, index) => {\n        if (!node) return;\n\n        const label =\n          node.snapshot_uraian ||\n          node.uraian ||\n          node.nama ||\n          node.name ||\n          `Node ${parentPath.length + index + 1}`;\n\n        const kode = node.snapshot_kode || node.kode || node.code || '';\n        const rowPath = parentPath.concat(label);\n\n        const row = {\n          id: node.id || node.pekerjaan_id || `node-${rowPath.join('-')}`,\n          name: label,\n          code: kode,\n          path: rowPath,\n          level: parentPath.length,\n          raw: node,\n        };\n\n        if (safeColumns.length > 0) {\n          safeColumns.forEach((col) => {\n            const assignmentMap =\n              node.assignments ||\n              node.assignment_map ||\n              node.assignmentMap ||\n              node[col.fieldId];\n\n            let value = '';\n            if (assignmentMap && typeof assignmentMap === 'object') {\n              const directValue =\n                assignmentMap[col.id] ??\n                assignmentMap[col.fieldId] ??\n                assignmentMap[col.label];\n              value = directValue ?? '';\n            } else if (typeof node[col.fieldId] !== 'undefined') {\n              value = node[col.fieldId];\n            }\n\n            row[col.fieldId || col.id] = value ?? '';\n          });\n        }\n\n        rows.push(row);\n\n        if (Array.isArray(node.children) && node.children.length > 0) {\n          walk(node.children, rowPath);\n        }\n      });\n    };\n\n    walk(tree, []);\n    return rows;\n  }\n\n  _handleCellValueChanged(event) {\n    const colDef = event?.colDef;\n    const field = colDef?.field;\n    if (!field) {\n      return;\n    }\n\n    const rowData = event?.data;\n    const pekerjaanId = rowData?.raw?.id || rowData?.id;\n    if (!pekerjaanId) {\n      return;\n    }\n\n    const validation = validateCellValue(event.newValue, { min: 0, max: 100, precision: 1 });\n    if (!validation.isValid && validation.message && typeof this.helpers.showToast === 'function') {\n      const toastType = validation.level === 'error' ? 'danger' : 'warning';\n      this.helpers.showToast(validation.message, toastType);\n    }\n\n    const normalizedValue = validation.value ?? 0;\n\n    if (event.node) {\n      event.node.setDataValue(field, normalizedValue);\n    }\n\n    const columnMeta =\n      (this.currentColumns || []).find((col) => (col.fieldId || col.id) === field) || null;\n\n    const cellKey = `${pekerjaanId}-${field}`;\n    if (typeof this.helpers.onCellChange === 'function') {\n      this.helpers.onCellChange({\n        cellKey,\n        value: normalizedValue,\n        pekerjaanId,\n        columnId: field,\n        columnMeta,\n      });\n    }\n  }\n}\n"],"names":["EventDelegationManager","constructor","rootElement","this","handlers","Map","activeListeners","on","eventType","selector","handler","options","has","set","_attachListener","get","push","off","index","findIndex","h","splice","length","_detachListener","delete","clearEvent","destroy","keys","clear","listener","event","target","closest","contains","call","addEventListener","capture","passive","removeEventListener","rafThrottle","func","rafId","lastArgs","throttled","args","requestAnimationFrame","apply","cancel","cancelAnimationFrame","validateCellValue","value","min","max","precision","isValid","message","level","numValue","parseFloat","isNaN","Math","round","pow","updateProgressIndicator","pekerjaanId","totalProgress","state","row","document","querySelector","indicator","rowElement","nameCell","createElement","className","appendChild","createProgressIndicator","validationResult","weeklyValues","maxTotal","tolerance","total","reduce","sum","val","roundedTotal","abs","validateTotalProgress","textContent","toFixed","classList","add","progressTotals","handleCellValidation","cellElement","input","result","showTooltip","tooltipDuration","remove","existingTooltip","tooltip","style","position","setTimeout","applyValidationFeedback","cellKey","dataset","cellId","modifiedCells","window","showToast","GridEventManager","helpers","eventManagers","scrollHandlers","attachEvents","leftTbody","_a","domRefs","getElementById","rightTbody","_b","leftScroll","_c","leftPanelScroll","rightScroll","_d","rightPanelScroll","cleanup","_setupLeftPanelEvents","_setupRightPanelEvents","_setupScrollSync","console","error","container","leftManager","_handleTreeToggle","_handleRowSelection","rightManager","_handleCellClick","_handleCellDoubleClick","_handleCellInput","_handleCellBlur","_handleCellKeydown","syncLeftToRight","scrollTop","syncRightToLeft","element","toggleElement","stopPropagation","nodeId","isExpanded","expandedNodes","_toggleNodeChildren","_syncRowHeights","show","leftBody","rightBody","leftChildren","querySelectorAll","rightChildren","display","forEach","childId","toggle","rowIndex","rightRow","cell","preventDefault","_enterEditMode","currentValue","type","step","innerHTML","focus","select","inputElement","_exitEditMode","isDirty","split","_updatePekerjaanProgress","formattedValue","key","blur","_navigateToNextCell","originalValue","direction","shiftKey","ctrlKey","currentCell","nextCell","nextElementSibling","previousElementSibling","nextRow","cellIndex","Array","from","children","indexOf","prevRow","timeColumns","col","id","leftRows","rightRows","leftRow","height","leftHeight","offsetHeight","rightHeight","maxHeight","manager","values","attachGridEvents","buildColumnDefs","baseColumns","headerName","field","width","pinned","suppressSizeToFit","cellClass","minWidth","flex","cellRenderer","pekerjaanCellRenderer","dynamicColumns","map","column","fieldId","label","editable","cellEditor","valueFormatter","params","concat","data","wrapper","paddingLeft","AGGridManager","gridApi","columnApi","gridOptions","currentColumns","mount","containerElement","_createGridOptions","createGrid","getColumnApi","warn","updateData","tree","columnDefs","setGridOption","rowData","_buildRowData","animateRows","suppressAggFuncInHeader","defaultColDef","resizable","sortable","onCellValueChanged","_handleCellValueChanged","rows","safeColumns","walk","nodes","parentPath","isArray","node","snapshot_uraian","uraian","nama","name","kode","snapshot_kode","code","rowPath","pekerjaan_id","join","path","raw","assignmentMap","assignments","assignment_map","directValue","colDef","validation","newValue","toastType","normalizedValue","setDataValue","columnMeta","find","onCellChange","columnId"],"mappings":"iDAWO,MAAMA,EACX,WAAAC,CAAYC,GACVC,KAAKD,YAAcA,EACnBC,KAAKC,aAAeC,IACpBF,KAAKG,oBAAsBD,GAC7B,CAiBA,EAAAE,CAAGC,EAAWC,EAAUC,EAASC,EAAU,CAAA,GACpCR,KAAKC,SAASQ,IAAIJ,KACrBL,KAAKC,SAASS,IAAIL,EAAW,IAC7BL,KAAKW,gBAAgBN,EAAWG,IAGlCR,KAAKC,SAASW,IAAIP,GAAWQ,KAAK,CAChCP,WACAC,UACAC,WAEJ,CASA,GAAAM,CAAIT,EAAWC,EAAUC,GACvB,IAAKP,KAAKC,SAASQ,IAAIJ,GACrB,OAGF,MAAMJ,EAAWD,KAAKC,SAASW,IAAIP,GAC7BU,EAAQd,EAASe,UACpBC,GAAMA,EAAEX,WAAaA,GAAYW,EAAEV,UAAYA,IAGpC,IAAVQ,IACFd,EAASiB,OAAOH,EAAO,GAGC,IAApBd,EAASkB,SACXnB,KAAKoB,gBAAgBf,GACrBL,KAAKC,SAASoB,OAAOhB,IAG3B,CAOA,UAAAiB,CAAWjB,GACJL,KAAKC,SAASQ,IAAIJ,KAIvBL,KAAKoB,gBAAgBf,GACrBL,KAAKC,SAASoB,OAAOhB,GACvB,CAKA,OAAAkB,GACE,IAAA,MAAWlB,KAAaL,KAAKC,SAASuB,OACpCxB,KAAKoB,gBAAgBf,GAGvBL,KAAKC,SAASwB,QACdzB,KAAKG,gBAAgBsB,QACrBzB,KAAKD,YAAc,IACrB,CAKA,eAAAY,CAAgBN,EAAWG,EAAU,IACnC,MAAMkB,EAAYC,IAChB,MAAM1B,EAAWD,KAAKC,SAASW,IAAIP,IAAc,GAEjD,IAAA,MAAWC,SAAEA,EAAAC,QAAUA,KAAaN,EAAU,CAE5C,MAAM2B,EAASD,EAAMC,OAAOC,QAAQvB,GAEhCsB,GAAU5B,KAAKD,YAAY+B,SAASF,IACtCrB,EAAQwB,KAAKH,EAAQD,EAAOC,EAEhC,GAGF5B,KAAKD,YAAYiC,iBAAiB3B,EAAWqB,EAAU,CACrDO,QAASzB,EAAQyB,UAAW,EAC5BC,QAAS1B,EAAQ0B,UAAW,IAG9BlC,KAAKG,gBAAgBO,IAAIL,EAAWqB,EACtC,CAKA,eAAAN,CAAgBf,GACd,MAAMqB,EAAW1B,KAAKG,gBAAgBS,IAAIP,GAEtCqB,IACF1B,KAAKD,YAAYoC,oBAAoB9B,EAAWqB,GAChD1B,KAAKG,gBAAgBkB,OAAOhB,GAEhC,ECPK,SAAS+B,EAAYC,GAC1B,IAAIC,EAAQ,KACRC,EAAW,KAEf,MAAMC,EAAY,YAAaC,GAC7BF,EAAWE,EAEG,OAAVH,IACFA,EAAQI,sBAAsB,KAC5BL,EAAKM,MAAM3C,KAAMuC,GACjBD,EAAQ,KACRC,EAAW,OAGjB,EAWA,OARAC,EAAUI,OAAS,KACH,OAAVN,IACFO,qBAAqBP,GACrBA,EAAQ,KACRC,EAAW,OAIRC,CACT,CC5HO,SAASM,EAAkBC,EAAOvC,EAAU,IACjD,MAAMwC,IAAEA,EAAM,EAAAC,IAAGA,EAAM,IAAAC,UAAKA,EAAY,GAAM1C,EAG9C,GAAIuC,SAAmD,KAAVA,EAC3C,MAAO,CACLI,SAAS,EACTC,QAAS,GACTC,MAAO,OACPN,MAAO,GAKX,MAAMO,EAAWC,WAAWR,GAG5B,GAAIS,MAAMF,GACR,MAAO,CACLH,SAAS,EACTC,QAAS,+BAA+BH,KACxCI,MAAO,QACPN,MAAO,GAKX,GAAIO,EAAWN,EACb,MAAO,CACLG,SAAS,EACTC,QAAS,iCAAiCJ,IAC1CK,MAAO,QACPN,MAAOC,GAIX,GAAIM,EAAWL,EACb,MAAO,CACLE,SAAS,EACTC,QAAS,gCAAgCH,IACzCI,MAAO,QACPN,MAAOE,GAOX,MAAO,CACLE,SAAS,EACTC,QAAS,GACTC,MAAO,OACPN,MANmBU,KAAKC,MAAMJ,EAAWG,KAAKE,IAAI,GAAIT,IAAcO,KAAKE,IAAI,GAAIT,GAQrF,CAmIO,SAASU,EAAwBC,EAAaC,EAAeC,GAClE,MAAMC,EAAMC,SAASC,cAAc,uBAAuBL,OAC1D,IAAKG,EAAK,OAEV,MAAMG,EAAYH,EAAIE,cAAc,wBA4BtC,SAAiCE,GAC/B,MAAMC,EAAWD,EAAWF,cAAc,cAC1C,IAAKG,EAAU,OAAO,KAEtB,MAAMF,EAAYF,SAASK,cAAc,QAIzC,OAHAH,EAAUI,UAAY,qBACtBF,EAASG,YAAYL,GAEdA,CACT,CArCgEM,CAAwBT,GAEhFU,EAvHD,SAA+BC,EAAcnE,EAAU,IAC5D,MAAMoE,SAAEA,EAAW,IAAAC,UAAKA,EAAY,IAAQrE,EAEtCsE,EAAQH,EAAaI,OAAO,CAACC,EAAKC,IAAQD,GAAOzB,WAAW0B,IAAQ,GAAI,GACxEC,EAAezB,KAAKC,MAAc,GAARoB,GAAc,GAG9C,OAAIrB,KAAK0B,IAAID,EAAeN,GAAYC,EAC/B,CACL1B,SAAS,EACTC,QAAS,UAAU8B,KACnB7B,MAAO,OACPN,MAAOmC,GAKPA,EAAeN,EACV,CACLzB,SAAS,EACTC,QAAS,kBAAkBwB,OAAcM,MACzC7B,MAAO,QACPN,MAAOmC,GAKPA,EAAeN,EAAWC,EACrB,CACL1B,SAAS,EACTC,QAAS,qBAAqBwB,OAAcM,MAC5C7B,MAAO,UACPN,MAAOmC,GAIJ,CACL/B,SAAS,EACTC,QAAS,UAAU8B,KACnB7B,MAAO,OACPN,MAAOmC,EAEX,CA6E2BE,CAAsB,CAACtB,GAAgB,CAAEc,SAAU,MAG5ET,EAAUkB,YAAc,GAAGvB,EAAcwB,QAAQ,MACjDnB,EAAUI,UAAY,qBAES,UAA3BG,EAAiBrB,MACnBc,EAAUoB,UAAUC,IAAI,kBACY,YAA3Bd,EAAiBrB,MAC1Bc,EAAUoB,UAAUC,IAAI,oBAExBrB,EAAUoB,UAAUC,IAAI,oBAItBzB,GAASA,EAAM0B,gBACjB1B,EAAM0B,eAAe/E,IAAImD,EAAaC,EAE1C,CA4IO,SAAS4B,EAAqB/D,EAAOgE,EAAa5B,GACvD,MAAM6B,EAAQjE,EAAMC,OACdmB,EAAQ6C,EAAM7C,MAGd8C,EAAS/C,EAAkBC,GASjC,GAzOK,SAAiC4C,EAAajB,EAAkBlE,EAAU,CAAA,GAC/E,MAAMsF,YAAEA,GAAc,EAAAC,gBAAMA,EAAkB,KAASvF,EAGvDmF,EAAYJ,UAAUS,OACpB,mBACA,qBACA,sBAIF,MAAMC,EAAkBN,EAAYzB,cAAc,uBAMlD,GALI+B,GACFA,EAAgBD,SAIbtB,EAAiBvB,QAwBpBwC,EAAYJ,UAAUC,IAAI,2BAhB1B,GAP+B,UAA3Bd,EAAiBrB,MACnBsC,EAAYJ,UAAUC,IAAI,oBACU,YAA3Bd,EAAiBrB,OAC1BsC,EAAYJ,UAAUC,IAAI,sBAIxBM,GAAepB,EAAiBtB,QAAS,CAC3C,MAAM8C,EAAUjC,SAASK,cAAc,OACvC4B,EAAQ3B,UAAY,yCAAyCG,EAAiBrB,QAC9E6C,EAAQb,YAAcX,EAAiBtB,QAEvCuC,EAAYQ,MAAMC,SAAW,WAC7BT,EAAYnB,YAAY0B,GAGpBH,EAAkB,GACpBM,WAAW,KACTH,EAAQF,UACPD,EAEP,CAIJ,CAwLEO,CAAwBX,EAAaE,EAAQ,CAC3CC,aAAcD,EAAO1C,QACrB4C,gBAAiB,MAIfF,EAAO1C,SAAW0C,EAAO9C,QAAUQ,WAAWR,GAAQ,CACxD6C,EAAM7C,MAAQ8C,EAAO9C,MAGrB,MAAMwD,EAAUZ,EAAYa,QAAQC,OAChCF,GAAWxC,EAAM2C,eACnB3C,EAAM2C,cAAchG,IAAI6F,EAASV,EAAO9C,MAE5C,CASA,OANK8C,EAAO1C,SAA4B,UAAjB0C,EAAOxC,OACI,mBAArBsD,OAAOC,WAChBD,OAAOC,UAAUf,EAAOzC,QAAS,SAAU,KAIxCyC,CACT,CC9YO,MAAMgB,EACX,WAAA/G,CAAYiE,EAAO+C,GACjB9G,KAAK+D,MAAQA,EACb/D,KAAK8G,QAAUA,EACf9G,KAAK+G,kBAAoB7G,IACzBF,KAAKgH,mBAAqB9G,GAC5B,CAKA,YAAA+G,eACE,MAAMC,GAAY,OAAAC,OAAKpD,MAAMqD,kBAASF,YAAajD,SAASoD,eAAe,cACrEC,GAAa,OAAAC,OAAKxD,MAAMqD,kBAASE,aAAcrD,SAASoD,eAAe,eACvEG,GAAa,OAAAC,OAAK1D,MAAMqD,kBAASM,kBAAmBzD,SAASC,cAAc,sBAC3EyD,GAAc,OAAAC,OAAK7D,MAAMqD,kBAASS,mBAAoB5D,SAASC,cAAc,uBAEnF,OAAKgD,GAAcI,GAMnBtH,KAAK8H,UAGL9H,KAAK+H,sBAAsBb,GAG3BlH,KAAKgI,uBAAuBV,GAGxBE,GAAcG,GAChB3H,KAAKiI,iBAAiBT,EAAYG,IAG7B,IAlBLO,QAAQC,MAAM,8BACP,EAkBX,CAKA,qBAAAJ,CAAsBK,GACpB,MAAMC,EAAc,IAAIxI,EAAuBuI,GAG/CC,EAAYjI,GAAG,QAAS,eAAgB,CAACuB,EAAOC,KAC9C5B,KAAKsI,kBAAkB3G,EAAOC,KAIhCyG,EAAYjI,GAAG,QAAS,aAAc,CAACuB,EAAOC,KAC5C5B,KAAKuI,oBAAoB5G,EAAOC,KAGlC5B,KAAK+G,cAAcrG,IAAI,aAAc2H,EACvC,CAKA,sBAAAL,CAAuBI,GACrB,MAAMI,EAAe,IAAI3I,EAAuBuI,GAGhDI,EAAapI,GAAG,QAAS,sBAAuB,CAACuB,EAAOC,KACtD5B,KAAKyI,iBAAiB9G,EAAOC,KAI/B4G,EAAapI,GAAG,WAAY,sBAAuB,CAACuB,EAAOC,KACzD5B,KAAK0I,uBAAuB/G,EAAOC,KAIrC4G,EAAapI,GAAG,QAAS,mBAAoB,CAACuB,EAAOC,KACnD5B,KAAK2I,iBAAiBhH,EAAOC,KAI/B4G,EAAapI,GAAG,OAAQ,mBAAoB,CAACuB,EAAOC,KAClD5B,KAAK4I,gBAAgBjH,EAAOC,KAI9B4G,EAAapI,GAAG,UAAW,mBAAoB,CAACuB,EAAOC,KACrD5B,KAAK6I,mBAAmBlH,EAAOC,KAGjC5B,KAAK+G,cAAcrG,IAAI,cAAe8H,EACxC,CAKA,gBAAAP,CAAiBT,EAAYG,GAE3B,MAAMmB,EAAkB1G,EAAY,KAClCuF,EAAYoB,UAAYvB,EAAWuB,YAG/BC,EAAkB5G,EAAY,KAClCoF,EAAWuB,UAAYpB,EAAYoB,YAIrCvB,EAAWxF,iBAAiB,SAAU8G,EAAiB,CAAE5G,SAAS,IAClEyF,EAAY3F,iBAAiB,SAAUgH,EAAiB,CAAE9G,SAAS,IAGnElC,KAAKgH,eAAetG,IAAI,OAAQ,CAAEuI,QAASzB,EAAYjH,QAASuI,IAChE9I,KAAKgH,eAAetG,IAAI,QAAS,CAAEuI,QAAStB,EAAapH,QAASyI,GACpE,CAKA,iBAAAV,CAAkB3G,EAAOuH,GACvBvH,EAAMwH,kBAEN,MAAMC,EAASF,EAAc1C,QAAQ4C,OAC/BC,GAAcH,EAAc3D,UAAUzD,SAAS,aAGjDuH,GACFrJ,KAAK+D,MAAMuF,cAAcjI,OAAO+H,GAChCF,EAAc3D,UAAUC,IAAI,eAE5BxF,KAAK+D,MAAMuF,cAAc9D,IAAI4D,GAC7BF,EAAc3D,UAAUS,OAAO,cAIjChG,KAAKuJ,oBAAoBH,GAASC,GAGlC3G,sBAAsB,KACpB1C,KAAKwJ,mBAET,CAKA,mBAAAD,CAAoBH,EAAQK,WAC1B,MAAMC,GAAW,OAAAvC,OAAKpD,MAAMqD,kBAASF,YAAajD,SAASoD,eAAe,cACpEsC,GAAY,OAAApC,OAAKxD,MAAMqD,kBAASE,aAAcrD,SAASoD,eAAe,eAEtE/G,EAAW,oBAAoB8I,MAC/BQ,EAAeF,EAASG,iBAAiBvJ,GACzCwJ,EAAgBH,EAAUE,iBAAiBvJ,GAE3CyJ,EAAUN,EAAO,GAAK,OAE5BG,EAAaI,QAAShG,IAIpB,GAHAA,EAAImC,MAAM4D,QAAUA,GAGfN,EAAM,CACT,MAAMQ,EAAUjG,EAAIwC,QAAQ4C,OACxBa,GACFjK,KAAKuJ,oBAAoBU,GAAS,EAEtC,IAGFH,EAAcE,QAAShG,IACrBA,EAAImC,MAAM4D,QAAUA,GAExB,CAKA,mBAAAxB,CAAoB5G,EAAOgE,GACzB,MAAM3B,EAAM2B,EAAY9D,QAAQ,MAChC,IAAKmC,EAAK,OAGVA,EAAIuB,UAAU2E,OAAO,gBAGrB,MAAMC,EAAWnG,EAAIwC,QAAQ2D,SAC7B,GAAIA,EAAU,CACZ,MAAMC,EAAWnG,SAASC,cACxB,0CAA0CiG,OAExCC,GACFA,EAAS7E,UAAU2E,OAAO,eAE9B,CACF,CAKA,gBAAAzB,CAAiB9G,EAAOgE,GAEtB1B,SAAS4F,iBAAiB,uBAAuBG,QAASK,IACxDA,EAAK9E,UAAUS,OAAO,cAIxBL,EAAYJ,UAAUC,IAAI,WAC5B,CAKA,sBAAAkD,CAAuB/G,EAAOgE,GAC5BhE,EAAM2I,iBAGF3E,EAAYJ,UAAUzD,SAAS,YAKnC9B,KAAKuK,eAAe5E,EACtB,CAKA,cAAA4E,CAAe5E,GACb,MAAM6E,EAAe7E,EAAYa,QAAQzD,OAAS,IAG5C6C,EAAQ3B,SAASK,cAAc,SACrCsB,EAAM6E,KAAO,SACb7E,EAAMrB,UAAY,aAClBqB,EAAM7C,MAAQyH,EACd5E,EAAM5C,IAAM,IACZ4C,EAAM3C,IAAM,MACZ2C,EAAM8E,KAAO,MAGb/E,EAAYgF,UAAY,GACxBhF,EAAYnB,YAAYoB,GACxBD,EAAYJ,UAAUC,IAAI,WAG1BI,EAAMgF,QACNhF,EAAMiF,QACR,CAKA,gBAAAlC,CAAiBhH,EAAOmJ,GACtB,MAAMnF,EAAcmF,EAAajJ,QAAQ,cACzC,IAAK8D,EAAa,OAIlB,MAAM5C,EAAQQ,WAAWuH,EAAa/H,OAEjCS,MAAMT,KACLA,EAAQ,GAAKA,EAAQ,IACvB4C,EAAYJ,UAAUC,IAAI,sBAE1BG,EAAYJ,UAAUS,OAAO,sBAGnC,CAKA,eAAA4C,CAAgBjH,EAAOmJ,GACrB,MAAMnF,EAAcmF,EAAajJ,QAAQ,cACzC,IAAK8D,EAAa,OAGlB,MAAMjB,EAAmBgB,EAAqB/D,EAAOgE,EAAa3F,KAAK+D,OAGvE/D,KAAK+K,cAAcpF,EAAajB,EAAiB3B,OAGjD,MAAMwD,EAAUZ,EAAYa,QAAQC,OACpC,GAAIF,EAAS,CACXvG,KAAK+D,MAAM2C,cAAgB1G,KAAK+D,MAAM2C,mBAAqBxG,IAC3DF,KAAK+D,MAAM2C,cAAchG,IAAI6F,EAAS7B,EAAiB3B,OAGvD/C,KAAK+D,MAAMiH,SAAU,EAGrB,MAAOnH,GAAe0C,EAAQ0E,MAAM,KACpCjL,KAAKkL,yBAAyBrH,EAChC,CACF,CAKA,aAAAkH,CAAcpF,EAAa5C,GACzB4C,EAAYJ,UAAUS,OAAO,WAC7BL,EAAYa,QAAQzD,MAAQA,EAG5B,MAAMoI,EAA2B,IAAVpI,EAAc,IAAM,GAAGA,KAC9C4C,EAAYgF,UAAY,4BAA4BQ,UACtD,CAKA,kBAAAtC,CAAmBlH,EAAOmJ,GACxB,MAAMnF,EAAcmF,EAAajJ,QAAQ,cACzC,GAAK8D,EAEL,OAAQhE,EAAMyJ,KACZ,IAAK,QACHzJ,EAAM2I,iBACNQ,EAAaO,OACbrL,KAAKsL,oBAAoB3F,EAAa,QACtC,MAEF,IAAK,SACHhE,EAAM2I,iBAEN,MAAMiB,EAAgB5F,EAAYa,QAAQ+E,eAAiB,IAC3DT,EAAa/H,MAAQwI,EACrBT,EAAaO,OACb,MAEF,IAAK,MACH1J,EAAM2I,iBACNQ,EAAaO,OACb,MAAMG,EAAY7J,EAAM8J,SAAW,OAAS,QAC5CzL,KAAKsL,oBAAoB3F,EAAa6F,GACtC,MAEF,IAAK,UACC7J,EAAM+J,UACR/J,EAAM2I,iBACNQ,EAAaO,OACbrL,KAAKsL,oBAAoB3F,EAAa,OAExC,MAEF,IAAK,YACChE,EAAM+J,UACR/J,EAAM2I,iBACNQ,EAAaO,OACbrL,KAAKsL,oBAAoB3F,EAAa,SAI9C,CAKA,mBAAA2F,CAAoBK,EAAaH,GAC/B,MAAMxH,EAAM2H,EAAY9J,QAAQ,MAChC,IAAKmC,EAAK,OAEV,IAAI4H,EAAW,KAEf,OAAQJ,GACN,IAAK,QAEH,IADAI,EAAWD,EAAYE,mBAChBD,IAAaA,EAASrG,UAAUzD,SAAS,aAC9C8J,EAAWA,EAASC,mBAEtB,MAEF,IAAK,OAEH,IADAD,EAAWD,EAAYG,uBAChBF,IAAaA,EAASrG,UAAUzD,SAAS,aAC9C8J,EAAWA,EAASE,uBAEtB,MAEF,IAAK,OACH,MAAMC,EAAU/H,EAAI6H,mBACpB,GAAIE,EAAS,CACX,MAAMC,EAAYC,MAAMC,KAAKlI,EAAImI,UAAUC,QAAQT,GACnDC,EAAWG,EAAQI,SAASH,EAC9B,CACA,MAEF,IAAK,KACH,MAAMK,EAAUrI,EAAI8H,uBACpB,GAAIO,EAAS,CACX,MAAML,EAAYC,MAAMC,KAAKlI,EAAImI,UAAUC,QAAQT,GACnDC,EAAWS,EAAQF,SAASH,EAC9B,EAIAJ,GAAYA,EAASrG,UAAUzD,SAAS,aAC1C9B,KAAKuK,eAAeqB,EAExB,CAKA,wBAAAV,CAAyBrH,GACvB,MAAM6C,EAAgB1G,KAAK+D,MAAM2C,mBAAqBxG,IAChDoM,EAActM,KAAK+D,MAAMuI,aAAe,GAE9C,IAAIxH,EAAQ,EAEZwH,EAAYtC,QAASuC,IACnB,MAAMhG,EAAU,GAAG1C,KAAe0I,EAAIC,KAChCzJ,EAAQ2D,EAAc9F,IAAI2F,IAAY,EAC5CzB,GAASvB,WAAWR,IAAU,IAIoB,mBAAzC/C,KAAK8G,QAAQlD,yBACtB5D,KAAK8G,QAAQlD,wBAAwBC,EAAaiB,EAEtD,CAKA,eAAA0E,WACE,MAAME,GAAW,OAAAvC,OAAKpD,MAAMqD,kBAASF,YAAajD,SAASoD,eAAe,cACpEsC,GAAY,OAAApC,OAAKxD,MAAMqD,kBAASE,aAAcrD,SAASoD,eAAe,eAE5E,IAAKqC,IAAaC,EAAW,OAE7B,MAAM8C,EAAW/C,EAASG,iBAAiB,MACrC6C,EAAY/C,EAAUE,iBAAiB,MAE7C4C,EAASzC,QAAQ,CAAC2C,EAAS5L,KACzB,MAAMqJ,EAAWsC,EAAU3L,GAC3B,IAAKqJ,EAAU,OAGfuC,EAAQxG,MAAMyG,OAAS,GACvBxC,EAASjE,MAAMyG,OAAS,GAGxB,MAAMC,EAAaF,EAAQG,aACrBC,EAAc3C,EAAS0C,aAGvBE,EAAYvJ,KAAKR,IAAI4J,EAAYE,GACvCJ,EAAQxG,MAAMyG,OAAS,GAAGI,MAC1B5C,EAASjE,MAAMyG,OAAS,GAAGI,OAE/B,CAKA,OAAAlF,GAEE,IAAA,MAAWmF,KAAWjN,KAAK+G,cAAcmG,SACvCD,EAAQ1L,UAEVvB,KAAK+G,cAActF,QAGnB,IAAA,MAAWwH,QAAEA,EAAA1I,QAASA,KAAaP,KAAKgH,eAAekG,SACjD3M,EAAQqC,QACVrC,EAAQqC,SAEVqG,EAAQ9G,oBAAoB,SAAU5B,GAExCP,KAAKgH,eAAevF,OACtB,EAmBK,SAAS0L,EAAiBpJ,EAAO+C,EAAU,IAChD,MAAMmG,EAAU,IAAIpG,EAAiB9C,EAAO+C,GAE5C,OADAmG,EAAQhG,eACDgG,CACT,CClfO,SAASG,EAAgBd,EAAc,IAC5C,MAAMe,EAAc,CAClB,CACEC,WAAY,OACZC,MAAO,OACPC,MAAO,IACPC,OAAQ,OACRC,mBAAmB,EACnBC,UAAW,eAEb,CACEL,WAAY,YACZC,MAAO,OACPK,SAAU,IACVC,KAAM,IACNJ,OAAQ,OACRK,aAAcC,EACdJ,UAAW,qBAITK,GAAkB1B,GAAe,IAAI2B,IAAKC,IAC9C,MAAMX,EAAQW,EAAOC,SAAWD,EAAO1B,IAAM,UAC7C,MAAO,CACLc,WAAYY,EAAOE,OAASF,EAAO1B,IAAM,UACzCe,QACAK,SAAU,IACVC,KAAM,EACNpD,KAAM,gBACN4D,UAAU,EACVC,WAAY,qBACZX,UAAW,cACXY,eAAiBC,GACM,OAAjBA,EAAOzL,YAA0C,IAAjByL,EAAOzL,OAA0C,KAAjByL,EAAOzL,MAClE,IAEF,GAAGyL,EAAOzL,WAKvB,OAAOsK,EAAYoB,OAAOT,EAC5B,CAEA,SAASD,EAAsBS,SAC7B,MAAMzL,EAAQyL,EAAOzL,OAAS,GACxBM,GAAQ,OAAA8D,EAAAqH,EAAOE,WAAP,EAAAvH,EAAa9D,QAAS,EAC9BsL,EAAU1K,SAASK,cAAc,OAIvC,OAHAqK,EAAQpK,UAAY,qBACpBoK,EAAQxI,MAAMyI,YAAyB,GAARvL,EAAH,KAC5BsL,EAAQtJ,YAActC,EACf4L,CACT,CCpDO,MAAME,EACX,WAAA/O,CAAYiE,EAAO+C,EAAU,IAC3B9G,KAAK+D,MAAQA,EACb/D,KAAK8G,QAAUA,EACf9G,KAAK8O,QAAU,KACf9O,KAAK+O,UAAY,KACjB/O,KAAKgP,YAAc,KACnBhP,KAAKoI,UAAY,KACjBpI,KAAKiP,eAAiB,EACxB,CAEA,KAAAC,CAAMC,GACCA,GAKLnP,KAAKoI,UAAY+G,EACjBnP,KAAKgP,YAAchP,KAAKoP,qBAExBpP,KAAK8O,QAAUO,EAAWF,EAAkBnP,KAAKgP,aACR,mBAA9BhP,KAAK8O,QAAQQ,eACtBtP,KAAK+O,UAAY/O,KAAK8O,QAAQQ,gBAGhCH,EAAiB5J,UAAUC,IAAI,wBAZ7B0C,QAAQqH,KAAK,yCAajB,CAEA,UAAAC,EAAWC,KAAEA,EAAO,GAAAnD,YAAIA,EAAc,IAAO,IAC3C,IAAKtM,KAAK8O,QACR,OAGF,MAAMY,EAAatC,EAAgBd,GACnCtM,KAAKiP,eAAiB3C,EAEtBtM,KAAK8O,QAAQa,cAAc,aAAcD,GACzC,MAAME,EAAU5P,KAAK6P,cAAcJ,EAAMnD,GACzCtM,KAAK8O,QAAQa,cAAc,UAAWC,EACxC,CAEA,OAAArO,GACMvB,KAAK8O,UACP9O,KAAK8O,QAAQvN,UACbvB,KAAK8O,QAAU,KACf9O,KAAK+O,UAAY,KAErB,CAEA,kBAAAK,GACE,MAAO,CACLM,WAAYtC,EAAgB,IAC5BwC,QAAS,GACTE,aAAa,EACbC,yBAAyB,EACzBC,cAAe,CACbC,WAAW,EACXC,UAAU,EACVrC,KAAM,EACND,SAAU,KAEZuC,mBAAqBxO,GAAU3B,KAAKoQ,wBAAwBzO,GAEhE,CAEA,aAAAkO,CAAcJ,EAAO,GAAInD,EAAc,IACrC,MAAM+D,EAAO,GACPC,EAAchE,GAAe,GAE7BiE,EAAO,CAACC,EAAOC,EAAa,MAC3BxE,MAAMyE,QAAQF,IAEnBA,EAAMxG,QAAQ,CAAC2G,EAAM5P,KACnB,IAAK4P,EAAM,OAEX,MAAMvC,EACJuC,EAAKC,iBACLD,EAAKE,QACLF,EAAKG,MACLH,EAAKI,MACL,QAAQN,EAAWtP,OAASJ,EAAQ,IAEhCiQ,EAAOL,EAAKM,eAAiBN,EAAKK,MAAQL,EAAKO,MAAQ,GACvDC,EAAUV,EAAWhC,OAAOL,GAE5BpK,EAAM,CACVwI,GAAImE,EAAKnE,IAAMmE,EAAKS,cAAgB,QAAQD,EAAQE,KAAK,OACzDN,KAAM3C,EACN8C,KAAMF,EACNM,KAAMH,EACN9N,MAAOoN,EAAWtP,OAClBoQ,IAAKZ,GAGHL,EAAYnP,OAAS,GACvBmP,EAAYtG,QAASuC,YACnB,MAAMiF,EACJb,EAAKc,aACLd,EAAKe,gBACLf,EAAKa,eACLb,EAAKpE,EAAI4B,SAEX,IAAIpL,EAAQ,GACZ,GAAIyO,GAA0C,iBAAlBA,EAA4B,CACtD,MAAMG,EACJ,OAAApK,EAAA,OAAAJ,EAAAqK,EAAcjF,EAAIC,KAAlBrF,EACAqK,EAAcjF,EAAI4B,UADlB5G,EAEAiK,EAAcjF,EAAI6B,OACpBrL,EAAQ,MAAA4O,EAAAA,EAAe,EACzB,WAAwC,IAAtBhB,EAAKpE,EAAI4B,WACzBpL,EAAQ4N,EAAKpE,EAAI4B,UAGnBnK,EAAIuI,EAAI4B,SAAW5B,EAAIC,IAAM,MAAAzJ,EAAAA,EAAS,KAI1CsN,EAAKxP,KAAKmD,GAENiI,MAAMyE,QAAQC,EAAKxE,WAAawE,EAAKxE,SAAShL,OAAS,GACzDoP,EAAKI,EAAKxE,SAAUgF,MAM1B,OADAZ,EAAKd,EAAM,IACJY,CACT,CAEA,uBAAAD,CAAwBzO,WACtB,MAAMiQ,EAAS,MAAAjQ,OAAA,EAAAA,EAAOiQ,OAChBrE,EAAQ,MAAAqE,OAAA,EAAAA,EAAQrE,MACtB,IAAKA,EACH,OAGF,MAAMqC,EAAU,MAAAjO,OAAA,EAAAA,EAAO+M,KACjB7K,GAAc,OAAAsD,EAAA,MAAAyI,OAAA,EAAAA,EAAS2B,UAAT,EAAApK,EAAcqF,MAAM,MAAAoD,OAAA,EAAAA,EAASpD,IACjD,IAAK3I,EACH,OAGF,MAAMgO,EAAa/O,EAAkBnB,EAAMmQ,SAAU,CAAE9O,IAAK,EAAGC,IAAK,IAAKC,UAAW,IACpF,IAAK2O,EAAW1O,SAAW0O,EAAWzO,SAA6C,mBAA3BpD,KAAK8G,QAAQF,UAA0B,CAC7F,MAAMmL,EAAiC,UAArBF,EAAWxO,MAAoB,SAAW,UAC5DrD,KAAK8G,QAAQF,UAAUiL,EAAWzO,QAAS2O,EAC7C,CAEA,MAAMC,EAAkB,OAAAzK,EAAAsK,EAAW9O,OAAXwE,EAAoB,EAExC5F,EAAMgP,MACRhP,EAAMgP,KAAKsB,aAAa1E,EAAOyE,GAGjC,MAAME,GACHlS,KAAKiP,gBAAkB,IAAIkD,KAAM5F,IAASA,EAAI4B,SAAW5B,EAAIC,MAAQe,IAAU,KAE5EhH,EAAU,GAAG1C,KAAe0J,IACO,mBAA9BvN,KAAK8G,QAAQsL,cACtBpS,KAAK8G,QAAQsL,aAAa,CACxB7L,UACAxD,MAAOiP,EACPnO,cACAwO,SAAU9E,EACV2E,cAGN"}