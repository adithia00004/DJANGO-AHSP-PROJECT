var e=Object.defineProperty,t=Object.defineProperties,l=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,a=Math.pow,o=(t,l,n)=>l in t?e(t,l,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[l]=n,r=(e,t)=>{for(var l in t||(t={}))i.call(t,l)&&o(e,l,t[l]);if(n)for(var l of n(t))s.call(t,l)&&o(e,l,t[l]);return e},u=(e,n)=>t(e,l(n)),c=(e,t,l)=>new Promise((n,i)=>{var s=e=>{try{o(l.next(e))}catch(t){i(t)}},a=e=>{try{o(l.throw(e))}catch(t){i(t)}},o=e=>e.done?n(e.value):Promise.resolve(e.value).then(s,a);o((l=l.apply(e,t)).next())});class f{constructor(){this.shortcuts=new Map,this.enabled=!0,this._boundHandler=this._handleKeyDown.bind(this),this.init()}init(){document.addEventListener("keydown",this._boundHandler),console.log("âŒ¨ï¸ Keyboard shortcuts initialized")}register(e,t,l={}){const{description:n="",preventDefault:i=!0}=l;this.shortcuts.set(e.toLowerCase(),{callback:t,description:n,preventDefault:i})}unregister(e){this.shortcuts.delete(e.toLowerCase())}_handleKeyDown(e){if(!this.enabled)return;const t=document.activeElement,l="INPUT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable,n=[];e.ctrlKey&&n.push("ctrl"),e.altKey&&n.push("alt"),e.shiftKey&&n.push("shift"),e.metaKey&&n.push("meta");const i=e.key.toLowerCase();["control","alt","shift","meta"].includes(i)||n.push(i);const s=n.join("+"),a=this.shortcuts.get(s);if(a){if(l&&!["ctrl+a","ctrl+c","ctrl+v","ctrl+x","ctrl+z"].includes(s))return;a.preventDefault&&e.preventDefault(),a.callback(e),console.log(`âŒ¨ï¸ Shortcut triggered: ${s}`)}}enable(){this.enabled=!0}disable(){this.enabled=!1}getShortcuts(){return Array.from(this.shortcuts.entries()).map(([e,t])=>({key:e,description:t.description}))}destroy(){document.removeEventListener("keydown",this._boundHandler),this.shortcuts.clear()}}class d{static add(e){e&&(e.classList.add("btn-ripple"),e.addEventListener("click",function(e){const t=document.createElement("span");t.classList.add("ripple-circle");const l=this.getBoundingClientRect(),n=Math.max(l.width,l.height),i=e.clientX-l.left-n/2,s=e.clientY-l.top-n/2;t.style.width=t.style.height=n+"px",t.style.left=i+"px",t.style.top=s+"px",this.appendChild(t),setTimeout(()=>t.remove(),600)}))}static addToAll(e){document.querySelectorAll(e).forEach(e=>{d.add(e)})}}class h{static setLoading(e,t="Loading..."){if(!e)return;e.dataset.originalText=e.innerHTML,e.disabled=!0,e.classList.add("loading");e.innerHTML='<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>'+t}static setSuccess(e,t=2e3){e&&(e.disabled=!1,e.classList.remove("loading"),e.classList.add("success"),e.dataset.originalText&&(e.innerHTML=e.dataset.originalText),setTimeout(()=>{e.classList.remove("success")},t))}static setError(e,t=2e3){e&&(e.disabled=!1,e.classList.remove("loading"),e.classList.add("error"),e.dataset.originalText&&(e.innerHTML=e.dataset.originalText),setTimeout(()=>{e.classList.remove("error")},t))}static reset(e){e&&(e.disabled=!1,e.classList.remove("loading","success","error"),e.dataset.originalText&&(e.innerHTML=e.dataset.originalText))}static markChanges(e,t){e&&(t?(e.classList.add("has-changes"),e.setAttribute("data-tooltip","You have unsaved changes")):(e.classList.remove("has-changes"),e.removeAttribute("data-tooltip")))}}class p{static success(e,t=1600){var l,n;(null==(n=null==(l=window.DP)?void 0:l.core)?void 0:n.toast)?window.DP.core.toast.show(e,"success",t):console.log(`âœ… ${e}`)}static error(e,t=3e3){var l,n;(null==(n=null==(l=window.DP)?void 0:l.core)?void 0:n.toast)?window.DP.core.toast.show(e,"danger",t):console.error(`âŒ ${e}`)}static warning(e,t=2e3){var l,n;(null==(n=null==(l=window.DP)?void 0:l.core)?void 0:n.toast)?window.DP.core.toast.show(e,"warning",t):console.warn(`âš ï¸ ${e}`)}static info(e,t=1600){var l,n;(null==(n=null==(l=window.DP)?void 0:l.core)?void 0:n.toast)?window.DP.core.toast.show(e,"info",t):console.info(`â„¹ï¸ ${e}`)}}function m(){console.log("ðŸŽ¨ Initializing UX enhancements..."),d.addToAll(".btn-primary, .btn-save, .btn-danger"),document.querySelectorAll("button[title]").forEach(e=>{e.hasAttribute("data-tooltip")||e.setAttribute("data-tooltip",e.getAttribute("title"))}),console.log("âœ… UX enhancements initialized")}const g="u-off",v="u-label",b="width",w="height",x="top",y="bottom",_="left",k="right",M="#000",S=M+"0",A="mousemove",D="mousedown",T="mouseup",C="mouseenter",E="mouseleave",N="dblclick",z="change",F="dppxchange",P="--",L="undefined"!=typeof window,I=L?document:null,$=L?window:null,W=L?navigator:null;let H,O;function V(e,t){if(null!=t){let l=e.classList;!l.contains(t)&&l.add(t)}}function j(e,t){let l=e.classList;l.contains(t)&&l.remove(t)}function R(e,t,l){e.style[t]=l+"px"}function B(e,t,l,n){let i=I.createElement(e);return null!=t&&V(i,t),null!=l&&l.insertBefore(i,n),i}function Y(e,t){return B("div",e,t)}const K=new WeakMap;function G(e,t,l,n,i){let s="translate("+t+"px,"+l+"px)";s!=K.get(e)&&(e.style.transform=s,K.set(e,s),t<0||l<0||t>n||l>i?V(e,g):j(e,g))}const U=new WeakMap;function X(e,t,l){let n=t+l;n!=U.get(e)&&(U.set(e,n),e.style.background=t,e.style.borderColor=l)}const q=new WeakMap;function J(e,t,l,n){let i=t+""+l;i!=q.get(e)&&(q.set(e,i),e.style.height=l+"px",e.style.width=t+"px",e.style.marginLeft=n?-t/2+"px":0,e.style.marginTop=n?-l/2+"px":0)}const Z={passive:!0},Q=u(r({},Z),{capture:!0});function ee(e,t,l,n){t.addEventListener(e,l,n?Q:Z)}function te(e,t,l,n){t.removeEventListener(e,l,Z)}function le(e,t,l,n){let i;l=l||0;let s=(n=n||t.length-1)<=2147483647;for(;n-l>1;)i=s?l+n>>1:ye((l+n)/2),t[i]<e?l=i:n=i;return e-t[l]<=t[n]-e?l:n}function ne(e){return(t,l,n)=>{let i=-1,s=-1;for(let a=l;a<=n;a++)if(e(t[a])){i=a;break}for(let a=n;a>=l;a--)if(e(t[a])){s=a;break}return[i,s]}}L&&function e(){let t=devicePixelRatio;H!=t&&(H=t,O&&te(z,O,e),O=matchMedia(`(min-resolution: ${H-.001}dppx) and (max-resolution: ${H+.001}dppx)`),ee(z,O,e),$.dispatchEvent(new CustomEvent(F)))}();const ie=e=>null!=e,se=e=>null!=e&&e>0,ae=ne(ie),oe=ne(se);function re(e,t,l,n){let i=De(e),s=De(t);e==t&&(-1==i?(e*=l,t/=l):(e/=l,t*=l));let a=10==l?Te:Ce,o=1==s?ke:ye,r=(1==i?ye:ke)(a(xe(e))),u=o(a(xe(t))),c=Ae(l,r),f=Ae(l,u);return 10==l&&(r<0&&(c=Ke(c,-r)),u<0&&(f=Ke(f,-u))),n||2==l?(e=c*i,t=f*s):(e=Ye(e,c),t=Be(t,f)),[e,t]}function ue(e,t,l,n){let i=re(e,t,l,n);return 0==e&&(i[0]=0),0==t&&(i[1]=0),i}const ce={mode:3,pad:.1},fe={pad:0,soft:null,mode:0},de={min:fe,max:fe};function he(e,t,l,n){return lt(l)?me(e,t,l):(fe.pad=l,fe.soft=n?0:null,fe.mode=n?3:0,me(e,t,de))}function pe(e,t){return null==e?t:e}function me(e,t,l){let n=l.min,i=l.max,s=pe(n.pad,0),a=pe(i.pad,0),o=pe(n.hard,-Ne),r=pe(i.hard,Ne),u=pe(n.soft,Ne),c=pe(i.soft,-Ne),f=pe(n.mode,0),d=pe(i.mode,0),h=t-e,p=Te(h),m=Se(xe(e),xe(t)),g=Te(m),v=xe(g-p);(h<1e-24||v>10)&&(h=0,0!=e&&0!=t||(h=1e-24,2==f&&u!=Ne&&(s=0),2==d&&c!=-Ne&&(a=0)));let b=h||m||1e3,w=Te(b),x=Ae(10,ye(w)),y=Ke(Ye(e-b*(0==h?0==e?.1:1:s),x/10),24),_=e>=u&&(1==f||3==f&&y<=u||2==f&&y>=u)?u:Ne,k=Se(o,y<_&&e>=_?_:Me(_,y)),M=Ke(Be(t+b*(0==h?0==t?.1:1:a),x/10),24),S=t<=c&&(1==d||3==d&&M>=c||2==d&&M<=c)?c:-Ne,A=Me(r,M>S&&t<=S?S:Se(S,M));return k==A&&0==k&&(A=100),[k,A]}const ge=new Intl.NumberFormat(L?W.language:"en-US"),ve=e=>ge.format(e),be=Math,we=be.PI,xe=be.abs,ye=be.floor,_e=be.round,ke=be.ceil,Me=be.min,Se=be.max,Ae=be.pow,De=be.sign,Te=be.log10,Ce=be.log2,Ee=(e,t=1)=>be.asinh(e/t),Ne=1/0;function ze(e){return 1+(0|Te((e^e>>31)-(e>>31)))}function Fe(e,t,l){return Me(Se(e,t),l)}function Pe(e){return"function"==typeof e}function Le(e){return Pe(e)?e:()=>e}const Ie=e=>e,$e=(e,t)=>t,We=e=>null,He=e=>!0,Oe=(e,t)=>e==t,Ve=/\.\d*?(?=9{6,}|0{6,})/gm,je=e=>{if(et(e)||Ge.has(e))return e;const t=`${e}`,l=t.match(Ve);if(null==l)return e;let n=l[0].length-1;if(-1!=t.indexOf("e-")){let[e,l]=t.split("e");return+`${je(e)}e${l}`}return Ke(e,n)};function Re(e,t){return je(Ke(je(e/t))*t)}function Be(e,t){return je(ke(je(e/t))*t)}function Ye(e,t){return je(ye(je(e/t))*t)}function Ke(e,t=0){if(et(e))return e;let l=a(10,t),n=e*l*(1+Number.EPSILON);return _e(n)/l}const Ge=new Map;function Ue(e){return((""+e).split(".")[1]||"").length}function Xe(e,t,l,n){let i=[],s=n.map(Ue);for(let a=t;a<l;a++){let t=xe(a),l=Ke(Ae(e,a),t);for(let o=0;o<n.length;o++){let r=10==e?+`${n[o]}e${a}`:n[o]*l,u=(a>=0?0:t)+(a>=s[o]?0:s[o]),c=10==e?r:Ke(r,u);i.push(c),Ge.set(c,u)}}return i}const qe={},Je=[],Ze=[null,null],Qe=Array.isArray,et=Number.isInteger;function tt(e){return"string"==typeof e}function lt(e){let t=!1;if(null!=e){let l=e.constructor;t=null==l||l==Object}return t}function nt(e){return null!=e&&"object"==typeof e}const it=Object.getPrototypeOf(Uint8Array),st="__proto__";function at(e,t=lt){let l;if(Qe(e)){let n=e.find(e=>null!=e);if(Qe(n)||t(n)){l=Array(e.length);for(let n=0;n<e.length;n++)l[n]=at(e[n],t)}else l=e.slice()}else if(e instanceof it)l=e.slice();else if(t(e)){l={};for(let n in e)n!=st&&(l[n]=at(e[n],t))}else l=e;return l}function ot(e){let t=arguments;for(let l=1;l<t.length;l++){let n=t[l];for(let t in n)t!=st&&(lt(e[t])?ot(e[t],at(n[t])):e[t]=at(n[t]))}return e}function rt(e,t,l){for(let n,i=0,s=-1;i<t.length;i++){let a=t[i];if(a>s){for(n=a-1;n>=0&&null==e[n];)e[n--]=null;for(n=a+1;n<l&&null==e[n];)e[s=n++]=null}}}const ut="undefined"==typeof queueMicrotask?e=>Promise.resolve().then(e):queueMicrotask;const ct=["January","February","March","April","May","June","July","August","September","October","November","December"],ft=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function dt(e){return e.slice(0,3)}const ht=ft.map(dt),pt=ct.map(dt),mt={MMMM:ct,MMM:pt,WWWW:ft,WWW:ht};function gt(e){return(e<10?"0":"")+e}const vt={YYYY:e=>e.getFullYear(),YY:e=>(e.getFullYear()+"").slice(2),MMMM:(e,t)=>t.MMMM[e.getMonth()],MMM:(e,t)=>t.MMM[e.getMonth()],MM:e=>gt(e.getMonth()+1),M:e=>e.getMonth()+1,DD:e=>gt(e.getDate()),D:e=>e.getDate(),WWWW:(e,t)=>t.WWWW[e.getDay()],WWW:(e,t)=>t.WWW[e.getDay()],HH:e=>gt(e.getHours()),H:e=>e.getHours(),h:e=>{let t=e.getHours();return 0==t?12:t>12?t-12:t},AA:e=>e.getHours()>=12?"PM":"AM",aa:e=>e.getHours()>=12?"pm":"am",a:e=>e.getHours()>=12?"p":"a",mm:e=>gt(e.getMinutes()),m:e=>e.getMinutes(),ss:e=>gt(e.getSeconds()),s:e=>e.getSeconds(),fff:e=>{return((t=e.getMilliseconds())<10?"00":t<100?"0":"")+t;var t}};function bt(e,t){t=t||mt;let l,n=[],i=/\{([a-z]+)\}|[^{]+/gi;for(;l=i.exec(e);)n.push("{"==l[0][0]?vt[l[1]]:l[0]);return e=>{let l="";for(let i=0;i<n.length;i++)l+="string"==typeof n[i]?n[i]:n[i](e,t);return l}}const wt=(new Intl.DateTimeFormat).resolvedOptions().timeZone;const xt=e=>e%1==0,yt=[1,2,2.5,5],_t=Xe(10,-32,0,yt),kt=Xe(10,0,32,yt),Mt=kt.filter(xt),St=_t.concat(kt),At="{YYYY}",Dt="\n"+At,Tt="{M}/{D}",Ct="\n"+Tt,Et=Ct+"/{YY}",Nt="{aa}",zt="{h}:{mm}"+Nt,Ft="\n"+zt,Pt=":{ss}",Lt=null;function It(e){let t=1e3*e,l=60*t,n=60*l,i=24*n,s=30*i,a=365*i;return[(1==e?Xe(10,0,3,yt).filter(xt):Xe(10,-3,0,yt)).concat([t,5*t,10*t,15*t,30*t,l,5*l,10*l,15*l,30*l,n,2*n,3*n,4*n,6*n,8*n,12*n,i,2*i,3*i,4*i,5*i,6*i,7*i,8*i,9*i,10*i,15*i,s,2*s,3*s,4*s,6*s,a,2*a,5*a,10*a,25*a,50*a,100*a]),[[a,At,Lt,Lt,Lt,Lt,Lt,Lt,1],[28*i,"{MMM}",Dt,Lt,Lt,Lt,Lt,Lt,1],[i,Tt,Dt,Lt,Lt,Lt,Lt,Lt,1],[n,"{h}"+Nt,Et,Lt,Ct,Lt,Lt,Lt,1],[l,zt,Et,Lt,Ct,Lt,Lt,Lt,1],[t,Pt,Et+" "+zt,Lt,Ct+" "+zt,Lt,Ft,Lt,1],[e,Pt+".{fff}",Et+" "+zt,Lt,Ct+" "+zt,Lt,Ft,Lt,1]],function(t){return(o,r,u,c,f,d)=>{let h=[],p=f>=a,m=f>=s&&f<a,g=t(u),v=Ke(g*e,3),b=Yt(g.getFullYear(),p?0:g.getMonth(),m||p?1:g.getDate()),w=Ke(b*e,3);if(m||p){let l=m?f/s:0,n=p?f/a:0,i=v==w?v:Ke(Yt(b.getFullYear()+n,b.getMonth()+l,1)*e,3),o=new Date(_e(i/e)),r=o.getFullYear(),u=o.getMonth();for(let s=0;i<=c;s++){let a=Yt(r+n*s,u+l*s,1),o=a-t(Ke(a*e,3));i=Ke((+a+o)*e,3),i<=c&&h.push(i)}}else{let s=f>=i?i:f,a=w+(ye(u)-ye(v))+Be(v-w,s);h.push(a);let p=t(a),m=p.getHours()+p.getMinutes()/l+p.getSeconds()/n,g=f/n,b=d/o.axes[r]._space;for(;a=Ke(a+f,1==e?0:3),!(a>c);)if(g>1){let e=ye(Ke(m+g,6))%24,l=t(a).getHours()-e;l>1&&(l=-1),a-=l*n,m=(m+g)%24,Ke((a-h[h.length-1])/f,3)*b>=.7&&h.push(a)}else h.push(a)}return h}}]}const[$t,Wt,Ht]=It(1),[Ot,Vt,jt]=It(.001);function Rt(e,t){return e.map(e=>e.map((l,n)=>0==n||8==n||null==l?l:t(1==n||0==e[8]?l:e[1]+l)))}function Bt(e,t){return(l,n,i,s,a)=>{let o,r,u,c,f,d,h=t.find(e=>a>=e[0])||t[t.length-1];return n.map(t=>{let l=e(t),n=l.getFullYear(),i=l.getMonth(),s=l.getDate(),a=l.getHours(),p=l.getMinutes(),m=l.getSeconds(),g=n!=o&&h[2]||i!=r&&h[3]||s!=u&&h[4]||a!=c&&h[5]||p!=f&&h[6]||m!=d&&h[7]||h[1];return o=n,r=i,u=s,c=a,f=p,d=m,g(l)})}}function Yt(e,t,l){return new Date(e,t,l)}function Kt(e,t){return t(e)}Xe(2,-53,53,[1]);function Gt(e,t){return(l,n,i,s)=>null==s?P:t(e(n))}const Ut={show:!0,live:!0,isolate:!1,mount:()=>{},markers:{show:!0,width:2,stroke:function(e,t){let l=e.series[t];return l.width?l.stroke(e,t):l.points.width?l.points.stroke(e,t):null},fill:function(e,t){return e.series[t].fill(e,t)},dash:"solid"},idx:null,idxs:null,values:[]};const Xt=[0,0];function qt(e,t,l,n=!0){return e=>{0==e.button&&(!n||e.target==t)&&l(e)}}function Jt(e,t,l,n=!0){return e=>{(!n||e.target==t)&&l(e)}}const Zt={show:!0,x:!0,y:!0,lock:!1,move:function(e,t,l){return Xt[0]=t,Xt[1]=l,Xt},points:{one:!1,show:function(e,t){let l=e.cursor.points,n=Y(),i=l.size(e,t);R(n,b,i),R(n,w,i);let s=i/-2;R(n,"marginLeft",s),R(n,"marginTop",s);let a=l.width(e,t,i);return a&&R(n,"borderWidth",a),n},size:function(e,t){return e.series[t].points.size},width:0,stroke:function(e,t){let l=e.series[t].points;return l._stroke||l._fill},fill:function(e,t){let l=e.series[t].points;return l._fill||l._stroke}},bind:{mousedown:qt,mouseup:qt,click:qt,dblclick:qt,mousemove:Jt,mouseleave:Jt,mouseenter:Jt},drag:{setScale:!0,x:!0,y:!1,dist:0,uni:null,click:(e,t)=>{t.stopPropagation(),t.stopImmediatePropagation()},_x:!1,_y:!1},focus:{dist:(e,t,l,n,i)=>n-i,prox:-1,bias:0},hover:{skip:[void 0],prox:null,bias:0},left:-10,top:-10,idx:null,dataIdx:null,idxs:null,event:null},Qt={show:!0,stroke:"rgba(0,0,0,0.07)",width:2},el=ot({},Qt,{filter:$e}),tl=ot({},el,{size:10}),ll=ot({},Qt,{show:!1}),nl='12px system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"',il="bold "+nl,sl={show:!0,scale:"x",stroke:M,space:50,gap:5,alignTo:1,size:50,labelGap:0,labelSize:30,labelFont:il,side:2,grid:el,ticks:tl,border:ll,font:nl,lineGap:1.5,rotate:0},al={show:!0,scale:"x",auto:!1,sorted:1,min:Ne,max:-Ne,idxs:[]};function ol(e,t,l,n,i){return t.map(e=>null==e?"":ve(e))}function rl(e,t,l,n,i,s,a){let o=[],r=Ge.get(i)||0;for(let u=l=a?l:Ke(Be(l,i),r);u<=n;u=Ke(u+i,r))o.push(Object.is(u,-0)?0:u);return o}function ul(e,t,l,n,i,s,a){const o=[],r=e.scales[e.axes[t].scale].log,u=ye((10==r?Te:Ce)(l));i=Ae(r,u),10==r&&(i=St[le(i,St)]);let c=l,f=i*r;10==r&&(f=St[le(f,St)]);do{o.push(c),c+=i,10!=r||Ge.has(c)||(c=Ke(c,Ge.get(i))),c>=f&&(f=(i=c)*r,10==r&&(f=St[le(f,St)]))}while(c<=n);return o}function cl(e,t,l,n,i,s,a){let o=e.scales[e.axes[t].scale].asinh,r=n>o?ul(e,t,Se(o,l),n,i):[o],u=n>=0&&l<=0?[0]:[];return(l<-o?ul(e,t,Se(o,-n),-l,i):[o]).reverse().map(e=>-e).concat(u,r)}const fl=/./,dl=/[12357]/,hl=/[125]/,pl=/1/,ml=(e,t,l,n)=>e.map((e,i)=>4==t&&0==e||i%n==0&&l.test(e.toExponential()[e<0?1:0])?e:null);function gl(e,t,l,n,i){let s=e.axes[l],a=s.scale,o=e.scales[a],r=e.valToPos,u=s._space,c=r(10,a),f=r(9,a)-c>=u?fl:r(7,a)-c>=u?dl:r(5,a)-c>=u?hl:pl;if(f==pl){let e=xe(r(1,a)-c);if(e<u)return ml(t.slice().reverse(),o.distr,f,ke(u/e)).reverse()}return ml(t,o.distr,f,1)}function vl(e,t,l,n,i){let s=e.axes[l],a=s.scale,o=s._space,r=e.valToPos,u=xe(r(1,a)-r(2,a));return u<o?ml(t.slice().reverse(),3,fl,ke(o/u)).reverse():t}function bl(e,t,l,n){return null==n?P:null==t?"":ve(t)}const wl={show:!0,scale:"y",stroke:M,space:30,gap:5,alignTo:1,size:50,labelGap:0,labelSize:30,labelFont:il,side:3,grid:el,ticks:tl,border:ll,font:nl,lineGap:1.5,rotate:0};const xl={scale:null,auto:!0,sorted:0,min:Ne,max:-Ne},yl=(e,t,l,n,i)=>i,_l={show:!0,auto:!0,sorted:0,gaps:yl,alpha:1,facets:[ot({},xl,{scale:"x"}),ot({},xl,{scale:"y"})]},kl={scale:"y",auto:!0,sorted:0,show:!0,spanGaps:!1,gaps:yl,alpha:1,points:{show:function(e,t){let{scale:l,idxs:n}=e.series[0],i=e._data[0],s=e.valToPos(i[n[0]],l,!0),a=e.valToPos(i[n[1]],l,!0),o=xe(a-s)/(e.series[t].points.space*H);return n[1]-n[0]<=o},filter:null},values:null,min:Ne,max:-Ne,idxs:[],path:null,clip:null};function Ml(e,t,l,n,i){return l/10}const Sl={time:!0,auto:!0,distr:1,log:10,asinh:1,min:null,max:null,dir:1,ori:0},Al=ot({},Sl,{time:!1,ori:1}),Dl={};function Tl(e,t){let l=Dl[e];return l||(l={key:e,plots:[],sub(e){l.plots.push(e)},unsub(e){l.plots=l.plots.filter(t=>t!=e)},pub(e,t,n,i,s,a,o){for(let r=0;r<l.plots.length;r++)l.plots[r]!=t&&l.plots[r].pub(e,t,n,i,s,a,o)}},null!=e&&(Dl[e]=l)),l}function Cl(e,t,l){const n=e.mode,i=e.series[t],s=2==n?e._data[t]:e._data,a=e.scales,o=e.bbox;let r=s[0],u=2==n?s[1]:s[t],c=2==n?a[i.facets[0].scale]:a[e.series[0].scale],f=2==n?a[i.facets[1].scale]:a[i.scale],d=o.left,h=o.top,p=o.width,m=o.height,g=e.valToPosH,v=e.valToPosV;return 0==c.ori?l(i,r,u,c,f,g,v,d,h,p,m,$l,Hl,Vl,Rl,Yl):l(i,r,u,c,f,v,g,h,d,m,p,Wl,Ol,jl,Bl,Kl)}function El(e,t){let l=0,n=0,i=pe(e.bands,Je);for(let s=0;s<i.length;s++){let e=i[s];e.series[0]==t?l=e.dir:e.series[1]==t&&(1==e.dir?n|=1:n|=2)}return[l,1==n?-1:2==n?1:3==n?2:0]}function Nl(e,t,l,n,i){let s=e.mode,a=e.series[t],o=2==s?a.facets[1].scale:a.scale,r=e.scales[o];return-1==i?r.min:1==i?r.max:3==r.distr?1==r.dir?r.min:r.max:0}function zl(e,t,l,n,i,s){return Cl(e,t,(e,t,a,o,r,u,c,f,d,h,p)=>{let m=e.pxRound;const g=o.dir*(0==o.ori?1:-1),v=0==o.ori?Hl:Ol;let b,w;1==g?(b=l,w=n):(b=n,w=l);let x=m(u(t[b],o,h,f)),y=m(c(a[b],r,p,d)),_=m(u(t[w],o,h,f)),k=m(c(1==s?r.max:r.min,r,p,d)),M=new Path2D(i);return v(M,_,k),v(M,x,k),v(M,x,y),M})}function Fl(e,t,l,n,i,s){let a=null;if(e.length>0){a=new Path2D;const o=0==t?Vl:jl;let r=l;for(let t=0;t<e.length;t++){let l=e[t];if(l[1]>l[0]){let e=l[0]-r;e>0&&o(a,r,n,e,n+s),r=l[1]}}let u=l+i-r,c=10;u>0&&o(a,r,n-c/2,u,n+s+c)}return a}function Pl(e,t,l,n,i,s,a){let o=[],r=e.length;for(let u=1==i?l:n;u>=l&&u<=n;u+=i){if(null===t[u]){let c=u,f=u;if(1==i)for(;++u<=n&&null===t[u];)f=u;else for(;--u>=l&&null===t[u];)f=u;let d=s(e[c]),h=f==c?d:s(e[f]),p=c-i;d=a<=0&&p>=0&&p<r?s(e[p]):d;let m=f+i;h=a>=0&&m>=0&&m<r?s(e[m]):h,h>=d&&o.push([d,h])}}return o}function Ll(e){return 0==e?Ie:1==e?_e:t=>Re(t,e)}function Il(e){let t=0==e?$l:Wl,l=0==e?(e,t,l,n,i,s)=>{e.arcTo(t,l,n,i,s)}:(e,t,l,n,i,s)=>{e.arcTo(l,t,i,n,s)},n=0==e?(e,t,l,n,i)=>{e.rect(t,l,n,i)}:(e,t,l,n,i)=>{e.rect(l,t,i,n)};return(e,i,s,a,o,r=0,u=0)=>{0==r&&0==u?n(e,i,s,a,o):(r=Me(r,a/2,o/2),u=Me(u,a/2,o/2),t(e,i+r,s),l(e,i+a,s,i+a,s+o,r),l(e,i+a,s+o,i,s+o,u),l(e,i,s+o,i,s,u),l(e,i,s,i+a,s,r),e.closePath())}}const $l=(e,t,l)=>{e.moveTo(t,l)},Wl=(e,t,l)=>{e.moveTo(l,t)},Hl=(e,t,l)=>{e.lineTo(t,l)},Ol=(e,t,l)=>{e.lineTo(l,t)},Vl=Il(0),jl=Il(1),Rl=(e,t,l,n,i,s)=>{e.arc(t,l,n,i,s)},Bl=(e,t,l,n,i,s)=>{e.arc(l,t,n,i,s)},Yl=(e,t,l,n,i,s,a)=>{e.bezierCurveTo(t,l,n,i,s,a)},Kl=(e,t,l,n,i,s,a)=>{e.bezierCurveTo(l,t,i,n,a,s)};function Gl(e){return(e,t,l,n,i)=>Cl(e,t,(t,s,a,o,r,u,c,f,d,h,p)=>{let m,g,{pxRound:v,points:b}=t;0==o.ori?(m=$l,g=Rl):(m=Wl,g=Bl);const w=Ke(b.width*H,3);let x=(b.size-b.width)/2*H,y=Ke(2*x,3),_=new Path2D,k=new Path2D,{left:M,top:S,width:A,height:D}=e.bbox;Vl(k,M-y,S-y,A+2*y,D+2*y);const T=e=>{if(null!=a[e]){let t=v(u(s[e],o,h,f)),l=v(c(a[e],r,p,d));m(_,t+x,l),g(_,t,l,x,0,2*we)}};if(i)i.forEach(T);else for(let e=l;e<=n;e++)T(e);return{stroke:w>0?_:null,fill:_,clip:k,flags:3}})}function Ul(e){return(t,l,n,i,s,a)=>{n!=i&&(s!=n&&a!=n&&e(t,l,n),s!=i&&a!=i&&e(t,l,i),e(t,l,a))}}const Xl=Ul(Hl),ql=Ul(Ol);function Jl(e){const t=pe(null==e?void 0:e.alignGaps,0);return(e,l,n,i)=>Cl(e,l,(s,a,o,r,u,c,f,d,h,p,m)=>{[n,i]=ae(o,n,i);let g,v,b=s.pxRound,w=e=>b(c(e,r,p,d)),x=e=>b(f(e,u,m,h));0==r.ori?(g=Hl,v=Xl):(g=Ol,v=ql);const y=r.dir*(0==r.ori?1:-1),_={stroke:new Path2D,fill:null,clip:null,band:null,gaps:null,flags:1},k=_.stroke;let M=!1;if(i-n>=4*p){let t,l,s,u=t=>e.posToVal(t,r.key,!0),c=null,f=null,d=w(a[1==y?n:i]),h=w(a[n]),p=w(a[i]),m=u(1==y?h+1:p-1);for(let e=1==y?n:i;e>=n&&e<=i;e+=y){let n=a[e],i=(1==y?n<m:n>m)?d:w(n),s=o[e];i==d?null!=s?(l=s,null==c?(g(k,i,x(l)),t=c=f=l):l<c?c=l:l>f&&(f=l)):null===s&&(M=!0):(null!=c&&v(k,d,x(c),x(f),x(t),x(l)),null!=s?(l=s,g(k,i,x(l)),c=f=t=l):(c=f=null,null===s&&(M=!0)),d=i,m=u(d+y))}null!=c&&c!=f&&s!=d&&v(k,d,x(c),x(f),x(t),x(l))}else for(let e=1==y?n:i;e>=n&&e<=i;e+=y){let t=o[e];null===t?M=!0:null!=t&&g(k,w(a[e]),x(t))}let[S,A]=El(e,l);if(null!=s.fill||0!=S){let t=_.fill=new Path2D(k),o=x(s.fillTo(e,l,s.min,s.max,S)),r=w(a[n]),u=w(a[i]);-1==y&&([u,r]=[r,u]),g(t,u,o),g(t,r,o)}if(!s.spanGaps){let u=[];M&&u.push(...Pl(a,o,n,i,y,w,t)),_.gaps=u=s.gaps(e,l,n,i,u),_.clip=Fl(u,r.ori,d,h,p,m)}return 0!=A&&(_.band=2==A?[zl(e,l,n,i,k,-1),zl(e,l,n,i,k,1)]:zl(e,l,n,i,k,A)),_})}function Zl(e,t,l,n,i,s,a=Ne){if(e.length>1){let o=null;for(let r=0,u=1/0;r<e.length;r++)if(void 0!==t[r]){if(null!=o){let t=xe(e[r]-e[o]);t<u&&(u=t,a=xe(l(e[r],n,i,s)-l(e[o],n,i,s)))}o=r}}return a}function Ql(e,t,l,n,i,s){const a=e.length;if(a<2)return null;const o=new Path2D;if(l(o,e[0],t[0]),2==a)n(o,e[1],t[1]);else{let l=Array(a),n=Array(a-1),s=Array(a-1),r=Array(a-1);for(let i=0;i<a-1;i++)s[i]=t[i+1]-t[i],r[i]=e[i+1]-e[i],n[i]=s[i]/r[i];l[0]=n[0];for(let e=1;e<a-1;e++)0===n[e]||0===n[e-1]||n[e-1]>0!=n[e]>0?l[e]=0:(l[e]=3*(r[e-1]+r[e])/((2*r[e]+r[e-1])/n[e-1]+(r[e]+2*r[e-1])/n[e]),isFinite(l[e])||(l[e]=0));l[a-1]=n[a-2];for(let u=0;u<a-1;u++)i(o,e[u]+r[u]/3,t[u]+l[u]*r[u]/3,e[u+1]-r[u]/3,t[u+1]-l[u+1]*r[u]/3,e[u+1],t[u+1])}return o}const en=new Set;function tn(){for(let e of en)e.syncRect(!0)}L&&(ee("resize",$,tn),ee("scroll",$,tn,!0),ee(F,$,()=>{gn.pxRatio=H}));const ln=Jl(),nn=Gl();function sn(e,t,l,n){return(n?[e[0],e[1]].concat(e.slice(2)):[e[0]].concat(e.slice(1))).map((e,n)=>an(e,n,t,l))}function an(e,t,l,n){return ot({},0==t?l:n,e)}function on(e,t,l){return null==t?Ze:[t,l]}const rn=on;function un(e,t,l){return null==t?Ze:he(t,l,.1,!0)}function cn(e,t,l,n){return null==t?Ze:re(t,l,e.scales[n].log,!1)}const fn=cn;function dn(e,t,l,n){return null==t?Ze:ue(t,l,e.scales[n].log,!1)}const hn=dn;function pn(e){let t,l;return[e=e.replace(/(\d+)px/,(e,n)=>(t=_e((l=+n)*H))+"px"),t,l]}function mn(e){e.show&&[e.font,e.labelFont].forEach(e=>{let t=Ke(e[2]*H,1);e[0]=e[0].replace(/[0-9.]+px/,t+"px"),e[1]=t})}function gn(e,t,l){var n,i;const s={mode:pe(e.mode,1)},a=s.mode;function o(e,t,l,n){let i=t.valToPct(e);return n+l*(-1==t.dir?1-i:i)}function r(e,t,l,n){let i=t.valToPct(e);return n+l*(-1==t.dir?i:1-i)}function u(e,t,l,n){return 0==t.ori?o(e,t,l,n):r(e,t,l,n)}s.valToPosH=o,s.valToPosV=r;let c=!1;s.status=0;const f=s.root=Y("uplot");if(null!=e.id&&(f.id=e.id),V(f,e.class),e.title){Y("u-title",f).textContent=e.title}const d=B("canvas"),h=s.ctx=d.getContext("2d"),p=Y("u-wrap",f);ee("click",p,e=>{if(e.target===M){(Kn!=jn||Gn!=Rn)&&li.click(s,e)}},!0);const m=s.under=Y("u-under",p);p.appendChild(d);const M=s.over=Y("u-over",p),z=+pe((e=at(e)).pxAlign,1),L=Ll(z);(e.plugins||[]).forEach(t=>{t.opts&&(e=t.opts(s,e)||e)});const W=e.ms||.001,O=s.series=1==a?sn(e.series||[],al,kl,!1):(K=e.series||[null],U=_l,K.map((e,t)=>0==t?{}:ot({},U,e)));var K,U;const q=s.axes=sn(e.axes||[],sl,wl,!0),Z=s.scales={},Q=s.bands=e.bands||[];Q.forEach(e=>{e.fill=Le(e.fill||null),e.dir=pe(e.dir,-1)});const ne=2==a?O[1].facets[0].scale:O[0].scale,fe={axes:function(){for(let e=0;e<q.length;e++){let t=q[e];if(!t.show||!t._show)continue;let l,n,i=t.side,a=i%2,o=t.stroke(s,e),r=0==i||3==i?-1:1,[c,f]=t._found;if(null!=t.label){let u=t.labelGap*r,d=_e((t._lpos+u)*H);_n(t.labelFont[0],o,"center",2==i?x:y),h.save(),1==a?(l=n=0,h.translate(d,_e(Jt+el/2)),h.rotate((3==i?-we:we)/2)):(l=_e(qt+Qt/2),n=d);let p=Pe(t.label)?t.label(s,e,c,f):t.label;h.fillText(p,l,n),h.restore()}if(0==f)continue;let d=Z[t.scale],p=0==a?Qt:el,m=0==a?qt:Jt,g=t._splits,v=2==d.distr?g.map(e=>vn[e]):g,b=2==d.distr?vn[g[1]]-vn[g[0]]:c,w=t.ticks,M=t.border,S=w.show?w.size:0,A=_e(S*H),D=_e((2==t.alignTo?t._size-S-t.gap:t.gap)*H),T=t._rotate*-we/180,C=L(t._pos*H),E=C+(A+D)*r;n=0==a?E:0,l=1==a?E:0,_n(t.font[0],o,1==t.align?_:2==t.align?k:T>0?_:T<0?k:0==a?"center":3==i?k:_,T||1==a?"middle":2==i?x:y);let N=t.font[1]*t.lineGap,z=g.map(e=>L(u(e,d,p,m))),F=t._values;for(let e=0;e<F.length;e++){let t=F[e];if(null!=t){0==a?l=z[e]:n=z[e],t=""+t;let i=-1==t.indexOf("\n")?[t]:t.split(/\n/gm);for(let e=0;e<i.length;e++){let t=i[e];T?(h.save(),h.translate(l,n+e*N),h.rotate(T),h.fillText(t,0,0),h.restore()):h.fillText(t,l,n+e*N)}}}w.show&&zn(z,w.filter(s,v,e,f,b),a,i,C,A,Ke(w.width*H,3),w.stroke(s,e),w.dash,w.cap);let P=t.grid;P.show&&zn(z,P.filter(s,v,e,f,b),a,0==a?2:1,0==a?Jt:qt,0==a?el:Qt,Ke(P.width*H,3),P.stroke(s,e),P.dash,P.cap),M.show&&zn([C],[1],0==a?1:0,0==a?1:2,1==a?Jt:qt,1==a?el:Qt,Ke(M.width*H,3),M.stroke(s,e),M.dash,M.cap)}Wi("drawAxes")},series:function(){if(jl>0){let e=O.some(e=>e._focus)&&gn!=Dl.alpha;e&&(h.globalAlpha=gn=Dl.alpha),O.forEach((e,l)=>{if(l>0&&e.show&&(Sn(l,!1),Sn(l,!0),null==e._paths)){let n=gn;gn!=e.alpha&&(h.globalAlpha=gn=e.alpha);let i=2==a?[0,t[l][0].length-1]:function(e){let t=Fe(Rl-1,0,jl-1),l=Fe(Bl+1,0,jl-1);for(;null==e[t]&&t>0;)t--;for(;null==e[l]&&l<jl-1;)l++;return[t,l]}(t[l]);e._paths=e.paths(s,l,i[0],i[1]),gn!=n&&(h.globalAlpha=gn=n)}}),O.forEach((e,t)=>{if(t>0&&e.show){let l=gn;gn!=e.alpha&&(h.globalAlpha=gn=e.alpha),null!=e._paths&&An(t,!1);{let l=null!=e._paths?e._paths.gaps:null,n=e.points.show(s,t,Rl,Bl,l),i=e.points.filter(s,t,n,l);(n||i)&&(e.points._paths=e.points.paths(s,t,Rl,Bl,i),An(t,!0))}gn!=l&&(h.globalAlpha=gn=l),Wi("drawSeries",t)}}),e&&(h.globalAlpha=gn=1)}}},de=(e.drawOrder||["axes","series"]).map(e=>fe[e]);function me(e){const t=3==e.distr?t=>Te(t>0?t:e.clamp(s,t,e.min,e.max,e.key)):4==e.distr?t=>Ee(t,e.asinh):100==e.distr?t=>e.fwd(t):e=>e;return l=>{let n=t(l),{_min:i,_max:s}=e;return(n-i)/(s-i)}}function ge(t){let l=Z[t];if(null==l){let n=(e.scales||qe)[t]||qe;if(null!=n.from){ge(n.from);let e=ot({},Z[n.from],n,{key:t});e.valToPct=me(e),Z[t]=e}else{l=Z[t]=ot({},t==ne?Sl:Al,n),l.key=t;let e=l.time,i=l.range,s=Qe(i);if((t!=ne||2==a&&!e)&&(!s||null!=i[0]&&null!=i[1]||(i={min:null==i[0]?ce:{mode:1,hard:i[0],soft:i[0]},max:null==i[1]?ce:{mode:1,hard:i[1],soft:i[1]}},s=!1),!s&&lt(i))){let e=i;i=(t,l,n)=>null==l?Ze:he(l,n,e)}l.range=Le(i||(e?rn:t==ne?3==l.distr?fn:4==l.distr?hn:on:3==l.distr?cn:4==l.distr?dn:un)),l.auto=Le(!s&&l.auto),l.clamp=Le(l.clamp||Ml),l._min=l._max=null,l.valToPct=me(l)}}}ge("x"),ge("y"),1==a&&O.forEach(e=>{ge(e.scale)}),q.forEach(e=>{ge(e.scale)});for(let g in e.scales)ge(g);const ve=Z[ne],ye=ve.distr;let De,Ce;0==ve.ori?(V(f,"u-hz"),De=o,Ce=r):(V(f,"u-vt"),De=r,Ce=o);const Ie={};for(let g in Z){let e=Z[g];null==e.min&&null==e.max||(Ie[g]={min:e.min,max:e.max},e.min=e.max=null)}const Ve=e.tzDate||(e=>new Date(_e(e/W))),je=e.fmtDate||bt,Be=1==W?Ht(Ve):jt(Ve),Ye=Bt(Ve,Rt(1==W?Wt:Vt,je)),Xe=Gt(Ve,Kt("{YYYY}-{MM}-{DD} {h}:{mm}{aa}",je)),et=[],it=s.legend=ot({},Ut,e.legend),st=s.cursor=ot({},Zt,{drag:{y:2==a}},e.cursor),rt=it.show,ct=st.show,ft=it.markers;let dt,ht,pt;it.idxs=et,ft.width=Le(ft.width),ft.dash=Le(ft.dash),ft.stroke=Le(ft.stroke),ft.fill=Le(ft.fill);let mt,gt=[],vt=[],wt=!1,xt={};if(it.live){const e=O[1]?O[1].values:null;wt=null!=e,mt=wt?e(s,1,0):{_:0};for(let t in mt)xt[t]=P}if(rt)if(dt=B("table","u-legend",f),pt=B("tbody",null,dt),it.mount(s,dt),wt){ht=B("thead",null,dt,pt);let e=B("tr",null,ht);for(var yt in B("th",null,e),mt)B("th",v,e).textContent=yt}else V(dt,"u-inline"),it.live&&V(dt,"u-live");const _t={show:!0},kt={show:!1};const At=new Map;function Dt(e,t,l,n=!0){const i=At.get(t)||{},a=st.bind[e](s,t,l,n);a&&(ee(e,t,i[e]=a),At.set(t,i))}function Tt(e,t,l){const n=At.get(t)||{};for(let i in n)null!=e&&i!=e||(te(i,t,n[i]),delete n[i]);null==e&&At.delete(t)}let Ct=0,Et=0,Nt=0,zt=0,Ft=0,Pt=0,Lt=Ft,It=Pt,Yt=Nt,Xt=zt,qt=0,Jt=0,Qt=0,el=0;s.bbox={};let tl=!1,ll=!1,nl=!1,il=!1,fl=!1,dl=!1;function hl(e,t,l){(l||e!=s.width||t!=s.height)&&pl(e,t),Ln(!1),nl=!0,ll=!0,Zn()}function pl(e,t){s.width=Ct=Nt=e,s.height=Et=zt=t,Ft=Pt=0,function(){let e=!1,t=!1,l=!1,n=!1;q.forEach((i,s)=>{if(i.show&&i._show){let{side:s,_size:a}=i,o=s%2,r=a+(null!=i.label?i.labelSize:0);r>0&&(o?(Nt-=r,3==s?(Ft+=r,n=!0):l=!0):(zt-=r,0==s?(Pt+=r,e=!0):t=!0))}}),Wl[0]=e,Wl[1]=l,Wl[2]=t,Wl[3]=n,Nt-=Vl[1]+Vl[3],Ft+=Vl[3],zt-=Vl[2]+Vl[0],Pt+=Vl[0]}(),function(){let e=Ft+Nt,t=Pt+zt,l=Ft,n=Pt;function i(i,s){switch(i){case 1:return e+=s,e-s;case 2:return t+=s,t-s;case 3:return l-=s,l+s;case 0:return n-=s,n+s}}q.forEach((e,t)=>{if(e.show&&e._show){let t=e.side;e._pos=i(t,e._size),null!=e.label&&(e._lpos=i(t,e.labelSize))}})}();let l=s.bbox;qt=l.left=Re(Ft*H,.5),Jt=l.top=Re(Pt*H,.5),Qt=l.width=Re(Nt*H,.5),el=l.height=Re(zt*H,.5)}const ml=3;if(s.setSize=function({width:e,height:t}){hl(e,t)},null==st.dataIdx){let e=st.hover,l=e.skip=new Set(null!=(n=e.skip)?n:[]);l.add(void 0);let s=e.prox=Le(e.prox),a=null!=(i=e.bias)?i:e.bias=0;st.dataIdx=(e,n,i,o)=>{var r;if(0==n)return i;let u=i,c=null!=(r=s(e,n,i,o))?r:Ne,f=c>=0&&c<Ne,d=0==ve.ori?Nt:zt,h=st.left,p=t[0],m=t[n];if(l.has(m[i])){u=null;let e,t=null,n=null;if(0==a||-1==a)for(e=i;null==t&&e-- >0;)l.has(m[e])||(t=e);if(0==a||1==a)for(e=i;null==n&&e++<m.length;)l.has(m[e])||(n=e);if(null!=t||null!=n)if(f){let e=h-(null==t?-1/0:De(p[t],ve,d,0)),l=(null==n?1/0:De(p[n],ve,d,0))-h;e<=l?e<=c&&(u=t):l<=c&&(u=n)}else u=null==n?t:null==t?n:i-t<=n-i?t:n}else if(f){xe(h-De(p[i],ve,d,0))>c&&(u=null)}return u}}const xl=e=>{st.event=e};st.idxs=et,st._lock=!1;let yl=st.points;yl.show=Le(yl.show),yl.size=Le(yl.size),yl.stroke=Le(yl.stroke),yl.width=Le(yl.width),yl.fill=Le(yl.fill);const Dl=s.focus=ot({},e.focus||{alpha:.3},st.focus),Cl=Dl.prox>=0,El=Cl&&yl.one;let zl=[],Fl=[],Pl=[];function Il(e,t){let l=yl.show(s,t);if(l instanceof HTMLElement)return V(l,"u-cursor-pt"),V(l,e.class),G(l,-10,-10,Nt,zt),M.insertBefore(l,zl[t]),l}function $l(e,t){if(1==a||t>0){let t=1==a&&Z[e.scale].time,l=e.value;e.value=t?tt(l)?Gt(Ve,Kt(l,je)):l||Xe:l||bl,e.label=e.label||(t?"Time":"Value")}if(El||t>0){e.width=null==e.width?1:e.width,e.paths=e.paths||ln||We,e.fillTo=Le(e.fillTo||Nl),e.pxAlign=+pe(e.pxAlign,z),e.pxRound=Ll(e.pxAlign),e.stroke=Le(e.stroke||null),e.fill=Le(e.fill||null),e._stroke=e._fill=e._paths=e._focus=null;let t=Ke((3+2*(Se(1,e.width)||1))*1,3),l=e.points=ot({},{size:t,width:Se(1,.2*t),stroke:e.stroke,space:2*t,paths:nn,_stroke:null,_fill:null},e.points);l.show=Le(l.show),l.filter=Le(l.filter),l.fill=Le(l.fill),l.stroke=Le(l.stroke),l.paths=Le(l.paths),l.pxAlign=e.pxAlign}if(rt){let l=function(e,t){if(0==t&&(wt||!it.live||2==a))return Ze;let l=[],n=B("tr","u-series",pt,pt.childNodes[t]);V(n,e.class),e.show||V(n,g);let i=B("th",null,n);if(ft.show){let e=Y("u-marker",i);if(t>0){let l=ft.width(s,t);l&&(e.style.border=l+"px "+ft.dash(s,t)+" "+ft.stroke(s,t)),e.style.background=ft.fill(s,t)}}let o=Y(v,i);for(var r in e.label instanceof HTMLElement?o.appendChild(e.label):o.textContent=e.label,t>0&&(ft.show||(o.style.color=e.width>0?ft.stroke(s,t):ft.fill(s,t)),Dt("click",i,t=>{if(st._lock)return;xl(t);let l=O.indexOf(e);if((t.ctrlKey||t.metaKey)!=it.isolate){let e=O.some((e,t)=>t>0&&t!=l&&e.show);O.forEach((t,n)=>{n>0&&ui(n,e?n==l?_t:kt:_t,!0,Oi.setSeries)})}else ui(l,{show:!e.show},!0,Oi.setSeries)},!1),Cl&&Dt(C,i,t=>{st._lock||(xl(t),ui(O.indexOf(e),hi,!0,Oi.setSeries))},!1)),mt){let e=B("td","u-value",n);e.textContent="--",l.push(e)}return[n,l]}(e,t);gt.splice(t,0,l[0]),vt.splice(t,0,l[1]),it.values.push(null)}if(ct){et.splice(t,0,null);let l=null;El?0==t&&(l=Il(e,t)):t>0&&(l=Il(e,t)),zl.splice(t,0,l),Fl.splice(t,0,0),Pl.splice(t,0,0)}Wi("addSeries",t)}s.addSeries=function(e,t){t=null==t?O.length:t,e=1==a?an(e,t,al,kl):an(e,t,{},_l),O.splice(t,0,e),$l(O[t],t)},s.delSeries=function(e){if(O.splice(e,1),rt){it.values.splice(e,1),vt.splice(e,1);let t=gt.splice(e,1)[0];Tt(null,t.firstChild),t.remove()}ct&&(et.splice(e,1),zl.splice(e,1)[0].remove(),Fl.splice(e,1),Pl.splice(e,1)),Wi("delSeries",e)};const Wl=[!1,!1,!1,!1];function Hl(e,t,l,n){let[i,s,a,o]=l,r=t%2,u=0;return 0==r&&(o||s)&&(u=0==t&&!i||2==t&&!a?_e(sl.size/3):0),1==r&&(i||a)&&(u=1==t&&!s||3==t&&!o?_e(wl.size/2):0),u}const Ol=s.padding=(e.padding||[Hl,Hl,Hl,Hl]).map(e=>Le(pe(e,Hl))),Vl=s._padding=Ol.map((e,t)=>e(s,t,Wl,0));let jl,Rl=null,Bl=null;const Yl=1==a?O[0].idxs:null;let Kl,Gl,Ul,Xl,ql,Jl,Zl,Ql,tn,gn,vn=null,bn=!1;function wn(e,l){if(t=null==e?[]:e,s.data=s._data=t,2==a){jl=0;for(let e=1;e<O.length;e++)jl+=t[e][0].length}else{0==t.length&&(s.data=s._data=t=[[]]),vn=t[0],jl=vn.length;let e=t;if(2==ye){e=t.slice();let l=e[0]=Array(jl);for(let e=0;e<jl;e++)l[e]=e}s._data=t=e}if(Ln(!0),Wi("setData"),2==ye&&(nl=!0),!1!==l){let e=ve;e.auto(s,bn)?xn():ri(ne,e.min,e.max),il=il||st.left>=0,dl=!0,Zn()}}function xn(){let e,l;bn=!0,1==a&&(jl>0?(Rl=Yl[0]=0,Bl=Yl[1]=jl-1,e=t[0][Rl],l=t[0][Bl],2==ye?(e=Rl,l=Bl):e==l&&(3==ye?[e,l]=re(e,e,ve.log,!1):4==ye?[e,l]=ue(e,e,ve.log,!1):ve.time?l=e+_e(86400/W):[e,l]=he(e,l,.1,!0))):(Rl=Yl[0]=e=null,Bl=Yl[1]=l=null)),ri(ne,e,l)}function yn(e,t,l,n,i,s){null!=e||(e=S),null!=l||(l=Je),null!=n||(n="butt"),null!=i||(i=S),null!=s||(s="round"),e!=Kl&&(h.strokeStyle=Kl=e),i!=Gl&&(h.fillStyle=Gl=i),t!=Ul&&(h.lineWidth=Ul=t),s!=ql&&(h.lineJoin=ql=s),n!=Jl&&(h.lineCap=Jl=n),l!=Xl&&h.setLineDash(Xl=l)}function _n(e,t,l,n){t!=Gl&&(h.fillStyle=Gl=t),e!=Zl&&(h.font=Zl=e),l!=Ql&&(h.textAlign=Ql=l),n!=tn&&(h.textBaseline=tn=n)}function kn(e,t,l,n,i=0){if(n.length>0&&e.auto(s,bn)&&(null==t||null==t.min)){let t=pe(Rl,0),s=pe(Bl,n.length-1),a=null==l.min?function(e,t,l,n=0,i=!1){let s=i?oe:ae,a=i?se:ie;[t,l]=s(e,t,l);let o=e[t],r=e[t];if(t>-1)if(1==n)o=e[t],r=e[l];else if(-1==n)o=e[l],r=e[t];else for(let u=t;u<=l;u++){let t=e[u];a(t)&&(t<o?o=t:t>r&&(r=t))}return[null!=o?o:Ne,null!=r?r:-Ne]}(n,t,s,i,3==e.distr):[l.min,l.max];e.min=Me(e.min,l.min=a[0]),e.max=Se(e.max,l.max=a[1])}}s.setData=wn;const Mn={min:null,max:null};function Sn(e,t){let l=t?O[e].points:O[e];l._stroke=l.stroke(s,e),l._fill=l.fill(s,e)}function An(e,l){let n=l?O[e].points:O[e],{stroke:i,fill:a,clip:o,flags:r,_stroke:u=n._stroke,_fill:c=n._fill,_width:f=n.width}=n._paths;f=Ke(f*H,3);let d=null,p=f%2/2;l&&null==c&&(c=f>0?"#fff":u);let m=1==n.pxAlign&&p>0;if(m&&h.translate(p,p),!l){let e=qt-f/2,t=Jt-f/2,l=Qt+f,n=el+f;d=new Path2D,d.rect(e,t,l,n)}l?Tn(u,f,n.dash,n.cap,c,i,a,r,o):function(e,l,n,i,a,o,r,u,c,f,d){let h=!1;0!=c&&Q.forEach((p,m)=>{if(p.series[0]==e){let e,g=O[p.series[1]],v=t[p.series[1]],b=(g._paths||qe).band;Qe(b)&&(b=1==p.dir?b[0]:b[1]);let w=null;g.show&&b&&function(e,t,l){for(t=pe(t,0),l=pe(l,e.length-1);t<=l;){if(null!=e[t])return!0;t++}return!1}(v,Rl,Bl)?(w=p.fill(s,m)||o,e=g._paths.clip):b=null,Tn(l,n,i,a,w,r,u,c,f,d,e,b),h=!0}}),h||Tn(l,n,i,a,o,r,u,c,f,d)}(e,u,f,n.dash,n.cap,c,i,a,r,d,o),m&&h.translate(-p,-p)}const Dn=3;function Tn(e,t,l,n,i,s,a,o,r,u,c,f){yn(e,t,l,n,i),(r||u||f)&&(h.save(),r&&h.clip(r),u&&h.clip(u)),f?(o&Dn)==Dn?(h.clip(f),c&&h.clip(c),En(i,a),Cn(e,s,t)):2&o?(En(i,a),h.clip(f),Cn(e,s,t)):1&o&&(h.save(),h.clip(f),c&&h.clip(c),En(i,a),h.restore(),Cn(e,s,t)):(En(i,a),Cn(e,s,t)),(r||u||f)&&h.restore()}function Cn(e,t,l){l>0&&(t instanceof Map?t.forEach((e,t)=>{h.strokeStyle=Kl=t,h.stroke(e)}):null!=t&&e&&h.stroke(t))}function En(e,t){t instanceof Map?t.forEach((e,t)=>{h.fillStyle=Gl=t,h.fill(e)}):null!=t&&e&&h.fill(t)}function Nn(e,t,l,n){let i,a=q[e];if(n<=0)i=[0,0];else{let o=a._space=a.space(s,e,t,l,n);i=function(e,t,l,n,i){let s=Se(ze(e),ze(t)),a=t-e,o=le(i/n*a,l);do{let e=l[o],t=n*e/a;if(t>=i&&s+(e<5?Ge.get(e):0)<=17)return[e,t]}while(++o<l.length);return[0,0]}(t,l,a._incrs=a.incrs(s,e,t,l,n,o),n,o)}return a._found=i}function zn(e,t,l,n,i,s,a,o,r,u){let c=a%2/2;1==z&&h.translate(c,c),yn(o,a,r,u,o),h.beginPath();let f,d,p,m,g=i+(0==n||3==n?-s:s);0==l?(d=i,m=g):(f=i,p=g);for(let v=0;v<e.length;v++)null!=t[v]&&(0==l?f=p=e[v]:d=m=e[v],h.moveTo(f,d),h.lineTo(p,m));h.stroke(),1==z&&h.translate(-c,-c)}function Fn(e){let t=!0;return q.forEach((l,n)=>{if(!l.show)return;let i=Z[l.scale];if(null==i.min)return void(l._show&&(t=!1,l._show=!1,Ln(!1)));l._show||(t=!1,l._show=!0,Ln(!1));let a=l.side,o=a%2,{min:r,max:u}=i,[c,f]=Nn(n,r,u,0==o?Nt:zt);if(0==f)return;let d=2==i.distr,h=l._splits=l.splits(s,n,r,u,c,f,d),p=2==i.distr?h.map(e=>vn[e]):h,m=2==i.distr?vn[h[1]]-vn[h[0]]:c,g=l._values=l.values(s,l.filter(s,p,n,f,m),n,f,m);l._rotate=2==a?l.rotate(s,g,n,f):0;let v=l._size;l._size=ke(l.size(s,g,n,e)),null!=v&&l._size!=v&&(t=!1)}),t}function Pn(e){let t=!0;return Ol.forEach((l,n)=>{let i=l(s,n,Wl,e);i!=Vl[n]&&(t=!1),Vl[n]=i}),t}function Ln(e){O.forEach((t,l)=>{l>0&&(t._paths=null,e&&(1==a?(t.min=null,t.max=null):t.facets.forEach(e=>{e.min=null,e.max=null})))})}let In,$n,Wn,Hn,On,Vn,jn,Rn,Bn,Yn,Kn,Gn,Un=!1,Xn=!1,qn=[];function Jn(){Xn=!1;for(let e=0;e<qn.length;e++)Wi(...qn[e]);qn.length=0}function Zn(){Un||(ut(Qn),Un=!0)}function Qn(){if(tl&&(!function(){for(let t in Z){let e=Z[t];null==Ie[t]&&(null==e.min||null!=Ie[ne]&&e.auto(s,bn))&&(Ie[t]=Mn)}for(let t in Z){let e=Z[t];null==Ie[t]&&null!=e.from&&null!=Ie[e.from]&&(Ie[t]=Mn)}null!=Ie[ne]&&Ln(!0);let e={};for(let t in Ie){let l=Ie[t];if(null!=l){let n=e[t]=at(Z[t],nt);if(null!=l.min)ot(n,l);else if(t!=ne||2==a)if(0==jl&&null==n.from){let e=n.range(s,null,null,t);n.min=e[0],n.max=e[1]}else n.min=Ne,n.max=-Ne}}if(jl>0){O.forEach((l,n)=>{if(1==a){let i=l.scale,a=Ie[i];if(null==a)return;let o=e[i];if(0==n){let e=o.range(s,o.min,o.max,i);o.min=e[0],o.max=e[1],Rl=le(o.min,t[0]),Bl=le(o.max,t[0]),Bl-Rl>1&&(t[0][Rl]<o.min&&Rl++,t[0][Bl]>o.max&&Bl--),l.min=vn[Rl],l.max=vn[Bl]}else l.show&&l.auto&&kn(o,a,l,t[n],l.sorted);l.idxs[0]=Rl,l.idxs[1]=Bl}else if(n>0&&l.show&&l.auto){let[i,s]=l.facets,a=i.scale,o=s.scale,[r,u]=t[n],c=e[a],f=e[o];null!=c&&kn(c,Ie[a],i,r,i.sorted),null!=f&&kn(f,Ie[o],s,u,s.sorted),l.min=s.min,l.max=s.max}});for(let t in e){let l=e[t],n=Ie[t];if(null==l.from&&(null==n||null==n.min)){let e=l.range(s,l.min==Ne?null:l.min,l.max==-Ne?null:l.max,t);l.min=e[0],l.max=e[1]}}}for(let t in e){let l=e[t];if(null!=l.from){let n=e[l.from];if(null==n.min)l.min=l.max=null;else{let e=l.range(s,n.min,n.max,t);l.min=e[0],l.max=e[1]}}}let l={},n=!1;for(let t in e){let i=e[t],s=Z[t];if(s.min!=i.min||s.max!=i.max){s.min=i.min,s.max=i.max;let e=s.distr;s._min=3==e?Te(s.min):4==e?Ee(s.min,s.asinh):100==e?s.fwd(s.min):s.min,s._max=3==e?Te(s.max):4==e?Ee(s.max,s.asinh):100==e?s.fwd(s.max):s.max,l[t]=n=!0}}if(n){O.forEach((e,t)=>{2==a?t>0&&l.y&&(e._paths=null):l[e.scale]&&(e._paths=null)});for(let e in l)nl=!0,Wi("setScale",e);ct&&st.left>=0&&(il=dl=!0)}for(let t in Ie)Ie[t]=null}(),tl=!1),nl&&(!function(){let e=!1,t=0;for(;!e;){t++;let l=Fn(t),n=Pn(t);e=t==ml||l&&n,e||(pl(s.width,s.height),ll=!0)}}(),nl=!1),ll){if(R(m,_,Ft),R(m,x,Pt),R(m,b,Nt),R(m,w,zt),R(M,_,Ft),R(M,x,Pt),R(M,b,Nt),R(M,w,zt),R(p,b,Ct),R(p,w,Et),d.width=_e(Ct*H),d.height=_e(Et*H),q.forEach(({_el:e,_show:t,_size:l,_pos:n,side:i})=>{if(null!=e)if(t){let t=i%2==1;R(e,t?"left":"top",n-(3===i||0===i?l:0)),R(e,t?"width":"height",l),R(e,t?"top":"left",t?Pt:Ft),R(e,t?"height":"width",t?zt:Nt),j(e,g)}else V(e,g)}),Kl=Gl=Ul=ql=Jl=Zl=Ql=tn=Xl=null,gn=1,ki(!0),Ft!=Lt||Pt!=It||Nt!=Yt||zt!=Xt){Ln(!1);let e=Nt/Yt,t=zt/Xt;if(ct&&!il&&st.left>=0){st.left*=e,st.top*=t,Wn&&G(Wn,_e(st.left),0,Nt,zt),Hn&&G(Hn,0,_e(st.top),Nt,zt);for(let l=0;l<zl.length;l++){let n=zl[l];null!=n&&(Fl[l]*=e,Pl[l]*=t,G(n,ke(Fl[l]),ke(Pl[l]),Nt,zt))}}if(si.show&&!fl&&si.left>=0&&si.width>0){si.left*=e,si.width*=e,si.top*=t,si.height*=t;for(let e in Ai)R(ai,e,si[e])}Lt=Ft,It=Pt,Yt=Nt,Xt=zt}Wi("setSize"),ll=!1}Ct>0&&Et>0&&(h.clearRect(0,0,d.width,d.height),Wi("drawClear"),de.forEach(e=>e()),Wi("draw")),si.show&&fl&&(oi(si),fl=!1),ct&&il&&(yi(null,!0,!1),il=!1),it.show&&it.live&&dl&&(wi(),dl=!1),c||(c=!0,s.status=1,Wi("ready")),bn=!1,Un=!1}function ei(e,l){let n=Z[e];if(null==n.from){if(0==jl){let t=n.range(s,l.min,l.max,e);l.min=t[0],l.max=t[1]}if(l.min>l.max){let e=l.min;l.min=l.max,l.max=e}if(jl>1&&null!=l.min&&null!=l.max&&l.max-l.min<1e-16)return;e==ne&&2==n.distr&&jl>0&&(l.min=le(l.min,t[0]),l.max=le(l.max,t[0]),l.min==l.max&&l.max++),Ie[e]=l,tl=!0,Zn()}}s.batch=function(e,t=!1){Un=!0,Xn=t,e(s),Qn(),t&&qn.length>0&&queueMicrotask(Jn)},s.redraw=(e,t)=>{nl=t||!1,!1!==e?ri(ne,ve.min,ve.max):Zn()},s.setScale=ei;let ti=!1;const li=st.drag;let ni=li.x,ii=li.y;ct&&(st.x&&(In=Y("u-cursor-x",M)),st.y&&($n=Y("u-cursor-y",M)),0==ve.ori?(Wn=In,Hn=$n):(Wn=$n,Hn=In),Kn=st.left,Gn=st.top);const si=s.select=ot({show:!0,over:!0,left:0,width:0,top:0,height:0},e.select),ai=si.show?Y("u-select",si.over?M:m):null;function oi(e,t){if(si.show){for(let t in e)si[t]=e[t],t in Ai&&R(ai,t,e[t]);!1!==t&&Wi("setSelect")}}function ri(e,t,l){ei(e,{min:t,max:l})}function ui(e,t,l,n){null!=t.focus&&function(e){if(e!=di){let t=null==e,l=1!=Dl.alpha;O.forEach((n,i)=>{if(1==a||i>0){let s=t||0==i||i==e;n._focus=t?null:s,l&&function(e,t){O[e].alpha=t,ct&&null!=zl[e]&&(zl[e].style.opacity=t);rt&&gt[e]&&(gt[e].style.opacity=t)}(i,s?1:Dl.alpha)}}),di=e,l&&Zn()}}(e),null!=t.show&&O.forEach((l,n)=>{n>0&&(e==n||null==e)&&(l.show=t.show,function(e){if(O[e].show)rt&&j(gt[e],g);else if(rt&&V(gt[e],g),ct){let t=El?zl[0]:zl[e];null!=t&&G(t,-10,-10,Nt,zt)}}(n),2==a?(ri(l.facets[0].scale,null,null),ri(l.facets[1].scale,null,null)):ri(l.scale,null,null),Zn())}),!1!==l&&Wi("setSeries",e,t),n&&Ri("setSeries",s,e,t)}let ci,fi,di;s.setSelect=oi,s.setSeries=ui,s.addBand=function(e,t){e.fill=Le(e.fill||null),e.dir=pe(e.dir,-1),t=null==t?Q.length:t,Q.splice(t,0,e)},s.setBand=function(e,t){ot(Q[e],t)},s.delBand=function(e){null==e?Q.length=0:Q.splice(e,1)};const hi={focus:!0};function pi(e,t,l){let n=Z[t];l&&(e=e/H-(1==n.ori?Pt:Ft));let i=Nt;1==n.ori&&(i=zt,e=i-e),-1==n.dir&&(e=i-e);let s=n._min,a=s+(n._max-s)*(e/i),o=n.distr;return 3==o?Ae(10,a):4==o?((e,t=1)=>be.sinh(e)*t)(a,n.asinh):100==o?n.bwd(a):a}function mi(e,t){R(ai,_,si.left=e),R(ai,b,si.width=t)}function gi(e,t){R(ai,x,si.top=e),R(ai,w,si.height=t)}rt&&Cl&&Dt(E,dt,e=>{st._lock||(xl(e),null!=di&&ui(null,hi,!0,Oi.setSeries))}),s.valToIdx=e=>le(e,t[0]),s.posToIdx=function(e,l){return le(pi(e,ne,l),t[0],Rl,Bl)},s.posToVal=pi,s.valToPos=(e,t,l)=>0==Z[t].ori?o(e,Z[t],l?Qt:Nt,l?qt:0):r(e,Z[t],l?el:zt,l?Jt:0),s.setCursor=(e,t,l)=>{Kn=e.left,Gn=e.top,yi(null,t,l)};let vi=0==ve.ori?mi:gi,bi=1==ve.ori?mi:gi;function wi(e,t){if(null!=e&&(e.idxs?e.idxs.forEach((e,t)=>{et[t]=e}):void 0!==e.idx&&et.fill(e.idx),it.idx=et[0]),rt&&it.live){for(let e=0;e<O.length;e++)(e>0||1==a&&!wt)&&xi(e,et[e]);!function(){if(rt&&it.live)for(let e=2==a?1:0;e<O.length;e++){if(0==e&&wt)continue;let t=it.values[e],l=0;for(let n in t)vt[e][l++].firstChild.nodeValue=t[n]}}()}dl=!1,!1!==t&&Wi("setLegend")}function xi(e,l){var n;let i,a=O[e],o=0==e&&2==ye?vn:t[e];wt?i=null!=(n=a.values(s,e,l))?n:xt:(i=a.value(s,null==l?null:o[l],e,l),i=null==i?xt:{_:i}),it.values[e]=i}function yi(e,l,n){let i;Bn=Kn,Yn=Gn,[Kn,Gn]=st.move(s,Kn,Gn),st.left=Kn,st.top=Gn,ct&&(Wn&&G(Wn,_e(Kn),0,Nt,zt),Hn&&G(Hn,0,_e(Gn),Nt,zt));let o=Rl>Bl;ci=Ne,fi=null;let r=0==ve.ori?Nt:zt,u=1==ve.ori?Nt:zt;if(Kn<0||0==jl||o){i=st.idx=null;for(let e=0;e<O.length;e++){let t=zl[e];null!=t&&G(t,-10,-10,Nt,zt)}Cl&&ui(null,hi,!0,null==e&&Oi.setSeries),it.live&&(et.fill(i),dl=!0)}else{let e,l,n;1==a&&(e=0==ve.ori?Kn:Gn,l=pi(e,ne),i=st.idx=le(l,t[0],Rl,Bl),n=De(t[0][i],ve,r,0));let o=-10,c=-10,f=0,d=0,h=!0,p="",m="";for(let g=2==a?1:0;g<O.length;g++){let e=O[g],v=et[g],b=null==v?null:1==a?t[g][v]:t[g][1][v],w=st.dataIdx(s,g,i,l),x=null==w?null:1==a?t[g][w]:t[g][1][w];if(dl=dl||x!=b||w!=v,et[g]=w,g>0&&e.show){let l=null==w?-10:w==i?n:De(1==a?t[0][w]:t[g][0][w],ve,r,0),v=null==x?-10:Ce(x,1==a?Z[e.scale]:Z[e.facets[1].scale],u,0);if(Cl&&null!=x){let t=1==ve.ori?Kn:Gn,l=xe(Dl.dist(s,g,w,v,t));if(l<ci){let n=Dl.bias;if(0!=n){let i=pi(t,e.scale),s=i>=0?1:-1;s==(x>=0?1:-1)&&(1==s?1==n?x>=i:x<=i:1==n?x<=i:x>=i)&&(ci=l,fi=g)}else ci=l,fi=g}}if(dl||El){let e,t;0==ve.ori?(e=l,t=v):(e=v,t=l);let n,i,a,r,u,b,w=!0,x=yl.bbox;if(null!=x){w=!1;let e=x(s,g);a=e.left,r=e.top,n=e.width,i=e.height}else a=e,r=t,n=i=yl.size(s,g);if(b=yl.fill(s,g),u=yl.stroke(s,g),El)g==fi&&ci<=Dl.prox&&(o=a,c=r,f=n,d=i,h=w,p=b,m=u);else{let e=zl[g];null!=e&&(Fl[g]=a,Pl[g]=r,J(e,n,i,w),X(e,b,u),G(e,ke(a),ke(r),Nt,zt))}}}}if(El){let e=Dl.prox;if(dl||(null==di?ci<=e:ci>e||fi!=di)){let e=zl[0];null!=e&&(Fl[0]=o,Pl[0]=c,J(e,f,d,h),X(e,p,m),G(e,ke(o),ke(c),Nt,zt))}}}if(si.show&&ti)if(null!=e){let[t,l]=Oi.scales,[n,i]=Oi.match,[s,a]=e.cursor.sync.scales,o=e.cursor.drag;if(ni=o._x,ii=o._y,ni||ii){let o,c,f,d,h,{left:p,top:m,width:g,height:v}=e.select,b=e.scales[s].ori,w=e.posToVal,x=null!=t&&n(t,s),y=null!=l&&i(l,a);x&&ni?(0==b?(o=p,c=g):(o=m,c=v),f=Z[t],d=De(w(o,s),f,r,0),h=De(w(o+c,s),f,r,0),vi(Me(d,h),xe(h-d))):vi(0,r),y&&ii?(1==b?(o=p,c=g):(o=m,c=v),f=Z[l],d=Ce(w(o,a),f,u,0),h=Ce(w(o+c,a),f,u,0),bi(Me(d,h),xe(h-d))):bi(0,u)}else Di()}else{let e=xe(Bn-On),t=xe(Yn-Vn);if(1==ve.ori){let l=e;e=t,t=l}ni=li.x&&e>=li.dist,ii=li.y&&t>=li.dist;let l,n,i=li.uni;null!=i?ni&&ii&&(ni=e>=i,ii=t>=i,ni||ii||(t>e?ii=!0:ni=!0)):li.x&&li.y&&(ni||ii)&&(ni=ii=!0),ni&&(0==ve.ori?(l=jn,n=Kn):(l=Rn,n=Gn),vi(Me(l,n),xe(n-l)),ii||bi(0,u)),ii&&(1==ve.ori?(l=jn,n=Kn):(l=Rn,n=Gn),bi(Me(l,n),xe(n-l)),ni||vi(0,r)),ni||ii||(vi(0,0),bi(0,0))}if(li._x=ni,li._y=ii,null==e){if(n){if(null!=Vi){let[e,t]=Oi.scales;Oi.values[0]=null!=e?pi(0==ve.ori?Kn:Gn,e):null,Oi.values[1]=null!=t?pi(1==ve.ori?Kn:Gn,t):null}Ri(A,s,Kn,Gn,Nt,zt,i)}if(Cl){let e=n&&Oi.setSeries,t=Dl.prox;null==di?ci<=t&&ui(fi,hi,!0,e):ci>t?ui(null,hi,!0,e):fi!=di&&ui(fi,hi,!0,e)}}dl&&(it.idx=i,wi()),!1!==l&&Wi("setCursor")}s.setLegend=wi;let _i=null;function ki(e=!1){e?_i=null:(_i=M.getBoundingClientRect(),Wi("syncRect",_i))}function Mi(e,t,l,n,i,s,a){st._lock||ti&&null!=e&&0==e.movementX&&0==e.movementY||(Si(e,t,l,n,i,s,a,!1,null!=e),null!=e?yi(null,!0,!0):yi(t,!0,!1))}function Si(e,t,l,n,i,a,o,r,c){if(null==_i&&ki(!1),xl(e),null!=e)l=e.clientX-_i.left,n=e.clientY-_i.top;else{if(l<0||n<0)return Kn=-10,void(Gn=-10);let[e,s]=Oi.scales,o=t.cursor.sync,[r,c]=o.values,[f,d]=o.scales,[h,p]=Oi.match,m=t.axes[0].side%2==1,g=0==ve.ori?Nt:zt,v=1==ve.ori?Nt:zt,b=m?a:i,w=m?i:a,x=m?n:l,y=m?l:n;if(l=null!=f?h(e,f)?u(r,Z[e],g,0):-10:g*(x/b),n=null!=d?p(s,d)?u(c,Z[s],v,0):-10:v*(y/w),1==ve.ori){let e=l;l=n,n=e}}!c||null!=t&&t.cursor.event.type!=A||((l<=1||l>=Nt-1)&&(l=Re(l,Nt)),(n<=1||n>=zt-1)&&(n=Re(n,zt))),r?(On=l,Vn=n,[jn,Rn]=st.move(s,l,n)):(Kn=l,Gn=n)}Object.defineProperty(s,"rect",{get:()=>(null==_i&&ki(!1),_i)});const Ai={width:0,height:0,left:0,top:0};function Di(){oi(Ai,!1)}let Ti,Ci,Ei,Ni;function zi(e,t,l,n,i,a,o){ti=!0,ni=ii=li._x=li._y=!1,Si(e,t,l,n,i,a,0,!0,!1),null!=e&&(Dt(T,I,Fi,!1),Ri(D,s,jn,Rn,Nt,zt,null));let{left:r,top:u,width:c,height:f}=si;Ti=r,Ci=u,Ei=c,Ni=f}function Fi(e,t,l,n,i,a,o){ti=li._x=li._y=!1,Si(e,t,l,n,i,a,0,!1,!0);let{left:r,top:u,width:c,height:f}=si,d=c>0||f>0,h=Ti!=r||Ci!=u||Ei!=c||Ni!=f;if(d&&h&&oi(si),li.setScale&&d&&h){let e=r,t=c,l=u,n=f;if(1==ve.ori&&(e=u,t=f,l=r,n=c),ni&&ri(ne,pi(e,ne),pi(e+t,ne)),ii)for(let i in Z){let e=Z[i];i!=ne&&null==e.from&&e.min!=Ne&&ri(i,pi(l+n,i),pi(l,i))}Di()}else st.lock&&(st._lock=!st._lock,yi(t,!0,null!=e));null!=e&&(Tt(T,I),Ri(T,s,Kn,Gn,Nt,zt,null))}function Pi(e,t,l,n,i,a,o){st._lock||(xl(e),xn(),Di(),null!=e&&Ri(N,s,Kn,Gn,Nt,zt,null))}function Li(){q.forEach(mn),hl(s.width,s.height,!0)}ee(F,$,Li);const Ii={};Ii.mousedown=zi,Ii.mousemove=Mi,Ii.mouseup=Fi,Ii.dblclick=Pi,Ii.setSeries=(e,t,l,n)=>{-1!=(l=(0,Oi.match[2])(s,t,l))&&ui(l,n,!0,!1)},ct&&(Dt(D,M,zi),Dt(A,M,Mi),Dt(C,M,e=>{xl(e),ki(!1)}),Dt(E,M,function(e,t,l,n,i,s,a){if(st._lock)return;xl(e);let o=ti;if(ti){let e,t,l=!0,n=!0,i=10;0==ve.ori?(e=ni,t=ii):(e=ii,t=ni),e&&t&&(l=Kn<=i||Kn>=Nt-i,n=Gn<=i||Gn>=zt-i),e&&l&&(Kn=Kn<jn?0:Nt),t&&n&&(Gn=Gn<Rn?0:zt),yi(null,!0,!0),ti=!1}Kn=-10,Gn=-10,et.fill(null),yi(null,!0,!0),o&&(ti=o)}),Dt(N,M,Pi),en.add(s),s.syncRect=ki);const $i=s.hooks=e.hooks||{};function Wi(e,t,l){Xn?qn.push([e,t,l]):e in $i&&$i[e].forEach(e=>{e.call(null,s,t,l)})}(e.plugins||[]).forEach(e=>{for(let t in e.hooks)$i[t]=($i[t]||[]).concat(e.hooks[t])});const Hi=(e,t,l)=>l,Oi=ot({key:null,setSeries:!1,filters:{pub:He,sub:He},scales:[ne,O[1]?O[1].scale:null],match:[Oe,Oe,Hi],values:[null,null]},st.sync);2==Oi.match.length&&Oi.match.push(Hi),st.sync=Oi;const Vi=Oi.key,ji=Tl(Vi);function Ri(e,t,l,n,i,s,a){Oi.filters.pub(e,t,l,n,i,s,a)&&ji.pub(e,t,l,n,i,s,a)}function Bi(){Wi("init",e,t),wn(t||e.data,!1),Ie[ne]?ei(ne,Ie[ne]):xn(),fl=si.show&&(si.width>0||si.height>0),il=dl=!0,hl(e.width,e.height)}return ji.sub(s),s.pub=function(e,t,l,n,i,s,a){Oi.filters.sub(e,t,l,n,i,s,a)&&Ii[e](null,t,l,n,i,s,a)},s.destroy=function(){ji.unsub(s),en.delete(s),At.clear(),te(F,$,Li),f.remove(),null==dt||dt.remove(),Wi("destroy")},O.forEach($l),q.forEach(function(e,t){if(e._show=e.show,e.show){let l=e.side%2,n=Z[e.scale];null==n&&(e.scale=l?O[1].scale:ne,n=Z[e.scale]);let i=n.time;e.size=Le(e.size),e.space=Le(e.space),e.rotate=Le(e.rotate),Qe(e.incrs)&&e.incrs.forEach(e=>{!Ge.has(e)&&Ge.set(e,Ue(e))}),e.incrs=Le(e.incrs||(2==n.distr?Mt:i?1==W?$t:Ot:St)),e.splits=Le(e.splits||(i&&1==n.distr?Be:3==n.distr?ul:4==n.distr?cl:rl)),e.stroke=Le(e.stroke),e.grid.stroke=Le(e.grid.stroke),e.ticks.stroke=Le(e.ticks.stroke),e.border.stroke=Le(e.border.stroke);let a=e.values;e.values=Qe(a)&&!Qe(a[0])?Le(a):i?Qe(a)?Bt(Ve,Rt(a,je)):tt(a)?function(e,t){let l=bt(t);return(t,n,i,s,a)=>n.map(t=>l(e(t)))}(Ve,a):a||Ye:a||ol,e.filter=Le(e.filter||(n.distr>=3&&10==n.log?gl:3==n.distr&&2==n.log?vl:$e)),e.font=pn(e.font),e.labelFont=pn(e.labelFont),e._size=e.size(s,null,t,0),e._space=e._rotate=e._incrs=e._found=e._splits=e._values=null,e._size>0&&(Wl[t]=!0,e._el=Y("u-axis",p))}}),l?l instanceof HTMLElement?(l.appendChild(f),Bi()):l(s,Bi):Bi(),s}gn.assign=ot,gn.fmtNum=ve,gn.rangeNum=he,gn.rangeLog=re,gn.rangeAsinh=ue,gn.orient=Cl,gn.pxRatio=H,gn.join=function(e,t){if(function(e){let t=e[0][0],l=t.length;for(let n=1;n<e.length;n++){let i=e[n][0];if(i.length!=l)return!1;if(i!=t)for(let e=0;e<l;e++)if(i[e]!=t[e])return!1}return!0}(e)){let t=e[0].slice();for(let l=1;l<e.length;l++)t.push(...e[l].slice(1));return function(e,t=100){const l=e.length;if(l<=1)return!0;let n=0,i=l-1;for(;n<=i&&null==e[n];)n++;for(;i>=n&&null==e[i];)i--;if(i<=n)return!0;const s=Se(1,ye((i-n+1)/t));for(let a=e[n],o=n+s;o<=i;o+=s){const t=e[o];if(null!=t){if(t<=a)return!1;a=t}}return!0}(t[0])||(t=function(e){let t=e[0],l=t.length,n=Array(l);for(let s=0;s<n.length;s++)n[s]=s;n.sort((e,l)=>t[e]-t[l]);let i=[];for(let s=0;s<e.length;s++){let t=e[s],a=Array(l);for(let e=0;e<l;e++)a[e]=t[n[e]];i.push(a)}return i}(t)),t}let l=new Set;for(let a=0;a<e.length;a++){let t=e[a][0],n=t.length;for(let e=0;e<n;e++)l.add(t[e])}let n=[Array.from(l).sort((e,t)=>e-t)],i=n[0].length,s=new Map;for(let a=0;a<i;a++)s.set(n[0][a],a);for(let a=0;a<e.length;a++){let l=e[a],o=l[0];for(let e=1;e<l.length;e++){let r=l[e],u=Array(i).fill(void 0),c=t?t[a][e]:1,f=[];for(let e=0;e<r.length;e++){let t=r[e],l=s.get(o[e]);null===t?0!=c&&(u[l]=t,2==c&&f.push(l)):u[l]=t}rt(u,f,i),n.push(u)}}return n},gn.fmtDate=bt,gn.tzDate=function(e,t){let l;return"UTC"==t||"Etc/UTC"==t?l=new Date(+e+6e4*e.getTimezoneOffset()):t==wt?l=e:(l=new Date(e.toLocaleString("en-US",{timeZone:t})),l.setMilliseconds(e.getMilliseconds())),l},gn.sync=Tl;{gn.addGap=function(e,t,l){let n=e[e.length-1];n&&n[0]==t?n[1]=l:e.push([t,l])},gn.clipGaps=Fl;let e=gn.paths={points:Gl};e.linear=Jl,e.stepped=function(e){const t=pe(e.align,1),l=pe(e.ascDesc,!1),n=pe(e.alignGaps,0),i=pe(e.extend,!1);return(e,s,a,o)=>Cl(e,s,(r,u,c,f,d,h,p,m,g,v,b)=>{[a,o]=ae(c,a,o);let w=r.pxRound,{left:x,width:y}=e.bbox,_=e=>w(h(e,f,v,m)),k=e=>w(p(e,d,b,g)),M=0==f.ori?Hl:Ol;const S={stroke:new Path2D,fill:null,clip:null,band:null,gaps:null,flags:1},A=S.stroke,D=f.dir*(0==f.ori?1:-1);let T=k(c[1==D?a:o]),C=_(u[1==D?a:o]),E=C,N=C;i&&-1==t&&(N=x,M(A,N,T)),M(A,C,T);for(let e=1==D?a:o;e>=a&&e<=o;e+=D){let l=c[e];if(null==l)continue;let n=_(u[e]),i=k(l);1==t?M(A,n,T):M(A,E,i),M(A,n,i),T=i,E=n}let z=E;i&&1==t&&(z=x+y,M(A,z,T));let[F,P]=El(e,s);if(null!=r.fill||0!=F){let t=S.fill=new Path2D(A),l=k(r.fillTo(e,s,r.min,r.max,F));M(t,z,l),M(t,N,l)}if(!r.spanGaps){let i=[];i.push(...Pl(u,c,a,o,D,_,n));let d=r.width*H/2,h=l||1==t?d:-d,p=l||-1==t?-d:d;i.forEach(e=>{e[0]+=h,e[1]+=p}),S.gaps=i=r.gaps(e,s,a,o,i),S.clip=Fl(i,f.ori,m,g,v,b)}return 0!=P&&(S.band=2==P?[zl(e,s,a,o,A,-1),zl(e,s,a,o,A,1)]:zl(e,s,a,o,A,P)),S})},e.bars=function(e){const t=pe((e=e||qe).size,[.6,Ne,1]),l=e.align||0,n=e.gap||0;let i=e.radius;i=null==i?[0,0]:"number"==typeof i?[i,0]:i;const s=Le(i),a=1-t[0],o=pe(t[1],Ne),r=pe(t[2],1),u=pe(e.disp,qe),c=pe(e.each,e=>{}),{fill:f,stroke:d}=u;return(e,t,i,h)=>Cl(e,t,(p,m,g,v,b,w,x,y,_,k,M)=>{var S,A;let D,T,C=p.pxRound,E=l,N=n*H,z=o*H,F=r*H;0==v.ori?[D,T]=s(e,t):[T,D]=s(e,t);const P=v.dir*(0==v.ori?1:-1);let L,I,$,W=0==v.ori?Vl:jl,O=0==v.ori?c:(e,t,l,n,i,s,a)=>{c(e,t,l,i,n,a,s)},V=pe(e.bands,Je).find(e=>e.series[0]==t),j=null!=V?V.dir:0,R=p.fillTo(e,t,p.min,p.max,j),B=C(x(R,b,M,_)),Y=k,K=C(p.width*H),G=!1,U=null,X=null,q=null,J=null;null==f||0!=K&&null==d||(G=!0,U=f.values(e,t,i,h),X=new Map,new Set(U).forEach(e=>{null!=e&&X.set(e,new Path2D)}),K>0&&(q=d.values(e,t,i,h),J=new Map,new Set(q).forEach(e=>{null!=e&&J.set(e,new Path2D)})));let{x0:Z,size:Q}=u;if(null!=Z&&null!=Q){E=1,m=Z.values(e,t,i,h),2==Z.unit&&(m=m.map(t=>e.posToVal(y+t*k,v.key,!0)));let l=Q.values(e,t,i,h);I=2==Q.unit?l[0]*k:w(l[0],v,k,y)-w(0,v,k,y),Y=Zl(m,g,w,v,k,y,Y),$=Y-I+N}else Y=Zl(m,g,w,v,k,y,Y),$=Y*a+N,I=Y-$;$<1&&($=0),K>=I/2&&(K=0),$<5&&(C=Ie);let ee=$>0;I=C(Fe(Y-$-(ee?K:0),F,z)),L=(0==E?I/2:E==P?0:I)-E*P*((0==E?N/2:0)+(ee?K/2:0));const te={stroke:null,fill:null,clip:null,band:null,gaps:null,flags:0},le=G?null:new Path2D;let ne=null;if(null!=V)ne=e.data[V.series[1]];else{let{y0:l,y1:n}=u;null!=l&&null!=n&&(g=n.values(e,t,i,h),ne=l.values(e,t,i,h))}let ie=D*I,se=T*I;for(let l=1==P?i:h;l>=i&&l<=h;l+=P){let n=g[l];if(null==n)continue;if(null!=ne){let e=null!=(S=ne[l])?S:0;if(n-e==0)continue;B=x(e,b,M,_)}let i=w(2!=v.distr||null!=u?m[l]:l,v,k,y),s=x(pe(n,R),b,M,_),a=C(i-L),o=C(Se(s,B)),r=C(Me(s,B)),c=o-r;if(null!=n){let i=n<0?se:ie,s=n<0?ie:se;G?(K>0&&null!=q[l]&&W(J.get(q[l]),a,r+ye(K/2),I,Se(0,c-K),i,s),null!=U[l]&&W(X.get(U[l]),a,r+ye(K/2),I,Se(0,c-K),i,s)):W(le,a,r+ye(K/2),I,Se(0,c-K),i,s),O(e,t,l,a-K/2,r,I+K,c)}}return K>0?te.stroke=G?J:le:G||(te._fill=0==p.width?p._fill:null!=(A=p._stroke)?A:p._fill,te.width=0),te.fill=G?X:le,te})},e.spline=function(e){return function(e,t){const l=pe(null==t?void 0:t.alignGaps,0);return(t,n,i,s)=>Cl(t,n,(a,o,r,u,c,f,d,h,p,m,g)=>{[i,s]=ae(r,i,s);let v,b,w,x=a.pxRound,y=e=>x(f(e,u,m,h)),_=e=>x(d(e,c,g,p));0==u.ori?(v=$l,w=Hl,b=Yl):(v=Wl,w=Ol,b=Kl);const k=u.dir*(0==u.ori?1:-1);let M=y(o[1==k?i:s]),S=M,A=[],D=[];for(let e=1==k?i:s;e>=i&&e<=s;e+=k)if(null!=r[e]){let t=y(o[e]);A.push(S=t),D.push(_(r[e]))}const T={stroke:e(A,D,v,w,b,x),fill:null,clip:null,band:null,gaps:null,flags:1},C=T.stroke;let[E,N]=El(t,n);if(null!=a.fill||0!=E){let e=T.fill=new Path2D(C),l=_(a.fillTo(t,n,a.min,a.max,E));w(e,S,l),w(e,M,l)}if(!a.spanGaps){let e=[];e.push(...Pl(o,r,i,s,k,y,l)),T.gaps=e=a.gaps(t,n,i,s,e),T.clip=Fl(e,u.ori,h,p,m,g)}return 0!=N&&(T.band=2==N?[zl(t,n,i,s,C,-1),zl(t,n,i,s,C,1)]:zl(t,n,i,s,C,N)),T})}(Ql,e)}}function vn(e){if(!e)return null;if(e instanceof Date)return Number.isNaN(e.getTime())?null:e;if("string"==typeof e){const t=new Date(e);return Number.isNaN(t.getTime())?null:t}if("number"==typeof e&&Number.isFinite(e)){const t=new Date(e);return Number.isNaN(t.getTime())?null:t}return null}function bn(e,t,l=1){const n=[String(t),String(Number(t))];for(const i of n)if(e.has(i))return e.get(i);return l}function wn(e,t,l=0){const n=[String(t),String(Number(t))];for(const i of n)if(e.has(i))return e.get(i);return l}function xn(e){console.warn("[chart-utils] buildCellValueMap() is deprecated. Use StateManager.getAllCellsForMode() instead.");const t=new Map,l=(e,l)=>{const n=parseFloat(l);t.set(String(e),Number.isFinite(n)?n:0)};return e.assignmentMap instanceof Map?e.assignmentMap.forEach((e,t)=>l(t,e)):e.assignmentMap&&"object"==typeof e.assignmentMap&&Object.entries(e.assignmentMap).forEach(([e,t])=>l(e,t)),e.modifiedCells instanceof Map?e.modifiedCells.forEach((e,t)=>l(t,e)):e.modifiedCells&&"object"==typeof e.modifiedCells&&Object.entries(e.modifiedCells).forEach(([e,t])=>l(e,t)),t}function yn(e,t){const l=new Set;return Array.isArray(e.flatPekerjaan)&&e.flatPekerjaan.forEach(e=>{!e||"pekerjaan"!==e.type&&void 0!==e.type||l.add(String(e.id))}),t.forEach((e,t)=>{const[n]=String(t).split("-");n&&l.add(n)}),l}function _n(e,t=1){if(!Number.isFinite(e))return"0%";return`${0===t?Math.round(e):parseFloat(e.toFixed(t))}%`}function kn(e){if(!Number.isFinite(e))return"Rp 0";return`Rp ${Math.round(e).toLocaleString("id-ID")}`}function Mn(e){if(!e||!Array.isArray(e.labels)||0===e.labels.length)return e;const t=String(e.labels[0]||"").toLowerCase();if(t.includes("week 0")||"w0"===t)return e;const l="cost"===e.viewMode?"W0":"Week 0",n=Array.isArray(e.planned)?e.planned:[],i=Array.isArray(e.actual)?e.actual:[],s=u(r({},e),{labels:[l,...e.labels],planned:[0,...n],actual:[0,...i]});return Array.isArray(e.acSeries)&&(s.acSeries=[0,...e.acSeries]),s.details=function(e,t,l){if(Array.isArray(e))return[{label:t,planned:0,actual:0,variance:0,start:null,end:null,tooltip:t},...e];if(l&&e&&"object"==typeof e){const t={week_number:0,week_start:null,week_end:null,cost:0,cumulative_cost:0,cumulative_percent:0,pekerjaan_breakdown:{}};return u(r({},e),{weeks:Array.isArray(e.weeks)?[t,...e.weeks]:e.weeks,actualWeeks:Array.isArray(e.actualWeeks)?[t,...e.actualWeeks]:e.actualWeeks})}return e}(e.details,l,"cost"===e.viewMode),s}const Sn="[KurvaSDataset]";function An(e){const t=function(e){return Array.isArray(e)?e.slice().sort((e,t)=>{const l=vn(e.startDate),n=vn(t.startDate);return l&&n?l.getTime()-n.getTime():(e.index||0)-(t.index||0)}):[]}(null==e?void 0:e.timeColumns);if(!t||0===t.length)return console.warn(Sn,"No time columns available"),null;const l=function(e){const t=new Map,l=(e,l)=>{const n=Number(e),i=Number.isFinite(l)&&l>0?l:null;null!==i&&(t.set(String(e),i),Number.isNaN(n)||t.set(String(n),i))};return e.volumeMap instanceof Map?e.volumeMap.forEach((e,t)=>{const n=parseFloat(e);l(t,n)}):e.volumeMap&&"object"==typeof e.volumeMap&&Object.entries(e.volumeMap).forEach(([e,t])=>{const n=parseFloat(t);l(e,n)}),t}(e),n=function(e){const t=new Map,l=(e,l)=>{const n=Number(e),i=Number.isFinite(l)&&l>=0?l:null;null!==i&&(t.set(String(e),i),Number.isNaN(n)||t.set(String(n),i))};return e.hargaMap instanceof Map?e.hargaMap.forEach((e,t)=>{const n=parseFloat(e);l(t,n)}):e.hargaMap&&"object"==typeof e.hargaMap&&Object.entries(e.hargaMap).forEach(([e,t])=>{const n=parseFloat(t);l(e,n)}),t}(e),i=null==e?void 0:e.stateManager;let s,a;if(i)s=i.getAllCellsForMode("planned")||new Map,a=i.getAllCellsForMode("actual")||new Map;else{const t=(null==e?void 0:e.plannedState)||e,l=(null==e?void 0:e.actualState)||e;s=xn(t),a=xn(l)}s&&s instanceof Map||(s=new Map),a&&a instanceof Map||(a=new Map);const o=new Set([...yn(e,s),...yn(e,a)]);let r=parseFloat((null==e?void 0:e.totalBiayaProject)||0);(!r||r<=0)&&o.forEach(e=>{r+=wn(n,e,0)});const u=r>0&&n.size>0;let c=0;u||(o.forEach(e=>{c+=bn(l,e,1)}),(!Number.isFinite(c)||c<=0)&&(c=o.size||1));const f=new Map;t.forEach((e,t)=>{f.set(String(e.id),t)});const d=function(e){return e.map((e,t)=>{const l=(null==e?void 0:e.label)||(null==e?void 0:e.displayLabel)||(null==e?void 0:e.display_name)||(null==e?void 0:e.name)||`Week ${t+1}`;return(null==e?void 0:e.start_date)&&(null==e?void 0:e.end_date)?`${l} (${e.start_date} - ${e.end_date})`:l})}(t),h=function(e,t,l,n,i,s,a){const o=Array(e.length).fill(0);n.forEach((e,n)=>{const[i,r]=n.split("-");if(!s.has(r))return;const u=s.get(r);if(void 0===u)return;const c=Number(e)||0;if(a){const e=wn(l,i,0)*c/100;o[u]+=e}else{const e=bn(t,i,1)*c/100;o[u]+=e}});let r=0;return o.map(e=>(r+=e,!Number.isFinite(i)||i<=0?0:Number((r/i*100).toFixed(2))))}(t,l,n,s,u?r:c,f,u),p=function(e,t,l,n,i,s){const a=Array(e.length).fill(0);return t.forEach((e,t)=>{const[o,r]=t.split("-"),u=i.get(r);if(void 0===u)return;const c=Number(e)||0;if(s){const e=wn(n,o,0)*c/100;a[u]+=e}else{const e=bn(l,o,1)*c/100;a[u]+=e}}),a}(t,a,l,n,f,u),m=function(e,t,l){let n=0;return e.map((e,i)=>(n+=t[i]||0,!Number.isFinite(l)||l<=0?0:Number((n/l*100).toFixed(2))))}(t,p,u?r:c),g=function(e,t,l,n,i=0,s=!1){return e.map((e,a)=>{const o=t[a]||`Week ${a+1}`,r=l[a]||0,u=n[a]||0,c=Number((u-r).toFixed(2));let f=null,d=null,h=null;return s&&(f=Number((r/100*(i||0)).toFixed(2)),d=Number((u/100*(i||0)).toFixed(2)),h=Number((d-f).toFixed(2))),{label:o,planned:r,actual:u,variance:c,start:vn((null==e?void 0:e.startDate)||(null==e?void 0:e.start_date)||(null==e?void 0:e.start)),end:vn((null==e?void 0:e.endDate)||(null==e?void 0:e.end_date)||(null==e?void 0:e.end)),metadata:e,plannedCostValue:f,actualCostValue:d,varianceCostValue:h}})}(t,d,h,m,u?r:c,u);return Mn({labels:d,planned:h,actual:m,details:g,totalVolume:c,totalBiaya:r,columnTotals:p,useHargaCalculation:u,viewMode:"progress"})}function Dn(e=[],t=[],l=0,n=[]){var i,s,a,o,r,u,c,f,d,h;const p=Math.max(e.length,t.length,n.length),m=[];for(let g=0;g<p;g+=1){const p=e[g]||{},v=t[g]||{},b=n[g]||p.label||v.label||`W${p.week_number||v.week_number||g+1}`,w=Number(null!=(o=null!=(a=null!=(s=null!=(i=p.cumulative_percent)?i:p.percent)?s:p.value)?a:p.cumulative)?o:0),x=Number(null!=(f=null!=(c=null!=(u=null!=(r=v.cumulative_percent)?r:v.percent)?u:v.value)?c:v.cumulative)?f:0),y=Tn(p,w,l),_=Tn(v,x,l),k=Number((x-w).toFixed(2)),M=Number((_-y).toFixed(2));m.push({label:b,weekNumber:null!=(h=null!=(d=p.week_number)?d:v.week_number)?h:g+1,plannedPercent:Number.isFinite(w)?w:0,actualPercent:Number.isFinite(x)?x:0,plannedCostValue:y,actualCostValue:_,variancePercent:k,varianceCostValue:M,range:{start:vn(p.week_start||p.start_date||v.week_start||v.start_date),end:vn(p.week_end||p.end_date||v.week_end||v.end_date)}})}return m}function Tn(e,t,l){var n,i,s,a,o,r;const u=Number(null!=(s=null!=(i=null!=(n=null!=t?t:null==e?void 0:e.cumulative_percent)?n:null==e?void 0:e.percent)?i:null==e?void 0:e.value)?s:0),c=Cn(null!=(r=null!=(o=null!=(a=null==e?void 0:e.cumulative_cost)?a:null==e?void 0:e.cumulative)?o:null==e?void 0:e.accumulated_cost)?r:null==e?void 0:e.acc_cost);if(Number.isFinite(c)&&c>0)return c;const f=Cn(null==e?void 0:e.cost);return Number.isFinite(f)&&f>0&&!(null==e?void 0:e.cumulative_cost)?f:!Number.isFinite(l)||l<=0?0:Number(((u||0)/100*l).toFixed(2))}function Cn(e){if("number"==typeof e)return e;if("string"==typeof e){const t=Number(e);return Number.isFinite(t)?t:NaN}return NaN}const En="[KurvaSUPlot]",Nn={height:520,enableCostView:!0};class zn{constructor(e,t={}){this.state=e,this.options=r(r({},Nn),t),this.viewMode="progress",this.chartInstance=null,this.container=null,this.tooltipEl=null,this.resizeHandler=null,this.resizeObserver=null,this.themeObserver=null,this.currentDataset=null,this.costData=null,this.isLoadingCostData=!1,this._interactionAttached=!1,this._wheelHandler=null,this._interactionTarget=null,this._scaleBounds=null,this._dateFormatter=null}initialize(e){if(!e)return console.error(En,"Container element is required"),!1;this.container=e,"static"===getComputedStyle(e).position&&(this.container.style.position="relative"),this._createTooltip(),this.themeObserver=function(e){const t=new MutationObserver(t=>{t.forEach(t=>{if("attributes"===t.type&&"data-bs-theme"===t.attributeName){const t=document.documentElement.getAttribute("data-bs-theme");console.log("[ChartUtils] Theme changed to:",t),e(t)}})});return t.observe(document.documentElement,{attributes:!0,attributeFilter:["data-bs-theme"]}),t}(()=>this._rebuild()),this.resizeHandler=function(e,t=150){let l=null;return function(){l&&clearTimeout(l),l=setTimeout(()=>{e(),l=null},t)}}(()=>this.resize()),window.addEventListener("resize",this.resizeHandler),this.resizeObserver=function(e,t){if(!e||"undefined"==typeof ResizeObserver)return null;const l=new ResizeObserver(l=>{for(const n of l)n.target===e&&t(n.contentRect)});return l.observe(e),l}(e,()=>this.resize());return this.update()||console.warn(En,"Unable to render Kurva-S chart (no dataset)"),!0}update(e){const t=e||An(this.state);if(!t)return!1;this.currentDataset=t,this.viewMode=t.viewMode||this.viewMode||"progress";const l=this._transformDataset(t),n="dark"===(document.documentElement.getAttribute("data-bs-theme")||"light")?{text:"#f8fafc",axis:"#cbd5e1",plannedLine:"#60a5fa",plannedArea:"rgba(96, 165, 250, 0.15)",actualLine:"#34d399",actualArea:"rgba(52, 211, 153, 0.18)",costActualLine:"#f87171",costActualArea:"rgba(248, 113, 113, 0.18)",gridLine:"#334155",background:"#1e293b"}:{text:"#1f2937",axis:"#374151",plannedLine:"#0d6efd",plannedArea:"rgba(13, 110, 253, 0.12)",actualLine:"#198754",actualArea:"rgba(25, 135, 84, 0.12)",costActualLine:"#dc3545",costActualArea:"rgba(220, 53, 69, 0.12)",gridLine:"#e5e7eb",background:"#ffffff"};if(this.chartInstance)this.chartInstance.setData(l),this._updateScaleBounds();else{const e=this._buildChartOptions(t,n);this.chartInstance=new gn(e,l,this.container),this._updateScaleBounds(),this._attachInteractions()}return this._updateTooltipPosition(),!0}resize(){this.chartInstance&&this.container&&this.chartInstance.setSize({width:this.container.clientWidth||800,height:this.options.height})}toggleView(e){return c(this,null,function*(){const t=(e||("progress"===this.viewMode?"cost":"progress")).toLowerCase();if(t===this.viewMode)return!0;if("cost"===t){if(!this.options.enableCostView)return console.warn(En,"Cost view disabled on uPlot chart"),!1;if(!this.costData){if(!(yield this.fetchCostData()))return!1}const e=function(e){var t;if(!e)return console.error(Sn,"No cost data available"),null;const l=e.weeklyData||{},n=e.summary||{},i=e.evm;if(i&&Array.isArray(i.labels)&&i.labels.length>0){const e=(null==(t=i.summary)?void 0:t.bac)||(null==n?void 0:n.total_project_cost)||0,s=Dn((null==l?void 0:l.planned)||[],(null==l?void 0:l.actual)||[],e,i.labels),a=i.pv_percent||[],o=i.ev_percent||[],r=i.ac_percent||o,u=a.map((e,t)=>Number(((r[t]||o[t]||0)-(e||0)).toFixed(2))),c=s.map(e=>e.varianceCostValue||0);return Mn({labels:i.labels,planned:a,actual:o,acSeries:r,varianceSeries:u,varianceCostSeries:c,details:{totalCost:e,weeks:(null==l?void 0:l.planned)||[],actualWeeks:(null==l?void 0:l.actual)||[],weeklySummary:s,evmSummary:i.summary,evm:i},evm:i,totalBiaya:e,useHargaCalculation:!0,viewMode:"cost"})}const s=(l.planned||[]).map(e=>`W${e.week_number}`),a=(l.planned||[]).map(e=>e.cumulative_percent),o=(l.actual||[]).map(e=>e.cumulative_percent),c=o.length?o:(l.earned||[]).map(e=>e.cumulative_percent),f=a.map((e,t)=>Number(((c[t]||o[t]||0)-(e||0)).toFixed(2))),d={totalCost:(null==n?void 0:n.total_project_cost)||0,plannedCost:(null==n?void 0:n.planned_cost)||0,actualCost:(null==n?void 0:n.actual_cost)||0,weeks:l.planned||[],actualWeeks:l.actual||[],viewMode:"cost"},h=Dn(l.planned||[],l.actual||[],d.totalCost,s);return console.log(Sn,"Cost dataset built:",{labels:s.length,plannedPoints:a.length,actualPoints:o.length,totalCost:kn(d.totalCost)}),Mn({labels:s,planned:a,actual:o,acSeries:c,varianceSeries:f,varianceCostSeries:h.map(e=>e.varianceCostValue||0),details:u(r({},d),{weeklySummary:h}),totalBiaya:d.totalCost,useHargaCalculation:!0,viewMode:"cost"})}(this.costData);return e?(this.viewMode="cost",this.update(e),!0):(console.warn(En,"Cost dataset not available"),!1)}return this.viewMode="progress",this.update(),!0})}dispose(){this._detachInteractions(),this.chartInstance&&(this.chartInstance.destroy(),this.chartInstance=null),this.resizeHandler&&(window.removeEventListener("resize",this.resizeHandler),this.resizeHandler=null),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),this.themeObserver&&(this.themeObserver.disconnect(),this.themeObserver=null),this.tooltipEl&&(this.tooltipEl.remove(),this.tooltipEl=null)}_rebuild(){this.container&&(this.chartInstance&&(this.chartInstance.destroy(),this.chartInstance=null),this.update(this.currentDataset))}fetchCostData(){return c(this,null,function*(){var e;if(!this.options.enableCostView)return console.log(En,"Cost view disabled"),null;const t=null==(e=this.state)?void 0:e.projectId;if(!t)return console.warn(En,"Cannot load cost data without project ID"),null;if(this.isLoadingCostData)return null;try{this.isLoadingCostData=!0;const e=`/detail_project/api/v2/project/${t}/kurva-s-harga/`,l=yield fetch(e,{method:"GET",headers:{"Content-Type":"application/json"}});if(!l.ok)throw new Error(`HTTP ${l.status}: ${l.statusText}`);const n=yield l.json();if(null==n?void 0:n.error)throw new Error(n.error);return this.costData=n,console.log(En,"Cost data loaded for uPlot chart"),n}catch(l){return console.error(En,"Failed to load cost data:",l),null}finally{this.isLoadingCostData=!1}})}_transformDataset(e){const t=e.labels.map((e,t)=>t),l=e.planned.map(e=>Number(e)||0);if("cost"===e.viewMode&&Array.isArray(e.acSeries)){return[t,l,e.acSeries.map(e=>Number(e)||0)]}return[t,l,e.actual.map(e=>Number(e)||0)]}_buildChartOptions(e,t){var l;const n="cost"===e.viewMode&&Array.isArray(e.acSeries);return{width:(null==(l=this.container)?void 0:l.clientWidth)||800,height:this.options.height,scales:{x:{time:!1},y:{auto:!0}},axes:[{stroke:t.axis,grid:{stroke:t.gridLine},values:(t,l)=>l.map(t=>{if(!Number.isFinite(t))return"";const l=Math.round(t);return Math.abs(t-l)>.01||l<0||l>=e.labels.length?"":e.labels[l]||`Week ${l+1}`})},{stroke:t.axis,grid:{stroke:t.gridLine},label:n?"% of Total Cost":"Progress %",values:(e,t)=>t.map(e=>`${Math.round(e)}%`)}],legend:{show:!0},series:[{},{label:n?"Rencana (PV)":"Rencana",stroke:t.plannedLine,width:2,fill:t.plannedArea},n?{label:"Realisasi (AC)",stroke:t.costActualLine||t.actualLine,width:3,fill:t.costActualArea||t.actualArea}:{label:"Realisasi",stroke:t.actualLine,width:2,fill:t.actualArea}],cursor:{drag:{x:!0,y:!1},focus:{prox:32}},select:{show:!0},hooks:{ready:[()=>{this._updateScaleBounds(),this._attachInteractions()}],setCursor:[e=>this._updateTooltip(e)],setScale:[()=>this._updateTooltipPosition()],dblclick:[e=>{const t=e.data[0][0],l=e.data[0][e.data[0].length-1];e.setScale("x",{min:t,max:l})}]}}}_attachInteractions(){if(this._interactionAttached||!this.chartInstance)return;const e=this.chartInstance.over||this.container;e&&(this._interactionTarget=e,this._wheelHandler=e=>this._handleWheelInteraction(e),e.addEventListener("wheel",this._wheelHandler,{passive:!1}),this._interactionAttached=!0)}_detachInteractions(){this._interactionAttached&&this._interactionTarget&&this._wheelHandler&&this._interactionTarget.removeEventListener("wheel",this._wheelHandler),this._interactionAttached=!1,this._wheelHandler=null,this._interactionTarget=null}_handleWheelInteraction(e){var t;if(!this.chartInstance||!this._scaleBounds)return;const l=e.ctrlKey||e.metaKey,n=!l&&e.shiftKey;if(!l&&!n)return;e.preventDefault();const i=this._scaleBounds,s=(null==(t=this.chartInstance.scales)?void 0:t.x)||{},a=Number.isFinite(s.min)?s.min:i.min,o=Number.isFinite(s.max)?s.max:i.max;if(l){const t=.12,l=e.deltaY>0?1:-1,n=Math.max(.2,1+t*l),i=(this.chartInstance.over||this.container).getBoundingClientRect(),s=e.clientX-i.left,r=this.chartInstance.posToVal(s,"x"),u=Number.isFinite(r)?r:(a+o)/2,c=u-(u-a)*n,f=u+(o-u)*n;return void this._setScaleBounded(c,f)}const r=o-a,u=Math.max(1,.15*r),c=e.deltaY>0?u:-u;this._setScaleBounded(a+c,o+c)}_setScaleBounded(e,t){if(!this.chartInstance||!this._scaleBounds)return;const l=this._scaleBounds,n=l.max-l.min;if(n<=0)return;let i=Math.min(e,t),s=Math.max(e,t),a=Math.max(1,s-i);a>n&&(a=n),i=Math.max(l.min,Math.min(i,l.max-a)),s=i+a,s>l.max&&(s=l.max,i=s-a),this.chartInstance.setScale("x",{min:i,max:s})}_updateScaleBounds(){var e;if(!this.chartInstance||!Array.isArray(null==(e=this.chartInstance.data)?void 0:e[0]))return;const t=this.chartInstance.data[0];t.length&&(this._scaleBounds={min:t[0],max:t[t.length-1]})}_createTooltip(){const e=document.createElement("div");e.className="kurva-s-tooltip",e.style.position="absolute",e.style.pointerEvents="none",e.style.padding="8px 10px",e.style.borderRadius="6px",e.style.background="rgba(15, 23, 42, 0.85)",e.style.color="#fff",e.style.fontSize="12px",e.style.transform="translate(-50%, -100%)",e.style.opacity="0",e.style.transition="opacity 0.15s ease",this.tooltipEl=e,this.container.appendChild(e)}_updateTooltip(e){var t,l,n,i,s,a,o;if(!this.tooltipEl||!this.currentDataset)return;const r=e.cursor.idx;if(null==r||r<0||r>=this.currentDataset.labels.length)return void(this.tooltipEl.style.opacity="0");const u=(this.currentDataset.labels||[])[r]||`Week ${r+1}`,c=null!=(t=this.currentDataset.planned[r])?t:0,f=Array.isArray(this.currentDataset.details)?this.currentDataset.details:null,d=!f&&this.currentDataset.details?this.currentDataset.details:{},h=Number(d.totalCost||this.currentDataset.totalBiaya||0)||0,p=Array.isArray(d.weeklySummary)?d.weeklySummary:null,m=p?p[r]:null,g=[`<div style="font-weight:600;margin-bottom:4px;">${u}</div>`];if("cost"===(this.viewMode||this.currentDataset.viewMode)){const e=null!=(l=(Array.isArray(this.currentDataset.acSeries)?this.currentDataset.acSeries:this.currentDataset.actual||[])[r])?l:0,t=null!=(n=null==m?void 0:m.variancePercent)?n:Number((e-c).toFixed(2)),i=Array.isArray(d.weeks)?d.weeks[r]:null,s=Array.isArray(d.actualWeeks)?d.actualWeeks[r]:null,a=this._formatWeekRange(i,s),o="number"==typeof(null==m?void 0:m.plannedCostValue)?kn(m.plannedCostValue):this._resolveCostAmount(i,c,h),u="number"==typeof(null==m?void 0:m.actualCostValue)?kn(m.actualCostValue):this._resolveCostAmount(s,e,h),f="number"==typeof(null==m?void 0:m.varianceCostValue)?kn(m.varianceCostValue):"",p=this._getVarianceColor(t);a&&g.push(`<div style="font-size:0.85em;color:#cbd5e1;margin-bottom:4px;">Periode: ${a}</div>`),g.push(`<div>Rencana (PV): <strong>${_n(c)}</strong> <span style="color:#cbd5e1;font-size:0.85em;">(${o})</span></div>`,`<div>Realisasi (AC): <strong>${_n(e)}</strong> <span style="color:#cbd5e1;font-size:0.85em;">(${u})</span></div>`,`<div>Variance: <strong style="color:${p};">${t>=0?"+":""}${t.toFixed(1)}%</strong>${f?` <span style="color:${p};font-size:0.85em;">(${f})</span>`:""}</div>`)}else{const e=null!=(i=this.currentDataset.actual[r])?i:0,t=Number((e-c).toFixed(2)),l=f?f[r]:null,n=(null==l?void 0:l.start)?this._formatDateLabel(l.start):"",s=(null==l?void 0:l.end)?this._formatDateLabel(l.end):"",a=this._composeRangeText(n,s),o=Boolean(this.currentDataset.useHargaCalculation&&h>0),u="number"==typeof(null==l?void 0:l.plannedCostValue)?l.plannedCostValue:h*c/100,d="number"==typeof(null==l?void 0:l.actualCostValue)?l.actualCostValue:h*e/100,p=o?kn(u||0):"",m=o?kn(d||0):"",v=o&&"number"==typeof(null==l?void 0:l.varianceCostValue)?kn(l.varianceCostValue):o?kn((d||0)-(u||0)):"",b=this._getVarianceColor(t);a&&g.push(`<div style="font-size:0.85em;color:#cbd5e1;margin-bottom:4px;">Periode: ${a}</div>`),g.push(`<div>Rencana: <strong>${_n(c)}</strong>${o?` <span style="color:#cbd5e1;font-size:0.85em;">(${p})</span>`:""}</div>`),g.push(`<div>Realisasi: <strong>${_n(e)}</strong>${o?` <span style="color:#cbd5e1;font-size:0.85em;">(${m})</span>`:""}</div>`),g.push(`<div>Variance: <strong style="color:${b};">${t>=0?"+":""}${t.toFixed(1)}%</strong>${o?` <span style="color:${b};font-size:0.85em;">(${v})</span>`:""}</div>`)}this.tooltipEl.innerHTML=g.join("");const v=e.data[0][r],b=e.valToPos(v,"x"),w=Math.min(2,e.data.length-1);let x=null==(s=e.data[w])?void 0:s[r];Number.isFinite(x)||(x=null!=(o=null==(a=e.data[1])?void 0:a[r])?o:0);const y=e.valToPos(x,"y");this.tooltipEl.style.left=`${b}px`,this.tooltipEl.style.top=`${y}px`,this.tooltipEl.style.opacity="1"}_updateTooltipPosition(){if(!this.chartInstance||!this.tooltipEl)return;const{idx:e}=this.chartInstance.cursor;null!=e&&this._updateTooltip(this.chartInstance)}_formatDateLabel(e){if(!e)return"";let t=e;if(e instanceof Date||(t=new Date(e)),!(t instanceof Date)||Number.isNaN(t.getTime()))return"";if(!this._dateFormatter&&"undefined"!=typeof Intl&&"function"==typeof Intl.DateTimeFormat)try{this._dateFormatter=new Intl.DateTimeFormat("id-ID",{day:"2-digit",month:"short",year:"numeric"})}catch(l){console.warn(En,"Intl.DateTimeFormat unavailable, falling back to basic formatter:",l),this._dateFormatter=null}if(this._dateFormatter)return this._dateFormatter.format(t);return`${String(t.getDate()).padStart(2,"0")}/${String(t.getMonth()+1).padStart(2,"0")}/${t.getFullYear()}`}_formatWeekRange(e,t){const l=(null==e?void 0:e.week_start)||(null==t?void 0:t.week_start),n=(null==e?void 0:e.week_end)||(null==t?void 0:t.week_end),i=l?this._formatDateLabel(new Date(l)):"",s=n?this._formatDateLabel(new Date(n)):"";return this._composeRangeText(i,s)}_composeRangeText(e,t){return e&&t?`${e} - ${t}`:e||t||""}_getVarianceColor(e){return e>.1?"#f87171":e<-.1?"#22c55e":"#cbd5e1"}_resolveCostAmount(e,t,l){if(e){const t=this._parseNumber(e.cumulative_cost);if(Number.isFinite(t)&&t>0)return kn(t);const l=this._parseNumber(e.cost);if(Number.isFinite(l)&&l>0)return kn(l)}return!Number.isFinite(l)||l<=0?kn(0):kn(l*t/100)}_parseNumber(e){if("number"==typeof e)return e;if("string"==typeof e){const t=Number(e);return Number.isFinite(t)?t:NaN}return NaN}}const Fn=Object.freeze(Object.defineProperty({__proto__:null,KurvaSUPlotChart:zn,default:zn},Symbol.toStringTag,{value:"Module"}));export{h as B,f as K,p as T,m as i,Fn as u};
//# sourceMappingURL=chart-modules-7de66ekb.js.map
