/* ==========================================
   Rincian AHSP — Elegant & Functional Parity
   ========================================== */

/* ===== Grid: kiri | resizer | kanan (match template_ahsp) ===== */
#rekap-app .hi-body{
  display: grid;
  grid-template-columns:
    minmax(280px, var(--rk-left-w, var(--ra-left-w, 360px)))
    6px
    minmax(var(--ta-editor-min, 600px), 1fr);
  gap: 12px;
  align-items: stretch;
  min-height: var(--ra-page-minvh, 68vh);
}

/* ===== Sidebar kiri (parity .ta-sidebar & .ta-job-list) ===== */
#rekap-app .rk-left.ta-sidebar{
  background: var(--dp-c-surface);
  border: 1px solid var(--dp-c-border);
  border-radius: var(--dp-radius-md);
  padding: 10px;
  display: flex;
  flex-direction: column;
  min-width: 240px; max-width: 640px;
  box-shadow: var(--dp-shadow-sm);
  max-height: calc(100vh - var(--ra-headroom, 120px));
  min-height: 0;
  overflow: hidden;
}

/* List (scroll in-panel + shadows parity) */
#rekap-app .ta-job-list{
  list-style: none; margin: 8px 0 0 0; padding: 0;
  max-height: calc(100vh - var(--ra-headroom, 120px));
  overflow: auto;
  position: relative;
  background-clip: padding-box;
}
#rekap-app .ta-job-list::before,
#rekap-app .ta-job-list::after{
  content:"";
  position: sticky;
  left: 0; right: 0;
  height: 14px;
  pointer-events: none;
  z-index: 1;
}
#rekap-app .ta-job-list::before{
  top: 0;
  background: linear-gradient(to bottom, color-mix(in srgb, var(--dp-c-text) 14%, transparent), transparent);
}
#rekap-app .ta-job-list::after{
  bottom: 0;
  background: linear-gradient(to top, color-mix(in srgb, var(--dp-c-text) 14%, transparent), transparent);
}

/* Item parity (hover/active + active bar) */
#rekap-app #rk-list .rk-item{
  padding: 8px;
  border-radius: var(--dp-radius-sm);
  cursor: pointer;
  border: 1px solid transparent;
  transition: background-color .15s ease, border-color .15s ease, box-shadow .15s ease;
  background: var(--dp-c-surface);
  display: flex; flex-direction: column; gap: 4px;
}
#rekap-app #rk-list .rk-item:hover{ background: var(--dp-c-surface-2); }
#rekap-app #rk-list .rk-item.active{
  border-color: color-mix(in srgb, var(--dp-c-primary) 15%, transparent);
  background: var(--dp-c-primary-subtle);
  position: relative;
}
#rekap-app #rk-list .rk-item.active::before{
  content:"";
  position:absolute; inset: 6px auto 6px 4px;
  width: 2px; border-radius: 2px;
  background: color-mix(in srgb, var(--dp-c-primary) 72%, transparent);
}
#rekap-app #rk-list .rk-item .rk-item-title{
  font-weight: 500; line-height: 1.35; font-size: var(--ux-font-md);
  /* clamp 2 baris seperti Template AHSP */
  display: -webkit-box; -webkit-box-orient: vertical;
  -webkit-line-clamp: 2; line-clamp: 2; overflow: hidden;
}
#rekap-app #rk-list .rk-item .rk-item-meta{
  display: flex; flex-wrap: wrap; gap: 8px; align-items: center;
  font-size: var(--ux-font-xs); color: var(--dp-c-muted);
}

/* ===== Resizer (affordance parity) ===== */
#rekap-app .rk-resizer{ position: relative; }
#rekap-app .rk-resizer::before{
  content:""; position:absolute; inset: 0;
  background: linear-gradient(transparent 40%, color-mix(in srgb, var(--dp-c-text) 22%, transparent) 40% 60%, transparent 60%) center/2px 22px no-repeat;
  opacity: .25;
}
#rekap-app .rk-resizer:hover::before,
#rekap-app .rk-resizer:focus::before{ opacity:.6; }
#rekap-app .rk-resizer:focus{ outline: 2px solid var(--dp-c-focus); outline-offset: -2px; }

/* ===== Editor kanan (parity .ta-editor) ===== */
#rekap-app .rk-right.ta-editor{
  background: var(--ta-editor-surface, var(--dp-c-surface));
  border: 1px solid var(--dp-c-border);
  border-radius: var(--dp-radius-md);
  display: block; /* biarkan konten menentukan tinggi, scroll di halaman */
  overflow: visible;
  padding-left: var(--ta-editor-pad-x, 10px);
  padding-right: var(--ta-editor-pad-x, 10px);
  position: relative;
  min-width: 320px;
  box-shadow: var(--dp-shadow-sm);
}
/* Scroll shadows parity */
#rekap-app .rk-right.ta-editor::before,
#rekap-app .rk-right.ta-editor::after{
  content:""; position: sticky; left: 0; right: 0; height: 18px; pointer-events: none; z-index: 2;
}
#rekap-app .rk-right.ta-editor::before{
  top: 0; margin-top: -1px;
  background: linear-gradient(to bottom, color-mix(in srgb, var(--dp-c-text) 14%, transparent), transparent);
}
#rekap-app .rk-right.ta-editor::after{
  bottom: 0; margin-bottom: -1px;
  background: linear-gradient(to top, color-mix(in srgb, var(--dp-c-text) 14%, transparent), transparent);
}

/* Header kanan (parity .ta-seg-header) */
#rekap-app .rk-right-header.ta-seg-header{
  display:flex; align-items:center; justify-content:space-between;
  margin-top:10px; margin-bottom:6px; padding:6px 0;
  border-bottom:1px solid var(--dp-c-border);
  background: var(--dp-c-surface-1);
  position: sticky; top: var(--ta-sticky-gap, 0px);
  z-index: calc(var(--dp-z-sticky) + 1);
  backdrop-filter: saturate(1.1) blur(2px);
}
#rekap-app .rk-right-title.ta-title{
  margin:0; font-size: var(--ux-font-lg); font-weight:600; letter-spacing:.2px;
}
#rekap-app .rk-right-actions{ display:flex; align-items:center; gap:8px; }

/* ===== Table wrap & table (parity .ta-table) ===== */
#rekap-app .hi-table-wrap.ta-table-wrap{
  border-top: 1px solid var(--dp-c-border);
  background: var(--dp-c-surface);
  overflow: visible; /* vertikal mengikuti halaman */
}
#rekap-app table.ta-table{
  width: 100%; border-collapse: collapse; font-size: var(--ux-font-md); table-layout: fixed;
}
#rekap-app table.ra-table thead th{
  background: var(--dp-c-surface-2);
  border-bottom: 2px solid var(--dp-c-border);
  font-size: var(--ux-font-xs);
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: .03em;
}
#rekap-app table.ta-table th,
#rekap-app table.ta-table td{
  border: 1px solid var(--dp-c-border);
  padding: var(--ux-cell-py-compact) var(--ux-cell-px);
  vertical-align: middle; background: var(--dp-c-surface);
  word-break: break-word; overflow-wrap: anywhere;
}
/* Zebra & hover parity */
#rekap-app table.ta-table tbody tr:nth-child(odd) > *{
  background: color-mix(in srgb, var(--dp-c-surface-2) 30%, transparent);
}
#rekap-app table.ta-table tbody tr:hover > *{
  background: color-mix(in srgb, var(--dp-c-primary) 6%, transparent);
}
/* Fokus/aktif parity */
#rekap-app table.ra-table tbody tr.is-active,
#rekap-app table.ra-table tbody tr:focus-within{
  outline: 2px solid var(--dp-accent); outline-offset: -2px;
}

/* THEAD style mengikuti pola global (tidak sticky internal container) */
#rekap-app table.ra-table thead th{
  background: var(--dp-c-surface-2);
  border-bottom: 2px solid var(--dp-c-border);
  font-size: var(--ux-font-xs);
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: .03em;
}

/* Lebar kolom dasar agar minim horizontal scroll */
#rekap-app #ra-table col.col-no{ width: 6ch; }
#rekap-app #ra-table col.col-uraian{ width: auto; }
#rekap-app #ra-table col.col-kode{ width: 10ch; }
#rekap-app #ra-table col.col-satuan{ width: 8ch; }
#rekap-app #ra-table col.col-koef{ width: 14ch; }
#rekap-app #ra-table col.col-rps{ width: 18ch; }
#rekap-app #ra-table col.col-rpj{ width: 18ch; }

/* Alignment angka & monospace */
#rekap-app table.ra-table td:nth-child(4){ text-align:center; } /* Satuan */
#rekap-app table.ra-table td:nth-child(5),
#rekap-app table.ra-table td:nth-child(6),
#rekap-app table.ra-table td:nth-child(7){
  text-align:right;
  font-variant-numeric: tabular-nums;
  font-feature-settings: var(--ux-font-feature-num, "tnum" 1, "lnum" 1);
}

/* Summary chips (parity) */
#rekap-app #rk-summary .ux-badge-ref{ background: var(--dp-c-surface-2); }

/* Chips */
#rekap-app .ta-chip{
  display:inline-flex; align-items:center; gap:6px;
  border-radius: calc(var(--dp-radius-sm) - 2px);
  padding:2px 8px; font-size: var(--ux-font-2xs); line-height:1;
  border:1px solid var(--dp-c-border);
  background: var(--dp-c-surface-2);
  color: var(--dp-c-text);
}
#rekap-app .ta-chip-warn{
  background: color-mix(in srgb, var(--dp-c-warning) 14%, transparent);
  border-color: color-mix(in srgb, var(--dp-c-warning) 30%, transparent);
}

/* ===== Page header & toolbar parity ===== */
#rekap-app.ta-app .ta-page-header{ margin-top:8px; }
#rekap-app.ta-app .ta-title{ margin:0; font-weight:600; font-size: var(--ux-font-lg); letter-spacing:.2px; }
#rekap-app.ta-app .ta-subtitle{ margin:2px 0 0 0; color:var(--dp-c-muted); font-size: var(--ux-font-md); }

#rekap-app.ta-app .ta-toolbar{
  background: var(--dp-c-surface-1);
  border: 1px solid var(--dp-c-border);
  border-radius: var(--dp-radius-md);
  padding: .5rem .75rem;
  min-height: var(--da-toolbar-h);
  box-shadow: var(--dp-shadow-sm);
}

/* Searchbar parity (toolbar search) */
.ta-searchbar{ flex: 1 1 clamp(24rem, 50vw, 48rem); min-width: 0; }
.ta-searchbar .input-group-text{ border-right:0; display:flex; align-items:center; }
.ta-searchbar .form-control{ border-left:0; }

/* Toolbar input-group sizing + tone */
#rekap-app.ta-app .ta-toolbar .input-group .form-control,
#rekap-app.ta-app .ta-toolbar .input-group .input-group-text{
  font-size: var(--ux-font-xs);
  line-height: 1.5;
  padding-top: .375rem;
  padding-bottom: .375rem;
}
#rekap-app.ta-app .ta-toolbar .input-group .form-control{
  background: var(--dp-c-bg);
  color: var(--dp-c-text);
}
#rekap-app.ta-app .ta-toolbar .input-group .input-group-text{
  background: var(--dp-c-surface-2);
  color: var(--dp-c-muted);
  border-color: var(--dp-c-border);
}

/* Input kecil seragam */
#rekap-app input.hi-input{
  font-size: var(--ux-font-sm); line-height:1.25;
  height: var(--ux-input-h-compact); padding:.25rem .5rem;
}

/* Alias kecil: .mono → monospace (agar konsisten bila dipakai) */
#rekap-app .mono{ font-family: inherit; }

/* ===== Responsive ===== */
@media (max-width: 1100px){ body[data-page="rincian_ahsp"]{ --ra-left-w: 320px; } }
@media (max-width: 900px) { body[data-page="rincian_ahsp"]{ --ra-left-w: 280px; } }
@media (max-width: 760px){
  #rekap-app .hi-body{ display:flex; flex-direction:column; gap: 12px; }
  #rekap-app .rk-resizer{ display:none; }
  #rekap-app .hi-table-wrap{ max-height:unset; }
  #rekap-app #rk-list .rk-item{ padding:12px; }
}

