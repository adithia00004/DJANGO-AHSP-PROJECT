{"version":3,"file":"jadwal-kegiatan-BipCiL-H.js","sources":["../../../../../../js/src/jadwal_kegiatan_app.js"],"sourcesContent":["/**\n * Jadwal Kegiatan Main Entry Point\n * Modern modular implementation with Vite bundling\n * License: MIT\n */\n/* global ExportManager */\n\nimport { attachGridEvents } from '@modules/grid/grid-event-handlers.js';\nimport { AGGridManager } from '@modules/grid/ag-grid-setup.js';\nimport { updateProgressIndicator } from '@modules/shared/validation-utils.js';\nimport { DataLoader } from '@modules/core/data-loader.js';\nimport { TimeColumnGenerator } from '@modules/core/time-column-generator.js';\nimport { GridRenderer } from '@modules/grid/grid-renderer.js';\nimport { SaveHandler } from '@modules/core/save-handler.js';\nimport { KurvaSChart } from '@modules/kurva-s/echarts-setup.js';\nimport { GanttChart } from '@modules/gantt/frappe-gantt-setup.js';\nimport { StateManager } from '@modules/core/state-manager.js'; // Phase 0.3: StateManager integration\n\n/**\n * Initialize Jadwal Kegiatan Grid Application\n */\nclass JadwalKegiatanApp {\n  constructor() {\n    this.state = null;\n    this.eventManager = null;\n    this.initialized = false;\n    this.agGridManager = null;\n\n    // Phase 0.3: StateManager for clean state management\n    this.stateManager = StateManager.getInstance();\n\n    // Modern modules\n    this.dataLoader = null;\n    this.timeColumnGenerator = null;\n    this.gridRenderer = null;\n    this.saveHandler = null;\n\n    // Chart modules\n    this.kurvaSChart = null;\n    this.ganttChart = null;\n\n    this._weekBoundarySaveTimer = null;\n    this._pendingWeekBoundary = null;\n    this._isRegeneratingTimeline = false;\n    this._queuedRegeneratePayload = null;\n    this._isEnforcingWeekly = false;\n    this._exportManagerInstance = null;\n    this._exportBindingsAttached = false;\n  }\n\n  _getProjectDateRange() {\n    let start = null;\n    let end = null;\n    if (this.state?.projectStart) {\n      const parsed = new Date(this.state.projectStart);\n      if (!Number.isNaN(parsed.getTime())) {\n        start = parsed;\n      }\n    }\n    if (this.state?.projectEnd) {\n      const parsedEnd = new Date(this.state.projectEnd);\n      if (!Number.isNaN(parsedEnd.getTime())) {\n        end = parsedEnd;\n      }\n    }\n    if (start && (!end || Number.isNaN(end.getTime()))) {\n      end = new Date(start.getFullYear(), 11, 31);\n    }\n    return { start, end };\n  }\n\n  _estimateExpectedWeeklyColumns() {\n    const { start, end } = this._getProjectDateRange();\n    if (!start || !end || Number.isNaN(start.getTime()) || Number.isNaN(end.getTime())) {\n      return 0;\n    }\n    const msPerDay = 1000 * 60 * 60 * 24;\n    const diffDays = Math.max(0, Math.floor((end - start) / msPerDay)) + 1;\n    return Math.max(1, Math.ceil(diffDays / 7));\n  }\n\n  _countWeeklyColumns() {\n    if (!Array.isArray(this.state.timeColumns)) {\n      return 0;\n    }\n    return this.state.timeColumns.filter((col) => {\n      const mode = (col.generationMode || col.type || '').toLowerCase();\n      if (mode === 'weekly' || mode === 'week' || mode === 'wk') {\n        return true;\n      }\n      return Number.isFinite(Number(col.weekNumber ?? col.week_number));\n    }).length;\n  }\n\n  /**\n   * Initialize the application\n   *\n   * @param {Object} config - Configuration options\n   * @param {Object} config.initialState - Initial application state\n   * @param {Object} config.domRefs - DOM element references\n   */\n  async initialize(config = {}) {\n    if (this.initialized) {\n      console.warn('JadwalKegiatanApp already initialized');\n      return;\n    }\n\n    console.log('üöÄ Initializing Jadwal Kegiatan App (Vite Build)');\n\n    try {\n      // Setup state\n      this._setupState(config);\n\n      // Setup DOM references\n      this._setupDomRefs(config);\n\n      // Attach event handlers\n      this._attachEvents();\n\n      // Load initial data\n      await this._loadInitialData();\n\n      this.initialized = true;\n      console.log('‚úÖ Jadwal Kegiatan App initialized successfully');\n\n      // Expose to window for backwards compatibility\n      window.JadwalKegiatanApp = this;\n    } catch (error) {\n      console.error('‚ùå Failed to initialize Jadwal Kegiatan App:', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Setup application state\n   */\n  _setupState(config) {\n    // Check if there's existing global state (backwards compatibility)\n    const existingState = window.kelolaTahapanPageState || window.JadwalPekerjaanApp?.state;\n\n    this.state = Object.assign(\n      {\n        // Shared state (mode-independent)\n        pekerjaanTree: [],\n        timeColumns: [],\n        tahapanList: [],\n        timeColumnIndex: {},\n        expandedNodes: new Set(),\n        volumeMap: new Map(),\n        isLoading: false,\n        error: null,\n        domRefs: {},\n        apiEndpoints: {},\n        projectId: null,\n        projectName: '',\n        projectStart: null,\n        projectEnd: null,\n        useAgGrid: false,\n        timeScale: 'weekly',\n        inputMode: 'percentage',\n        saveMode: 'weekly',\n        weekStartDay: 0,\n        weekEndDay: 6,\n        displayScale: null,\n        progressMode: 'planned',  // Phase 2E.1: Current active mode\n        displayMode: 'percentage', // Phase 2E.1: 'percentage' or 'volume'\n\n        // Phase 0.3: StateManager reference\n        stateManager: this.stateManager,\n\n        // Phase 0.3: Cell values now managed by StateManager\n        // Keeping other mode-specific state here temporarily for non-cell data\n        plannedState: {\n          // modifiedCells: managed by StateManager\n          // assignmentMap: managed by StateManager\n          progressTotals: new Map(),\n          volumeTotals: new Map(),\n          cellVolumeOverrides: new Map(),\n          cellValidationMap: new Map(),\n          failedRows: new Set(),\n          autoWarningRows: new Set(),\n          volumeWarningRows: new Set(),\n          validationWarningRows: new Set(),\n          saveErrorRows: new Set(),\n          apiFailedRows: new Set(),\n          showCompletionWarnings: false,\n          isDirty: false,\n        },\n        actualState: {\n          // modifiedCells: managed by StateManager\n          // assignmentMap: managed by StateManager\n          progressTotals: new Map(),\n          volumeTotals: new Map(),\n          cellVolumeOverrides: new Map(),\n          cellValidationMap: new Map(),\n          failedRows: new Set(),\n          autoWarningRows: new Set(),\n          volumeWarningRows: new Set(),\n          validationWarningRows: new Set(),\n          saveErrorRows: new Set(),\n          apiFailedRows: new Set(),\n          showCompletionWarnings: false,\n          isDirty: false,\n        },\n\n        // Phase 0.3: Backward compatibility maintained via StateManager\n        // Legacy properties for non-cell data still delegate to current mode\n        progressTotals: null,\n        volumeTotals: null,\n        cellVolumeOverrides: null,\n        cellValidationMap: null,\n        failedRows: null,\n        autoWarningRows: null,\n        volumeWarningRows: null,\n        validationWarningRows: null,\n        saveErrorRows: null,\n        apiFailedRows: null,\n        showCompletionWarnings: false,\n        isDirty: false,\n      },\n      existingState || {},\n      config.initialState || {}\n    );\n\n    // Expose to window for backwards compatibility\n    window.kelolaTahapanPageState = this.state;\n\n    this.state.timeColumnIndex = this._createTimeColumnIndex(this.state.timeColumns);\n    this._ensureStateCollections();\n    if (!this.state.displayScale) {\n      this.state.displayScale = this.state.timeScale || 'weekly';\n    }\n\n    // Phase 2E.1: Setup property delegation for backward compatibility\n    this._setupStateDelegation();\n  }\n\n  /**\n   * Setup property delegation for backward compatibility.\n   * Phase 0.3: Cell data (modifiedCells, assignmentMap) now managed by StateManager\n   * Other mode-specific properties still delegate to current mode state\n   */\n  _setupStateDelegation() {\n    const getCurrentState = () => {\n      return this.state.progressMode === 'actual'\n        ? this.state.actualState\n        : this.state.plannedState;\n    };\n\n    // Phase 0.3: modifiedCells and assignmentMap are now managed by StateManager\n    // Add backward compatibility getters that delegate to StateManager\n    Object.defineProperty(this.state, 'modifiedCells', {\n      get: () => {\n        // Return a Map-like object for backward compatibility\n        // This is used by legacy code that expects Map operations\n        const mode = this.state.progressMode;\n        return this.stateManager.states[mode].modifiedCells;\n      },\n      configurable: true\n    });\n\n    Object.defineProperty(this.state, 'assignmentMap', {\n      get: () => {\n        // Return a Map-like object for backward compatibility\n        const mode = this.state.progressMode;\n        return this.stateManager.states[mode].assignmentMap;\n      },\n      configurable: true\n    });\n\n    Object.defineProperty(this.state, 'costAssignmentMap', {\n      get: () => {\n        const mode = this.state.progressMode;\n        return this.stateManager.states[mode].costAssignmentMap;\n      },\n      configurable: true\n    });\n\n    Object.defineProperty(this.state, 'costModifiedCells', {\n      get: () => {\n        const mode = this.state.progressMode;\n        return this.stateManager.states[mode].costModifiedCells;\n      },\n      configurable: true\n    });\n\n    // Other properties still delegate to current mode state (not managed by StateManager yet)\n    Object.defineProperty(this.state, 'progressTotals', {\n      get: () => getCurrentState().progressTotals,\n      configurable: true\n    });\n\n    Object.defineProperty(this.state, 'volumeTotals', {\n      get: () => getCurrentState().volumeTotals,\n      configurable: true\n    });\n\n    Object.defineProperty(this.state, 'cellVolumeOverrides', {\n      get: () => getCurrentState().cellVolumeOverrides,\n      configurable: true\n    });\n\n    Object.defineProperty(this.state, 'cellValidationMap', {\n      get: () => getCurrentState().cellValidationMap,\n      configurable: true\n    });\n\n    Object.defineProperty(this.state, 'isDirty', {\n      get: () => getCurrentState().isDirty || this.stateManager.hasUnsavedChanges(),\n      set: (value) => { getCurrentState().isDirty = value; },\n      configurable: true\n    });\n\n    console.log('[JadwalKegiatanApp] Phase 0.3: State delegation setup with StateManager integration');\n  }\n\n  /**\n   * Get the current mode's state object.\n   * Phase 0.3: Delegated to StateManager\n   * @returns {Object} Current mode state (plannedState or actualState)\n   */\n  _getCurrentModeState() {\n    const mode = this.state.progressMode === 'actual' ? 'actual' : 'planned';\n    return this.stateManager.states[mode];\n  }\n\n  _updateSaveButtonState() {\n    const saveButton = this.state?.domRefs?.saveButton;\n    if (!saveButton) {\n      return;\n    }\n    const hasFailures = this.state?.failedRows instanceof Set && this.state.failedRows.size > 0;\n    saveButton.disabled = false;\n    saveButton.classList.toggle('btn-outline-danger', Boolean(hasFailures));\n    saveButton.classList.toggle('btn-success', !hasFailures);\n    if (hasFailures) {\n      saveButton.setAttribute(\n        'title',\n        'Ada baris dengan peringatan (>100%/volume). Klik untuk melihat detail dan perbaiki.'\n      );\n    } else {\n      saveButton.removeAttribute('title');\n    }\n  }\n\n  _ensureStateCollections() {\n    if (!(this.state.failedRows instanceof Set)) {\n      this.state.failedRows = new Set();\n    }\n    if (!(this.state.autoWarningRows instanceof Set)) {\n      this.state.autoWarningRows = new Set();\n    }\n    if (!(this.state.volumeWarningRows instanceof Set)) {\n      this.state.volumeWarningRows = new Set();\n    }\n    if (!(this.state.validationWarningRows instanceof Set)) {\n      this.state.validationWarningRows = new Set();\n    }\n    if (!(this.state.saveErrorRows instanceof Set)) {\n      this.state.saveErrorRows = new Set();\n    }\n    if (!(this.state.apiFailedRows instanceof Set)) {\n      this.state.apiFailedRows = new Set();\n    }\n    if (!(this.state.progressTotals instanceof Map)) {\n      this.state.progressTotals = new Map();\n    }\n    if (!(this.state.volumeTotals instanceof Map)) {\n      this.state.volumeTotals = new Map();\n    }\n    if (!(this.state.cellVolumeOverrides instanceof Map)) {\n      this.state.cellVolumeOverrides = new Map();\n    }\n    if (!(this.state.cellValidationMap instanceof Map)) {\n      this.state.cellValidationMap = new Map();\n    }\n  }\n\n  /**\n   * Setup DOM references\n   */\n  _setupDomRefs(config) {\n    const domRefs = Object.assign(\n      {\n        root: document.getElementById('tahapan-grid-app'),\n        leftThead: document.getElementById('left-thead'),\n        rightThead: document.getElementById('right-thead'),\n        leftTbody: document.getElementById('left-tbody'),\n        rightTbody: document.getElementById('right-tbody'),\n        leftPanelScroll: document.querySelector('.left-panel-scroll'),\n        rightPanelScroll:\n          document.getElementById('right-panel-scroll-bottom') ||\n          document.querySelector('.right-panel-scroll'),\n        rightTable: document.getElementById('right-table'),\n        horizontalScrollTop: document.getElementById('right-panel-scroll-top'),\n        horizontalScrollInner: document.getElementById('right-panel-scroll-inner'),\n        timeHeaderRow: document.getElementById('time-header-row'),\n        saveButton: document.getElementById('save-button') || document.getElementById('btn-save-all'),\n        refreshButton: document.getElementById('refresh-button'),\n        resetButton: document.getElementById('btn-reset-progress'),\n        agGridContainer: document.getElementById('ag-grid-container'),\n        agGridTopScroll: document.getElementById('ag-grid-scroll-top'),\n        agGridTopScrollInner: document.getElementById('ag-grid-scroll-inner'),\n        scurveChart: document.getElementById('scurve-chart'),\n        ganttChart: document.getElementById('gantt-chart'),\n        statusBar: document.querySelector('.status-bar'),\n        statusMessageEl: document.getElementById('status-message'),\n        itemCountEl: document.getElementById('item-count'),\n        modifiedCountEl: document.getElementById('modified-count'),\n        totalProgressEl: document.getElementById('total-progress'),\n        weekStartSelect: document.getElementById('week-start-day-select'),\n        weekEndSelect: document.getElementById('week-end-day-select'),\n      },\n      config.domRefs || {}\n    );\n\n    this.state.domRefs = domRefs;\n    this._updateSaveButtonState();\n\n    if (!domRefs.root) {\n      throw new Error('Root container #tahapan-grid-app tidak ditemukan');\n    }\n\n    this._applyDataset(domRefs.root);\n\n    if (this.state.useAgGrid) {\n      if (!domRefs.agGridContainer) {\n        throw new Error('AG Grid container #ag-grid-container tidak ditemukan');\n      }\n    } else {\n      if (!domRefs.leftTbody || !domRefs.rightTbody) {\n        throw new Error('Critical DOM elements not found (leftTbody, rightTbody)');\n      }\n    }\n  }\n\n  /**\n   * Apply dataset attributes from root container into state\n   */\n  _applyDataset(rootElement) {\n    if (!rootElement || !rootElement.dataset) {\n      return;\n    }\n\n    const { dataset } = rootElement;\n\n    this.state.projectId = Number(dataset.projectId || this.state.projectId || 0) || this.state.projectId;\n    this.state.projectName = dataset.projectName || this.state.projectName;\n    this.state.projectStart = dataset.projectStart || this.state.projectStart;\n    this.state.projectEnd = dataset.projectEnd || this.state.projectEnd;\n\n    const allowedTimeScales = new Set(['daily', 'weekly', 'monthly', 'custom']);\n    const datasetScale =\n      (dataset.defaultTimeScale ||\n        dataset.timeScale ||\n        dataset.saveMode ||\n        this.state.timeScale ||\n        this.state.saveMode ||\n        '')\n        .toString()\n        .toLowerCase();\n    if (allowedTimeScales.has(datasetScale)) {\n      this.state.timeScale = datasetScale;\n      this.state.saveMode = datasetScale;\n    } else if (!this.state.timeScale) {\n      this.state.timeScale = this.state.saveMode || 'weekly';\n    }\n    this.state.displayScale = this.state.timeScale || 'weekly';\n\n    const datasetInputMode =\n      (dataset.defaultInputMode || dataset.inputMode || dataset.displayMode || this.state.inputMode || 'percentage')\n        .toString()\n        .toLowerCase();\n    const allowedInputModes = new Set(['percentage', 'volume', 'cost']);\n    this.state.inputMode = allowedInputModes.has(datasetInputMode) ? datasetInputMode : 'percentage';\n\n    const parsedWeekEndDay = Number.parseInt(\n      dataset.weekEndDay ?? dataset.weekend ?? dataset.weekEnd ?? dataset.week_end_day ?? '',\n      10\n    );\n    if (!Number.isNaN(parsedWeekEndDay)) {\n      this.state.weekEndDay = parsedWeekEndDay;\n    }\n\n    const parsedWeekStartDay = Number.parseInt(\n      dataset.weekStartDay ?? dataset.week_start_day ?? '',\n      10\n    );\n    if (!Number.isNaN(parsedWeekStartDay)) {\n      const normalized = ((parsedWeekStartDay % 7) + 7) % 7;\n      this.state.weekStartDay = normalized;\n    } else if (!Number.isNaN(parsedWeekEndDay)) {\n      this.state.weekStartDay = (this.state.weekEndDay + 1) % 7;\n    }\n\n    const endpoints = Object.assign(\n      {\n        base: dataset.apiBase || '',\n        tahapan: dataset.apiTahapan || dataset.apiBase || '',\n        listPekerjaan: dataset.apiListPekerjaan || '',\n        volume: dataset.apiVolume || '',\n        assignmentsBase: dataset.apiAssignmentsBase || '',\n        save:\n          dataset.apiSave ||\n          (this.state.apiEndpoints && this.state.apiEndpoints.save) ||\n          this._getDefaultSaveEndpoint(),\n        weekBoundary: dataset.apiWeekBoundary || '',\n        regenerateTahapan: dataset.apiRegenerateTahapan || '',\n        reset: dataset.apiResetProgress || (this.state.apiEndpoints && this.state.apiEndpoints.reset) || '',\n      },\n      this.state.apiEndpoints || {}\n    );\n\n    this.state.apiEndpoints = endpoints;\n    this.state.useAgGrid = dataset.enableAgGrid === 'true' || this.state.useAgGrid;\n  }\n\n  /**\n   * Attach event handlers using modern delegation pattern\n   */\n  _attachEvents() {\n    const helpers = {\n      updateProgressIndicator: (pekerjaanId, total) => {\n        updateProgressIndicator(pekerjaanId, total, this.state);\n      },\n      showToast: this.showToast.bind(this),\n    };\n\n    if (!this.state.useAgGrid) {\n      this.eventManager = attachGridEvents(this.state, helpers);\n    } else if (this.eventManager) {\n      this.eventManager.cleanup();\n      this.eventManager = null;\n    }\n\n    // Attach toolbar events\n    this._attachToolbarEvents();\n\n    // Initialize AG Grid when enabled\n    this._initAgGridIfNeeded();\n  }\n\n  /**\n   * Attach toolbar button events\n   */\n  _attachToolbarEvents() {\n    const saveButton = this.state.domRefs.saveButton;\n    const refreshButton = this.state.domRefs.refreshButton;\n    const resetButton = this.state.domRefs.resetButton;\n\n    if (saveButton) {\n      saveButton.addEventListener('click', () => this.saveChanges());\n    }\n\n    if (refreshButton) {\n      refreshButton.addEventListener('click', () => this.refresh());\n    }\n\n    if (resetButton) {\n      resetButton.addEventListener('click', () => this._handleResetProgress());\n    }\n\n    this._syncToolbarRadios();\n    this._attachRadioGroupHandler('displayMode', (value) => this._handleDisplayModeChange(value));\n    this._attachRadioGroupHandler('progressMode', (value) => this._handleProgressModeChange(value));  // Phase 2E.1\n    this._attachRadioGroupHandler('timeScale', (value) => this._handleTimeScaleChange(value));\n    this._setupWeekBoundaryControls();\n    this._setupExportButtons();\n    this._setupCostViewToggle();  // Phase 1: Cost view toggle button\n  }\n\n  _setupExportButtons() {\n    if (this._exportBindingsAttached) {\n      return;\n    }\n    if (typeof ExportManager === 'undefined') {\n      console.warn('[JadwalKegiatanApp] ExportManager is not loaded; export buttons disabled');\n      return;\n    }\n    if (!this.state?.projectId) {\n      return;\n    }\n\n    try {\n      this._exportManagerInstance = new ExportManager(this.state.projectId, 'jadwal-pekerjaan');\n      const formats = ['csv', 'pdf', 'word', 'xlsx'];\n      formats.forEach((format) => {\n        const button = document.getElementById(`btn-export-${format}`);\n        if (!button) {\n          return;\n        }\n        button.addEventListener('click', () => {\n          this._exportManagerInstance.exportAs(format);\n        });\n      });\n      this._exportBindingsAttached = true;\n    } catch (error) {\n      console.error('[JadwalKegiatanApp] Failed to initialize export buttons', error);\n    }\n  }\n\n  /**\n   * Phase 1: Setup Cost View Toggle Button\n   * @private\n   */\n  _setupCostViewToggle() {\n    const toggleBtn = document.getElementById('toggleCostViewBtn');\n    const toggleBtnText = document.getElementById('toggleCostViewBtnText');\n    const toggleBtnSpinner = document.getElementById('toggleCostViewBtnSpinner');\n\n    if (!toggleBtn) {\n      console.log('[JadwalKegiatanApp] Cost view toggle button not found (chart tab may not be active)');\n      return;\n    }\n\n    if (!this.kurvaSChart) {\n      console.warn('[JadwalKegiatanApp] Kurva S chart not initialized, cannot setup toggle');\n      return;\n    }\n\n    // Add click handler\n    toggleBtn.addEventListener('click', async () => {\n      // Disable button during toggle\n      toggleBtn.disabled = true;\n      toggleBtnSpinner?.classList.remove('d-none');\n\n      try {\n        // Toggle view\n        const success = await this.kurvaSChart.toggleView();\n\n        if (success) {\n          // Update button text based on current view mode\n          if (this.kurvaSChart.viewMode === 'cost') {\n            if (toggleBtnText) {\n              toggleBtnText.textContent = 'Show Progress View';\n            }\n            toggleBtn.innerHTML = '<i class=\"fas fa-chart-line\"></i> Show Progress View';\n            console.log('[JadwalKegiatanApp] ‚úÖ Switched to Cost View');\n          } else {\n            if (toggleBtnText) {\n              toggleBtnText.textContent = 'Show Cost View';\n            }\n            toggleBtn.innerHTML = '<i class=\"fas fa-money-bill-wave\"></i> Show Cost View';\n            console.log('[JadwalKegiatanApp] ‚úÖ Switched to Progress View');\n          }\n        } else {\n          console.error('[JadwalKegiatanApp] Failed to toggle view');\n        }\n      } catch (error) {\n        console.error('[JadwalKegiatanApp] Error toggling cost view:', error);\n      } finally {\n        // Re-enable button\n        toggleBtn.disabled = false;\n        toggleBtnSpinner?.classList.add('d-none');\n      }\n    });\n\n    console.log('[JadwalKegiatanApp] ‚úÖ Cost view toggle button setup complete');\n  }\n\n  _attachRadioGroupHandler(groupName, handler) {\n    const radios = document.querySelectorAll(`input[name=\"${groupName}\"]`);\n    if (!radios || radios.length === 0) {\n      return;\n    }\n\n    radios.forEach((radio) => {\n      radio.addEventListener('change', (event) => {\n        if (!event.target.checked) {\n          return;\n        }\n        handler(event.target.value);\n      });\n    });\n  }\n\n  _setupWeekBoundaryControls() {\n    const { weekStartSelect, weekEndSelect } = this.state.domRefs || {};\n    if (!weekStartSelect || !weekEndSelect) {\n      return;\n    }\n\n    this._syncWeekBoundaryControls();\n\n    weekStartSelect.addEventListener('change', (event) => {\n      const nextStart = this._normalizePythonWeekday(event.target.value, this._getWeekStartDay());\n      const derivedEnd = (nextStart + 6) % 7;\n      this._handleWeekBoundaryChange({ weekStartDay: nextStart, weekEndDay: derivedEnd, source: 'start' });\n    });\n\n    weekEndSelect.addEventListener('change', (event) => {\n      const nextEnd = this._normalizePythonWeekday(event.target.value, this._getWeekEndDay());\n      const derivedStart = (nextEnd + 1) % 7;\n      this._handleWeekBoundaryChange({ weekStartDay: derivedStart, weekEndDay: nextEnd, source: 'end' });\n    });\n  }\n\n  async _handleResetProgress() {\n    const endpoint = this.state.apiEndpoints?.reset;\n    if (!endpoint) {\n      this.showToast('Endpoint reset tidak tersedia', 'danger', 3200);\n      return;\n    }\n\n    // Phase 2E.1: Mode-aware reset\n    const progressMode = this.state.progressMode || 'planned';\n    const modeLabel = progressMode === 'planned' ? 'Perencanaan' : 'Realisasi';\n\n    const confirmed = window.confirm(\n      `Reset semua progress ${modeLabel} ke 0%?\\n\\n` +\n      `Data ${modeLabel === 'Perencanaan' ? 'Realisasi' : 'Perencanaan'} tidak akan terpengaruh.\\n\\n` +\n      `Operasi ini dapat di-undo dengan memasukkan ulang data.`\n    );\n    if (!confirmed) {\n      return;\n    }\n\n    try {\n      this.state.isLoading = true;\n      this._updateStatusBar(`Mereset progress ${modeLabel}...`);\n\n      const response = await fetch(endpoint, {\n        method: 'POST',\n        credentials: 'same-origin',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': this._getCsrfToken(),\n        },\n        body: JSON.stringify({ mode: progressMode }),  // Phase 2E.1: Send mode parameter\n      });\n\n      if (!response.ok) {\n        const text = await response.text().catch(() => '');\n        throw new Error(text || `HTTP ${response.status}`);\n      }\n\n      const result = await response.json().catch(() => ({}));\n      this._resetEditedCellsState();\n      if (this.state.assignmentMap instanceof Map) {\n        this.state.assignmentMap.clear();\n      } else {\n        this.state.assignmentMap = new Map();\n      }\n      this._clearFailedRows();\n      this.state.isDirty = false;\n\n      const message =\n        result?.message || 'Progress berhasil direset. Silakan input ulang jadwal pekerjaan.';\n      this.showToast(message, 'success', 3400);\n\n      await this._loadInitialData({ forceReload: true });\n    } catch (error) {\n      console.error('[JadwalKegiatanApp] Failed to reset progress', error);\n      this.showToast('Gagal mereset progress. Coba lagi atau hubungi admin.', 'danger', 3600);\n    } finally {\n      this.state.isLoading = false;\n      this._updateStatusBar();\n    }\n  }\n\n  _syncWeekBoundaryControls() {\n    const { weekStartSelect, weekEndSelect } = this.state.domRefs || {};\n    if (weekStartSelect) {\n      weekStartSelect.value = String(this._getWeekStartDay());\n    }\n    if (weekEndSelect) {\n      weekEndSelect.value = String(this._getWeekEndDay());\n    }\n  }\n\n  _handleWeekBoundaryChange({ weekStartDay, weekEndDay, source }) {\n    const normalizedEnd = this._normalizePythonWeekday(weekEndDay, this._getWeekEndDay());\n    const normalizedStart = this._normalizePythonWeekday(weekStartDay, (normalizedEnd + 1) % 7);\n    if (normalizedStart === this._getWeekStartDay() && normalizedEnd === this._getWeekEndDay()) {\n      this._syncWeekBoundaryControls();\n      return;\n    }\n\n    this.state.weekStartDay = normalizedStart;\n    this.state.weekEndDay = normalizedEnd;\n    this._syncWeekBoundaryControls();\n\n    const label = `${this._formatWeekdayLabel(normalizedStart)} ‚Üí ${this._formatWeekdayLabel(normalizedEnd)}`;\n    const prefix = source === 'start' ? 'Week start disetel ke' : 'Week end disetel ke';\n    this.showToast(`${prefix} ${label}`, 'info', 2400);\n\n    this._regenerateColumnsForWeekBoundary();\n    this._persistWeekBoundarySettings(normalizedStart, normalizedEnd);\n  }\n\n  _regenerateColumnsForWeekBoundary() {\n    if (!Array.isArray(this.state.tahapanList) || this.state.tahapanList.length === 0) {\n      return;\n    }\n\n    if (!this.timeColumnGenerator) {\n      this.timeColumnGenerator = new TimeColumnGenerator(this.state);\n    }\n\n    try {\n      this.timeColumnGenerator.generate();\n      this.state.timeColumnIndex = this._createTimeColumnIndex(this.state.timeColumns);\n      this._syncGridViews();\n      this._recalculateAllProgressTotals();\n    } catch (error) {\n      console.error('[JadwalKegiatanApp] Failed to regenerate columns for week boundary change', error);\n      this.showToast('Gagal menerapkan pengaturan minggu', 'danger', 3200);\n    }\n  }\n\n  _invalidateCachedDataset() {\n    this.state.pekerjaanTree = [];\n    this.state.tahapanList = [];\n    this.state.timeColumns = [];\n    this.state.flatPekerjaan = [];\n    this.state.timeColumnIndex = {};\n    this.state.assignmentMap = new Map();\n    this._resetEditedCellsState();\n  }\n\n  _resetEditedCellsState() {\n    if (this.state.modifiedCells instanceof Map) {\n      this.state.modifiedCells.clear();\n    } else {\n      this.state.modifiedCells = new Map();\n    }\n    if (this.state.cellVolumeOverrides instanceof Map) {\n      this.state.cellVolumeOverrides.clear();\n    } else {\n      this.state.cellVolumeOverrides = new Map();\n    }\n    if (this.state.cellValidationMap instanceof Map) {\n      this.state.cellValidationMap.clear();\n    } else {\n      this.state.cellValidationMap = new Map();\n    }\n    if (this.state.validationWarningRows instanceof Set) {\n      this.state.validationWarningRows.clear();\n    } else {\n      this.state.validationWarningRows = new Set();\n    }\n    if (this.state.saveErrorRows instanceof Set) {\n      this.state.saveErrorRows.clear();\n    } else {\n      this.state.saveErrorRows = new Set();\n    }\n    this.state.showCompletionWarnings = false;\n  }\n\n  _persistWeekBoundarySettings(weekStartDay, weekEndDay) {\n    const endpoint = this.state.apiEndpoints?.weekBoundary;\n    if (!endpoint) {\n      return;\n    }\n\n    if (this._weekBoundarySaveTimer) {\n      clearTimeout(this._weekBoundarySaveTimer);\n    }\n    this._pendingWeekBoundary = { weekStartDay, weekEndDay };\n\n    this._weekBoundarySaveTimer = window.setTimeout(() => {\n      this._weekBoundarySaveTimer = null;\n      const payload = this._pendingWeekBoundary || { weekStartDay, weekEndDay };\n      this._pendingWeekBoundary = null;\n      const body = JSON.stringify({\n        week_start_day: payload.weekStartDay,\n        week_end_day: payload.weekEndDay,\n      });\n\n      fetch(endpoint, {\n        method: 'POST',\n        credentials: 'same-origin',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': this._getCsrfToken(),\n        },\n        body,\n      })\n        .then((response) => {\n          if (!response.ok) {\n            throw new Error(`HTTP ${response.status}`);\n          }\n          return response.json();\n        })\n        .then((data) => {\n          const resolvedStart =\n            typeof data?.week_start_day !== 'undefined' ? data.week_start_day : payload.weekStartDay;\n          const resolvedEnd =\n            typeof data?.week_end_day !== 'undefined' ? data.week_end_day : payload.weekEndDay;\n          this.state.weekStartDay = resolvedStart;\n          this.state.weekEndDay = resolvedEnd;\n          this._regenerateTimeline({\n            mode: 'weekly',\n            weekStartDay: resolvedStart,\n            weekEndDay: resolvedEnd,\n          });\n        })\n        .catch((error) => {\n          console.warn('[JadwalKegiatanApp] Failed to persist week boundary setting', error);\n        });\n    }, 500);\n  }\n\n  async _regenerateTimeline(options = {}) {\n    const { mode = 'weekly', weekStartDay, weekEndDay } = options;\n    const endpoint = this.state.apiEndpoints?.regenerateTahapan;\n    if (!endpoint) {\n      return;\n    }\n\n    if (this._isRegeneratingTimeline) {\n      this._queuedRegeneratePayload = { mode, weekStartDay, weekEndDay };\n      return;\n    }\n\n    if (this.state.isDirty && this.state.modifiedCells instanceof Map && this.state.modifiedCells.size > 0) {\n      const confirmed = window.confirm(\n        'Mengubah batas minggu akan me-refresh data dan membatalkan perubahan yang belum disimpan. Lanjutkan?'\n      );\n      if (!confirmed) {\n        return;\n      }\n      this._resetEditedCellsState();\n      this.state.isDirty = false;\n    }\n\n    this._isRegeneratingTimeline = true;\n    this.state.isLoading = true;\n    const statusLabel = mode === 'monthly' ? 'Mengatur ulang struktur bulanan...' : 'Mengatur ulang struktur minggu...';\n    this._updateStatusBar(statusLabel);\n    const toastLabel =\n      mode === 'monthly'\n        ? 'Mengatur ulang kolom monthly...'\n        : 'Mengatur ulang kolom weekly sesuai preferensi Anda...';\n    this.showToast(toastLabel, 'info', 2400);\n\n    try {\n      const response = await fetch(endpoint, {\n        method: 'POST',\n        credentials: 'same-origin',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': this._getCsrfToken(),\n        },\n        body: JSON.stringify({\n          mode,\n          ...(mode === 'weekly'\n            ? {\n                week_start_day:\n                  typeof weekStartDay === 'number' ? weekStartDay : this._getWeekStartDay(),\n                week_end_day:\n                  typeof weekEndDay === 'number' ? weekEndDay : this._getWeekEndDay(),\n              }\n            : {}),\n        }),\n      });\n\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}`);\n      }\n\n      this._invalidateCachedDataset();\n      await this._loadInitialData({ forceReload: true });\n      const successMessage =\n        mode === 'monthly' ? 'Struktur monthly diperbarui (read-only)' : 'Periode minggu diperbarui';\n      this.showToast(successMessage, 'success', 2200);\n    } catch (error) {\n      console.error('[JadwalKegiatanApp] Failed to regenerate weekly structure', error);\n      this.showToast('Gagal memperbarui struktur waktu', 'danger', 3200);\n    } finally {\n      this.state.isLoading = false;\n      this._updateStatusBar();\n      this._isRegeneratingTimeline = false;\n      if (this._queuedRegeneratePayload) {\n        const next = this._queuedRegeneratePayload;\n        this._queuedRegeneratePayload = null;\n        this._regenerateTimeline(next);\n      }\n    }\n  }\n\n  _formatWeekdayLabel(pyDay) {\n    const names = ['Senin', 'Selasa', 'Rabu', 'Kamis', 'Jumat', 'Sabtu', 'Minggu'];\n    const normalized = this._normalizePythonWeekday(pyDay, 0);\n    return names[normalized] || `Day ${normalized}`;\n  }\n\n  _syncToolbarRadios() {\n    const displayMode = this.state.inputMode || 'percentage';\n    document.querySelectorAll('input[name=\"displayMode\"]').forEach((radio) => {\n      radio.checked = radio.value === displayMode;\n    });\n\n    const timeScale = this.state.displayScale || this.state.timeScale || 'weekly';\n    document.querySelectorAll('input[name=\"timeScale\"]').forEach((radio) => {\n      radio.checked = radio.value === timeScale;\n    });\n\n    this._updateCostToggleAvailability();\n  }\n\n  _handleDisplayModeChange(mode) {\n    const normalized = (mode || '').toLowerCase();\n    const allowed = new Set(['percentage', 'volume', 'cost']);\n    if (!allowed.has(normalized) || this.state.inputMode === normalized) {\n      return;\n    }\n\n    if (normalized === 'cost' && (this.state.progressMode || 'planned') !== 'actual') {\n      this.showToast('Mode biaya hanya tersedia saat melihat Realisasi', 'warning', 2600);\n      this._syncToolbarRadios();\n      return;\n    }\n\n    this.state.inputMode = normalized;\n    this.state.displayMode = normalized;  // Phase 2E.1: Keep displayMode in sync\n\n    if (this.agGridManager) {\n      this.agGridManager.setInputMode(normalized);\n    }\n\n    this._syncGridViews();\n\n    let label = 'Persentase';\n    if (normalized === 'volume') {\n      label = 'Volume';\n    } else if (normalized === 'cost') {\n      label = 'Biaya';\n    }\n    this.showToast(`Mode input diubah ke ${label}`, 'info', 2200);\n  }\n\n  /**\n   * Handle progress mode change (Phase 2E.1: Planned vs Actual)\n   * Phase 0.3: Delegates to StateManager for mode switching\n   * @param {string} mode - 'planned' or 'actual'\n   */\n  _handleProgressModeChange(mode) {\n    const normalized = (mode || '').toLowerCase();\n    const allowed = new Set(['planned', 'actual']);\n\n    if (!allowed.has(normalized) || this.state.progressMode === normalized) {\n      return;\n    }\n\n    const oldMode = this.state.progressMode;\n    console.log(`[ModeChange] Switching progress mode from ${oldMode} to ${normalized}`);\n\n    // Phase 0.3: Get state sizes from StateManager\n    const oldStats = this.stateManager.states[oldMode].getStats();\n\n    // Phase 0.3: Switch mode in StateManager\n    this.stateManager.switchMode(normalized);\n\n    // Switch mode in local state (for other non-cell properties)\n    this.state.progressMode = normalized;\n    if (normalized !== 'actual' && this.state.inputMode === 'cost') {\n      this.state.inputMode = 'percentage';\n      this.state.displayMode = 'percentage';\n      this._syncToolbarRadios();\n    }\n\n    // Log new state after switch\n    const newStats = this.stateManager.states[normalized].getStats();\n    console.log(`[ModeChange] State switch complete:`);\n    console.log(`  - Old ${oldMode.toUpperCase()}: ${oldStats.modifiedCount} modified, ${oldStats.assignmentCount} assignments`);\n    console.log(`  - New ${normalized.toUpperCase()}: ${newStats.modifiedCount} modified, ${newStats.assignmentCount} assignments`);\n\n    // Update mode indicator badge\n    const indicator = document.getElementById('progress-mode-indicator');\n    if (indicator) {\n      const label = normalized === 'planned' ? 'Perencanaan' : 'Realisasi';\n      const bgClass = normalized === 'planned' ? 'bg-info' : 'bg-warning';\n      indicator.textContent = `Mode: ${label}`;\n      indicator.className = `badge ${bgClass} ms-2`;\n      indicator.style.cssText = 'font-size: 0.75rem; vertical-align: middle;';\n    }\n\n    // Reload data with the new progress mode (will load from new mode's state)\n    this._syncGridViews();\n\n    const label = normalized === 'planned' ? 'Perencanaan' : 'Realisasi';\n    this.showToast(`Mode progress diubah ke ${label}`, 'info', 2200);\n  }\n\n  _updateCostToggleAvailability() {\n    const costRadio = document.getElementById('mode-cost');\n    if (!costRadio) {\n      return;\n    }\n    const isActual = (this.state.progressMode || 'planned') === 'actual';\n    costRadio.disabled = !isActual;\n    if (!isActual && costRadio.checked) {\n      const percentageRadio = document.getElementById('mode-percentage');\n      if (percentageRadio) {\n        percentageRadio.checked = true;\n      }\n    }\n  }\n\n  _handleTimeScaleChange(nextScale) {\n    const normalized = (nextScale || '').toLowerCase();\n    const allowed = new Set(['weekly', 'monthly']);\n    if (!allowed.has(normalized)) {\n      this._syncToolbarRadios();\n      this.showToast('Mode waktu ini belum aktif pada fase saat ini', 'warning', 3200);\n      return;\n    }\n\n    if ((this.state.displayScale || this.state.timeScale || 'weekly') === normalized) {\n      this._syncToolbarRadios();\n      return;\n    }\n\n    this.state.displayScale = normalized;\n    this._syncToolbarRadios();\n    this._syncGridViews();\n    this._renderGrid();\n    this._updateCharts();\n\n    if (normalized === 'weekly') {\n      this.showToast('Time scale diatur ke Weekly', 'info', 2000);\n    } else {\n      this.showToast('Time scale diatur ke Monthly (akumulasi 4 minggu, read-only)', 'info', 2600);\n    }\n  }\n\n  /**\n   * Initialize AG Grid when enabled\n   */\n  _initAgGridIfNeeded() {\n    if (!this.state.useAgGrid) {\n      return;\n    }\n\n    const container = this.state.domRefs.agGridContainer;\n    if (!container) {\n      console.warn('[JadwalKegiatanApp] AG Grid container not available');\n      return;\n    }\n\n    if (!this.agGridManager) {\n      this.agGridManager = new AGGridManager(this.state, {\n        showToast: this.showToast.bind(this),\n        onCellChange: (payload) => this._handleAgGridCellChange(payload),\n        getCellValidationState: (cellKey) => this._getCellValidationState(cellKey),\n      });\n      this.agGridManager.mount(container);\n    }\n  }\n\n  /**\n   * Load initial data from server\n   */\n  async _loadInitialData(options = {}) {\n    const { forceReload = false } = options;\n    // Check if data is already loaded (from Django template)\n    if (!forceReload && this.state.pekerjaanTree?.length > 0) {\n      console.log('[JadwalKegiatanApp] Using template dataset');\n      console.log('Preloaded pekerjaanTree items:', this.state.pekerjaanTree.length);\n      console.log('Preloaded tahapanList items:', this.state.tahapanList?.length || 0);\n      console.log('Preloaded timeColumns items:', this.state.timeColumns?.length || 0);\n      this._recalculateAllProgressTotals();\n      this._syncGridViews();\n      return;\n    }\n\n    // Initialize modern modules\n    this.state.apiBase = this.state.apiEndpoints?.tahapan || `/detail_project/api/project/${this.state.projectId}/tahapan/`;\n    this.dataLoader = new DataLoader(this.state);\n    this.timeColumnGenerator = new TimeColumnGenerator(this.state);\n    this.gridRenderer = new GridRenderer(this.state);\n    this.saveHandler = new SaveHandler(this.state, {\n      apiUrl: this.state.apiEndpoints?.save || `/detail_project/api/project/${this.state.projectId}/pekerjaan/assign_weekly/`,\n      onSuccess: (result) => this._onSaveSuccess(result),\n      onError: (error) => this._onSaveError(error),\n      showToast: (msg, type) => this.showToast(msg, type)\n    });\n\n    this.state.isLoading = true;\n\n    try {\n      console.log('[JadwalKegiatanApp] Loading data using modern DataLoader...');\n\n      // Step 1: Load all base data (tahapan, pekerjaan, volumes)\n      await this.dataLoader.loadAllData({ skipIfLoaded: false });\n\n      // Step 2: Generate time columns from loaded tahapan\n      this.timeColumnGenerator.generate();\n      const normalizedDisplayScale = (this.state.displayScale || this.state.timeScale || 'weekly').toLowerCase();\n      if (!this._isEnforcingWeekly && normalizedDisplayScale === 'weekly') {\n        const weeklyCount = this._countWeeklyColumns();\n        const expectedWeeks = this._estimateExpectedWeeklyColumns();\n        const firstColumnMode =\n          (this.state.timeColumns?.[0]?.generationMode || this.state.timeColumns?.[0]?.type || '').toLowerCase();\n\n        const shouldForceWeekly =\n          weeklyCount === 0 ||\n          firstColumnMode === 'monthly' ||\n          (expectedWeeks > 0 && weeklyCount > 0 && weeklyCount < expectedWeeks);\n\n        if (shouldForceWeekly) {\n          console.warn('[JadwalKegiatanApp] Weekly columns incomplete; regenerating weekly structure based on project timeline...');\n          this._isEnforcingWeekly = true;\n          await this._regenerateTimeline({\n            mode: 'weekly',\n            weekStartDay: this._getWeekStartDay(),\n            weekEndDay: this._getWeekEndDay(),\n          });\n          this._isEnforcingWeekly = false;\n          return;\n        }\n      }\n\n      // Step 3: Load assignments (depends on time columns)\n      await this.dataLoader.loadAssignments();\n      this._recalculateAllProgressTotals();\n\n      // Step 3.5: Load Kurva S harga data (Phase 2F.0)\n      await this._loadKurvaSData();\n\n      // Build time column index for quick lookup\n      this.state.timeColumnIndex = this._createTimeColumnIndex(this.state.timeColumns);\n\n      console.log(\n        `[JadwalKegiatanApp] ‚úÖ Data loaded successfully:`,\n        `${this.state.flatPekerjaan?.length || 0} pekerjaan,`,\n        `${this.state.tahapanList?.length || 0} tahapan,`,\n        `${this.state.timeColumns?.length || 0} columns`\n      );\n\n      // Step 4: Render grid\n      this._renderGrid();\n\n      // Step 5: Initialize and update charts\n      this._initializeCharts();\n      this._updateCharts();\n\n    } catch (error) {\n      console.error('[JadwalKegiatanApp] ‚ùå Failed to load data:', error);\n      this.state.error = error;\n      this.showToast('Gagal memuat data: ' + error.message, 'danger');\n    } finally {\n      this.state.isLoading = false;\n      this._syncGridViews();\n    }\n  }\n\n  /**\n   * Load Kurva S harga data from API (Phase 2F.0)\n   *\n   * Loads harga-based data for Kurva S chart instead of volume-based.\n   * This fixes the calculation to use cost (Rupiah) instead of physical volume.\n   *\n   * @private\n   */\n  async _loadKurvaSData() {\n    try {\n      const apiUrl = `/detail_project/api/v2/project/${this.state.projectId}/kurva-s-data/`;\n\n      console.log('[JadwalKegiatanApp] Loading Kurva S harga data from:', apiUrl);\n\n      const response = await fetch(apiUrl, {\n        credentials: 'same-origin',\n        headers: {\n          'X-Requested-With': 'XMLHttpRequest',\n        }\n      });\n\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      const data = await response.json();\n\n      // Store harga data in state\n      this.state.hargaMap = new Map(\n        Object.entries(data.hargaMap || {}).map(([k, v]) => [k, parseFloat(v) || 0])\n      );\n      this.state.totalBiayaProject = parseFloat(data.totalBiayaProject || 0);\n      this.state.pekerjaanMeta = data.pekerjaanMeta || {};\n\n      // Update volumeMap if needed (backward compatibility)\n      if (data.volumeMap && Object.keys(data.volumeMap).length > 0) {\n        const existingSize = this.state.volumeMap?.size || 0;\n        if (existingSize === 0) {\n          this.state.volumeMap = new Map(\n            Object.entries(data.volumeMap).map(([k, v]) => [k, parseFloat(v) || 0])\n          );\n        }\n      }\n\n      console.log('[JadwalKegiatanApp] ‚úÖ Kurva S data loaded:', {\n        hargaCount: this.state.hargaMap.size,\n        totalBiaya: this.state.totalBiayaProject,\n        totalBiayaFormatted: `Rp ${this.state.totalBiayaProject.toLocaleString('id-ID')}`,\n      });\n\n    } catch (error) {\n      console.error('[JadwalKegiatanApp] ‚ö†Ô∏è Failed to load Kurva S data:', error);\n      // Fallback: use empty maps (Kurva S will use fallback calculation)\n      this.state.hargaMap = this.state.hargaMap || new Map();\n      this.state.totalBiayaProject = this.state.totalBiayaProject || 0;\n      this.state.pekerjaanMeta = this.state.pekerjaanMeta || {};\n\n      // Don't show error toast - this is non-critical, Kurva S has fallback\n      console.warn('[JadwalKegiatanApp] Kurva S will use fallback calculation');\n    }\n  }\n\n  /**\n   * Render grid using GridRenderer\n   * @private\n   */\n  _renderGrid() {\n    if (!this.gridRenderer) {\n      console.warn('[JadwalKegiatanApp] GridRenderer not initialized');\n      return;\n    }\n\n    this.state.activeTimeColumns = this._getDisplayTimeColumns();\n\n    console.log('[JadwalKegiatanApp] Rendering grid...');\n\n    // Render tables\n    const rendered = this.gridRenderer.renderTables();\n    if (!rendered) {\n      console.warn('[JadwalKegiatanApp] Grid rendering returned null');\n      return;\n    }\n\n    const { leftHTML, rightHTML } = rendered;\n\n    // Update DOM\n    const leftTbody = this.state.domRefs?.leftTbody || document.getElementById('left-tbody');\n    const rightTbody = this.state.domRefs?.rightTbody || document.getElementById('right-tbody');\n\n    if (leftTbody) {\n      leftTbody.innerHTML = leftHTML;\n    }\n\n    if (rightTbody) {\n      rightTbody.innerHTML = rightHTML;\n    }\n\n    // Render time headers\n    const timeHeaderRow = this.state.domRefs?.timeHeaderRow || document.getElementById('time-header-row');\n    if (timeHeaderRow) {\n      this.gridRenderer.renderTimeHeader(timeHeaderRow);\n    }\n\n    // Sync row heights\n    this.gridRenderer.syncRowHeights(this.state.domRefs || {});\n    this._updateLegacyHorizontalScroll();\n\n    console.log('[JadwalKegiatanApp] ‚úÖ Grid rendered');\n\n    this._updateStatusBar();\n  }\n\n  /**\n   * Initialize chart modules\n   * @private\n   */\n  _initializeCharts() {\n    console.log('[JadwalKegiatanApp] Initializing charts...');\n\n    // Initialize Kurva-S Chart\n    if (this.state.domRefs?.scurveChart) {\n      try {\n        this.kurvaSChart = new KurvaSChart(this.state, {\n          useIdealCurve: true,\n          steepnessFactor: 0.8,\n          smoothCurves: true,\n          showArea: true,\n        });\n        const success = this.kurvaSChart.initialize(this.state.domRefs.scurveChart);\n        if (success) {\n          console.log('[JadwalKegiatanApp] ‚úÖ Kurva-S chart initialized');\n        }\n      } catch (error) {\n        console.warn('[JadwalKegiatanApp] Failed to initialize Kurva-S chart:', error);\n      }\n    }\n\n    // Initialize Gantt Chart\n    if (this.state.domRefs?.ganttChart) {\n      try {\n        this.ganttChart = new GanttChart(this.state, {\n          viewMode: 'Week',\n          enableThemeObserver: true,\n        });\n        const success = this.ganttChart.initialize(this.state.domRefs.ganttChart);\n        if (success) {\n          console.log('[JadwalKegiatanApp] ‚úÖ Gantt chart initialized');\n        }\n      } catch (error) {\n        console.warn('[JadwalKegiatanApp] Failed to initialize Gantt chart:', error);\n      }\n    }\n  }\n\n  /**\n   * Update charts with current data\n   * @private\n   */\n  _updateCharts() {\n    console.log('[JadwalKegiatanApp] Updating charts...');\n\n    // Update Kurva-S Chart\n    if (this.kurvaSChart) {\n      try {\n        this.kurvaSChart.update();\n        console.log('[JadwalKegiatanApp] ‚úÖ Kurva-S chart updated');\n      } catch (error) {\n        console.warn('[JadwalKegiatanApp] Failed to update Kurva-S chart:', error);\n      }\n    }\n\n    // Update Gantt Chart\n    if (this.ganttChart) {\n      try {\n        this.ganttChart.update();\n        console.log('[JadwalKegiatanApp] ‚úÖ Gantt chart updated');\n      } catch (error) {\n        console.warn('[JadwalKegiatanApp] Failed to update Gantt chart:', error);\n      }\n    }\n  }\n\n  /**\n   * Save changes to server (using modern SaveHandler)\n   */\n  async saveChanges() {\n    if (!this.saveHandler) {\n      console.error('[JadwalKegiatanApp] SaveHandler not initialized');\n      return;\n    }\n\n    if (!this._validateRowTotalsBeforeSave()) {\n      return;\n    }\n\n    // Delegate to SaveHandler\n    const result = await this.saveHandler.save();\n\n    // Re-render grid after save\n    if (result.success) {\n      this._renderGrid();\n      this._recalculateAllProgressTotals();\n    }\n  }\n\n  /**\n   * Handle successful save\n   * @param {Object} result - Save result\n   * @private\n   */\n  _onSaveSuccess(result) {\n    console.log('[JadwalKegiatanApp] Save completed successfully');\n    this.state.isDirty = false;\n    this._clearSaveErrorRows();\n\n    // Update status bar if exists\n    this._updateStatusBar('Perubahan tersimpan');\n    this._clearApiFailedRows();\n\n    // Re-render grid to update UI\n    this._renderGrid();\n    this._recalculateAllProgressTotals();\n\n    // Update charts with new data\n    this._updateCharts();\n  }\n\n  /**\n   * Handle save error\n   * @param {Error} error - Error object\n   * @private\n   */\n  _onSaveError(error) {\n    console.error('[JadwalKegiatanApp] Save failed:', error);\n    // Error toast already shown by SaveHandler\n    this._markFailedRowsFromError(error);\n  }\n\n  /**\n   * Refresh data from server\n   */\n  async refresh() {\n    if (this.state.isDirty) {\n      const confirmed = confirm(\n        'Ada perubahan yang belum disimpan. Yakin ingin refresh?'\n      );\n      if (!confirmed) return;\n    }\n\n    console.log('Refreshing data...');\n    this._resetEditedCellsState();\n    this.state.isDirty = false;\n\n    await this._loadInitialData({ forceReload: true });\n    this.showToast('Data berhasil di-refresh', 'success');\n  }\n\n  /**\n   * Show toast notification\n   */\n  showToast(message, type = 'info', duration = 3000) {\n    // Use existing toast system if available\n    if (typeof window.showToast === 'function') {\n      window.showToast(message, type, duration);\n      return;\n    }\n\n    // Fallback toast implementation\n    console.log(`[${type.toUpperCase()}] ${message}`);\n\n    const toast = document.createElement('div');\n    toast.className = `toast toast-${type}`;\n    toast.textContent = message;\n\n    document.body.appendChild(toast);\n\n    setTimeout(() => {\n      toast.classList.add('show');\n    }, 10);\n\n    setTimeout(() => {\n      toast.classList.remove('show');\n      setTimeout(() => toast.remove(), 300);\n    }, duration);\n  }\n\n  /**\n   * Build normalized time columns from tahapan list\n   */\n  _buildTimeColumns(tahapanList = []) {\n    if (!Array.isArray(tahapanList)) {\n      return [];\n    }\n\n    return tahapanList.map((tahap, index) => {\n      const rawId = tahap?.id ?? `tahapan-${index + 1}`;\n      const safeId = String(rawId).replace(/[^a-zA-Z0-9_-]/g, '_');\n      const fieldId = `col_${safeId}`;\n      const label = tahap?.nama || tahap?.name || `Tahapan ${index + 1}`;\n      const order =\n        typeof tahap?.urutan === 'number'\n          ? tahap.urutan\n          : Number.parseInt(tahap?.urutan, 10) || index;\n      const weekNumber = order + 1;\n      return {\n        id: rawId,\n        fieldId,\n        label,\n        order,\n        weekNumber,\n        startDate: tahap?.tanggal_mulai || tahap?.start_date || tahap?.startDate || null,\n        endDate: tahap?.tanggal_selesai || tahap?.end_date || tahap?.endDate || null,\n        isAutoGenerated: Boolean(tahap?.is_auto_generated),\n        generationMode: tahap?.generation_mode || null,\n      };\n    });\n  }\n\n  _createTimeColumnIndex(columns = []) {\n    const index = {};\n    (columns || []).forEach((col) => {\n      const key = col.fieldId || col.id;\n      if (key) {\n        index[key] = col;\n      }\n    });\n    return index;\n  }\n\n  _getDefaultSaveEndpoint() {\n    const projectId = this.state?.projectId;\n    if (!projectId) {\n      return '';\n    }\n    return `/detail_project/api/v2/project/${projectId}/assign-weekly/`;\n  }\n\n  /**\n   * Fetch JSON helper with sane defaults\n   */\n  async _fetchJson(url, options = {}) {\n    if (!url) {\n      throw new Error('URL tidak boleh kosong saat memanggil _fetchJson');\n    }\n\n    const response = await fetch(url, {\n      credentials: 'same-origin',\n      ...options,\n    });\n\n    if (!response.ok) {\n      const errorText = await response.text().catch(() => '');\n      throw new Error(errorText || `HTTP ${response.status}: ${response.statusText}`);\n    }\n\n    return response.json();\n  }\n\n  /**\n   * Sync rendered grids (AG Grid + future legacy bridging)\n   */\n  _syncGridViews() {\n    const displayColumns = this._getDisplayTimeColumns();\n    this.state.activeTimeColumns = displayColumns;\n\n    if (this.agGridManager) {\n      this.agGridManager.updateData({\n        tree: this.state.pekerjaanTree || [],\n        timeColumns: displayColumns,\n        inputMode: this.state.inputMode || 'percentage',\n        timeScale: this.state.displayScale || this.state.timeScale || 'weekly',\n      });\n      if (typeof this.agGridManager.updateTopScrollMetrics === 'function') {\n        this.agGridManager.updateTopScrollMetrics();\n      }\n    }\n    this._updateLegacyHorizontalScroll();\n  }\n\n  _updateLegacyHorizontalScroll() {\n    const domRefs = this.state?.domRefs || {};\n    const scrollTop = domRefs.horizontalScrollTop;\n    const scrollInner = domRefs.horizontalScrollInner;\n    const rightTable = domRefs.rightTable;\n    if (!scrollTop || !scrollInner || !rightTable) {\n      return;\n    }\n    window.requestAnimationFrame(() => {\n      scrollInner.style.width = `${rightTable.scrollWidth}px`;\n    });\n  }\n\n  _clearApiFailedRows() {\n    if (this.state.apiFailedRows instanceof Set && this.state.apiFailedRows.size > 0) {\n      this.state.apiFailedRows.clear();\n      this._refreshFailedRowsUnion();\n    }\n  }\n\n  _markFailedRowsFromIds(idSet) {\n    if (!(idSet instanceof Set) || idSet.size === 0) {\n      this._clearApiFailedRows();\n      return;\n    }\n    this.state.apiFailedRows = new Set(Array.from(idSet));\n    this._refreshFailedRowsUnion();\n  }\n\n  _setSaveErrorRows(idSet) {\n    if (!(this.state.saveErrorRows instanceof Set)) {\n      this.state.saveErrorRows = new Set();\n    }\n    const normalized = idSet instanceof Set ? Array.from(idSet) : [];\n    this.state.saveErrorRows = new Set(normalized.map((id) => Number(id)));\n    if (this.agGridManager && typeof this.agGridManager.refreshRowStyles === 'function') {\n      this.agGridManager.refreshRowStyles();\n    }\n  }\n\n  _clearSaveErrorRows() {\n    if (this.state.saveErrorRows instanceof Set && this.state.saveErrorRows.size > 0) {\n      this.state.saveErrorRows.clear();\n      if (this.agGridManager && typeof this.agGridManager.refreshRowStyles === 'function') {\n        this.agGridManager.refreshRowStyles();\n      }\n    }\n  }\n\n  _clearSaveErrorForRow(pekerjaanId) {\n    if (\n      !pekerjaanId ||\n      !(this.state.saveErrorRows instanceof Set) ||\n      this.state.saveErrorRows.size === 0\n    ) {\n      return;\n    }\n    const removed = this.state.saveErrorRows.delete(Number(pekerjaanId));\n    if (removed && this.agGridManager && typeof this.agGridManager.refreshRowStyles === 'function') {\n      this.agGridManager.refreshRowStyles();\n    }\n  }\n\n  _markFailedRowsFromError(error) {\n    const ids = this._extractPekerjaanIdsFromError(error);\n    this._markFailedRowsFromIds(ids);\n  }\n\n  _extractPekerjaanIdsFromError(error) {\n    const idSet = new Set();\n    const collect = (items = []) => {\n      items.forEach((item) => {\n        const pekerjaanId =\n          item?.pekerjaan_id ||\n          item?.pekerjaanId ||\n          item?.item?.pekerjaan_id ||\n          item?.item?.pekerjaanId ||\n          null;\n        if (pekerjaanId) {\n          idSet.add(Number(pekerjaanId));\n        }\n      });\n    };\n\n    if (Array.isArray(error?.validationErrors)) {\n      collect(error.validationErrors);\n    }\n    if (Array.isArray(error?.details)) {\n      collect(error.details);\n    }\n\n    return idSet;\n  }\n\n  _getContainerValue(container, key) {\n    if (!container || !key) {\n      return null;\n    }\n    if (container instanceof Map) {\n      return container.has(key) ? container.get(key) : null;\n    }\n    if (typeof container === 'object') {\n      return Object.prototype.hasOwnProperty.call(container, key) ? container[key] : null;\n    }\n    return null;\n  }\n\n  _calculateRowTotalPercent(pekerjaanId) {\n    if (!pekerjaanId) {\n      return 0;\n    }\n    const columns = this.state.timeColumns || [];\n    const modifiedCells = this.state.modifiedCells instanceof Map ? this.state.modifiedCells : null;\n    const assignmentMap = this.state.assignmentMap;\n    let total = 0;\n\n    columns.forEach((col) => {\n      const fieldKey = col.fieldId || col.id;\n      if (!fieldKey) {\n        return;\n      }\n      const cellKey = `${pekerjaanId}-${fieldKey}`;\n      let value = null;\n      if (modifiedCells && modifiedCells.has(cellKey)) {\n        value = modifiedCells.get(cellKey);\n      } else {\n        value = this._getContainerValue(assignmentMap, cellKey);\n      }\n      const numeric = Number(value);\n      if (Number.isFinite(numeric)) {\n        total += numeric;\n      }\n    });\n\n    return Number(total.toFixed(2));\n  }\n\n  _calculateRowTotalVolume(pekerjaanId) {\n    if (!pekerjaanId) {\n      return 0;\n    }\n    const kapasitas = this._getRowVolume(pekerjaanId);\n    const columns = Array.isArray(this.state.timeColumns) ? this.state.timeColumns : [];\n    const modifiedCells = this.state.modifiedCells instanceof Map ? this.state.modifiedCells : null;\n    const assignmentMap = this.state.assignmentMap;\n    const overrides = this.state.cellVolumeOverrides instanceof Map ? this.state.cellVolumeOverrides : null;\n\n    let totalVolume = 0;\n    columns.forEach((col) => {\n      const fieldKey = col.fieldId || col.id;\n      if (!fieldKey) {\n        return;\n      }\n      const cellKey = `${pekerjaanId}-${fieldKey}`;\n      let volumeValue = null;\n\n      if (overrides && overrides.has(cellKey)) {\n        const overrideValue = Number(overrides.get(cellKey));\n        if (Number.isFinite(overrideValue)) {\n          volumeValue = overrideValue;\n        }\n      }\n\n      if (volumeValue === null) {\n        let percentValue = null;\n        if (modifiedCells && modifiedCells.has(cellKey)) {\n          percentValue = Number(modifiedCells.get(cellKey));\n        } else if (assignmentMap) {\n          percentValue = Number(this._getContainerValue(assignmentMap, cellKey));\n        }\n\n        if (Number.isFinite(percentValue) && Number.isFinite(kapasitas) && kapasitas > 0) {\n          volumeValue = (percentValue / 100) * kapasitas;\n        }\n      }\n\n      if (Number.isFinite(volumeValue)) {\n        totalVolume += volumeValue;\n      }\n    });\n\n    return Number(totalVolume.toFixed(3));\n  }\n\n  _setCellVolumeOverride(cellKey, volumeValue) {\n    if (!cellKey) {\n      return;\n    }\n    if (!(this.state.cellVolumeOverrides instanceof Map)) {\n      this.state.cellVolumeOverrides = new Map();\n    }\n    const numeric = Number(volumeValue);\n    if (Number.isFinite(numeric)) {\n      this.state.cellVolumeOverrides.set(cellKey, Number(numeric.toFixed(3)));\n    } else if (this.state.cellVolumeOverrides.has(cellKey)) {\n      this.state.cellVolumeOverrides.delete(cellKey);\n    }\n  }\n\n  _clearCellVolumeOverride(cellKey) {\n    if (\n      !cellKey ||\n      !(this.state.cellVolumeOverrides instanceof Map) ||\n      this.state.cellVolumeOverrides.size === 0\n    ) {\n      return;\n    }\n    this.state.cellVolumeOverrides.delete(cellKey);\n  }\n\n  _updateCellValidationState(cellKey, validationResult) {\n    if (!cellKey) {\n      return;\n    }\n    if (!(this.state.cellValidationMap instanceof Map)) {\n      this.state.cellValidationMap = new Map();\n    }\n    const current = this.state.cellValidationMap.get(cellKey) || null;\n    const nextState =\n      validationResult && validationResult.isValid === false\n        ? validationResult.level === 'warning'\n          ? 'warning'\n          : 'error'\n        : null;\n    let changed = false;\n    if (nextState) {\n      if (current !== nextState) {\n        this.state.cellValidationMap.set(cellKey, nextState);\n        changed = true;\n      }\n    } else if (current) {\n      this.state.cellValidationMap.delete(cellKey);\n      changed = true;\n    }\n    if (changed && this.agGridManager && typeof this.agGridManager.refreshCells === 'function') {\n      this.agGridManager.refreshCells();\n    }\n  }\n\n  _getCellValidationState(cellKey) {\n    if (!cellKey || !(this.state.cellValidationMap instanceof Map)) {\n      return null;\n    }\n    return this.state.cellValidationMap.get(cellKey) || null;\n  }\n\n  _updateProgressTotals(pekerjaanId) {\n    if (!pekerjaanId) {\n      return 0;\n    }\n    if (!(this.state.progressTotals instanceof Map)) {\n      this.state.progressTotals = new Map();\n    }\n    const total = this._calculateRowTotalPercent(pekerjaanId);\n    this.state.progressTotals.set(Number(pekerjaanId), total);\n    this._updateAutoWarningRows(Number(pekerjaanId), total);\n    this._updateCompletionWarningRows(Number(pekerjaanId), total);\n    this._updateStatusBar();\n    return total;\n  }\n\n  _updateVolumeTotals(pekerjaanId, percentOverride = null, options = {}) {\n    if (!pekerjaanId) {\n      return;\n    }\n    if (!(this.state.volumeTotals instanceof Map)) {\n      this.state.volumeTotals = new Map();\n    }\n    const totalVolume = this._calculateRowTotalVolume(pekerjaanId);\n    this.state.volumeTotals.set(Number(pekerjaanId), totalVolume);\n\n    const percentTotal =\n      Number.isFinite(percentOverride) && percentOverride !== null\n        ? Number(percentOverride)\n        : this.state.progressTotals instanceof Map\n          ? this.state.progressTotals.get(Number(pekerjaanId))\n          : null;\n\n    const kapasitas = this._getRowVolume(pekerjaanId);\n    const derivedPercent =\n      !Number.isFinite(percentTotal) && Number.isFinite(totalVolume) && Number.isFinite(kapasitas) && kapasitas > 0\n        ? (totalVolume / kapasitas) * 100\n        : percentTotal;\n\n    this._updateVolumeWarningRows(Number(pekerjaanId), totalVolume, {\n      percentTotal: derivedPercent,\n      deferRefresh: options.deferRefresh,\n    });\n  }\n\n  _recalculateAllProgressTotals() {\n    if (!(this.state.progressTotals instanceof Map)) {\n      this.state.progressTotals = new Map();\n    } else {\n      this.state.progressTotals.clear();\n    }\n    if (!(this.state.volumeTotals instanceof Map)) {\n      this.state.volumeTotals = new Map();\n    } else {\n      this.state.volumeTotals.clear();\n    }\n    if (!(this.state.cellVolumeOverrides instanceof Map)) {\n      this.state.cellVolumeOverrides = new Map();\n    } else {\n      this.state.cellVolumeOverrides.clear();\n    }\n    this.state.autoWarningRows = new Set();\n    this.state.volumeWarningRows = new Set();\n    this.state.validationWarningRows = new Set();\n    this.state.saveErrorRows = new Set();\n\n    const pekerjaanNodes = Array.isArray(this.state.flatPekerjaan)\n      ? this.state.flatPekerjaan.filter((node) => node?.type === 'pekerjaan' && node.id)\n      : [];\n\n    pekerjaanNodes.forEach((node) => {\n      const total = this._calculateRowTotalPercent(node.id);\n      this.state.progressTotals.set(Number(node.id), total);\n      this._updateAutoWarningRows(Number(node.id), total, { deferRefresh: true });\n      this._updateCompletionWarningRows(Number(node.id), total, { deferRefresh: true });\n      this._updateVolumeTotals(Number(node.id), total, { deferRefresh: true });\n    });\n\n    this._refreshFailedRowsUnion();\n    if (this.state.showCompletionWarnings && this.agGridManager) {\n      this.agGridManager.refreshRowStyles();\n    }\n    this._updateStatusBar();\n  }\n\n  _refreshFailedRowsUnion() {\n    const union = new Set();\n    if (this.state.autoWarningRows instanceof Set) {\n      this.state.autoWarningRows.forEach((id) => union.add(Number(id)));\n    }\n    if (this.state.volumeWarningRows instanceof Set) {\n      this.state.volumeWarningRows.forEach((id) => union.add(Number(id)));\n    }\n    if (this.state.apiFailedRows instanceof Set) {\n      this.state.apiFailedRows.forEach((id) => union.add(Number(id)));\n    }\n    if (this.state.saveErrorRows instanceof Set) {\n      this.state.saveErrorRows.forEach((id) => union.add(Number(id)));\n    }\n    this.state.failedRows = union;\n    this._updateSaveButtonState();\n    if (this.agGridManager && typeof this.agGridManager.refreshRowStyles === 'function') {\n      this.agGridManager.refreshRowStyles();\n    }\n  }\n\n  _updateAutoWarningRows(pekerjaanId, totalPercent, options = {}) {\n    if (!pekerjaanId) {\n      return;\n    }\n    if (!(this.state.autoWarningRows instanceof Set)) {\n      this.state.autoWarningRows = new Set();\n    }\n    const tolerance = 0.01;\n    let changed = false;\n    if (totalPercent > 100 + tolerance) {\n      if (!this.state.autoWarningRows.has(pekerjaanId)) {\n        this.state.autoWarningRows.add(pekerjaanId);\n        changed = true;\n      }\n    } else if (this.state.autoWarningRows.has(pekerjaanId)) {\n      this.state.autoWarningRows.delete(pekerjaanId);\n      changed = true;\n    }\n\n    if (changed && !options.deferRefresh) {\n      this._refreshFailedRowsUnion();\n    }\n  }\n\n  _updateCompletionWarningRows(pekerjaanId, totalPercent, options = {}) {\n    if (!pekerjaanId) {\n      return;\n    }\n    if (!(this.state.validationWarningRows instanceof Set)) {\n      this.state.validationWarningRows = new Set();\n    }\n    const tolerance = 0.01;\n    const upperBound = 100 - tolerance;\n    const shouldWarn =\n      this.state.showCompletionWarnings &&\n      Number.isFinite(totalPercent) &&\n      totalPercent > tolerance &&\n      totalPercent < upperBound;\n\n    let changed = false;\n    if (shouldWarn) {\n      if (!this.state.validationWarningRows.has(pekerjaanId)) {\n        this.state.validationWarningRows.add(pekerjaanId);\n        changed = true;\n      }\n    } else if (this.state.validationWarningRows.has(pekerjaanId)) {\n      this.state.validationWarningRows.delete(pekerjaanId);\n      changed = true;\n    }\n\n    if (changed && !options.deferRefresh && this.agGridManager) {\n      this.agGridManager.refreshRowStyles();\n    }\n  }\n\n  _recomputeCompletionWarnings() {\n    if (!(this.state.validationWarningRows instanceof Set)) {\n      this.state.validationWarningRows = new Set();\n    } else {\n      this.state.validationWarningRows.clear();\n    }\n    if (!(this.state.progressTotals instanceof Map)) {\n      if (this.agGridManager) {\n        this.agGridManager.refreshRowStyles();\n      }\n      return;\n    }\n    this.state.progressTotals.forEach((total, pekerjaanId) => {\n      this._updateCompletionWarningRows(Number(pekerjaanId), total, { deferRefresh: true });\n    });\n    if (this.agGridManager) {\n      this.agGridManager.refreshRowStyles();\n    }\n  }\n\n  _updateVolumeWarningRows(pekerjaanId, totalVolume, options = {}) {\n    if (!pekerjaanId) {\n      return;\n    }\n    if (!(this.state.volumeWarningRows instanceof Set)) {\n      this.state.volumeWarningRows = new Set();\n    }\n\n    const capacity = this._getRowVolume(pekerjaanId);\n    const percentReference =\n      options && Number.isFinite(options.percentTotal)\n        ? Number(options.percentTotal)\n        : this.state.progressTotals instanceof Map\n          ? this.state.progressTotals.get(Number(pekerjaanId))\n          : null;\n\n    const tolerance = Number.isFinite(capacity) && capacity > 0 ? Math.max(capacity * 0.001, 0.01) : 0.01;\n    let shouldWarn = false;\n    if (Number.isFinite(capacity) && capacity > 0) {\n      shouldWarn = Number.isFinite(totalVolume) && totalVolume > capacity + tolerance;\n    } else if (Number.isFinite(percentReference)) {\n      shouldWarn = percentReference > tolerance;\n    }\n\n    let changed = false;\n    if (shouldWarn) {\n      if (!this.state.volumeWarningRows.has(pekerjaanId)) {\n        this.state.volumeWarningRows.add(pekerjaanId);\n        changed = true;\n      }\n    } else if (this.state.volumeWarningRows.has(pekerjaanId)) {\n      this.state.volumeWarningRows.delete(pekerjaanId);\n      changed = true;\n    }\n\n    if (changed && !options.deferRefresh) {\n      this._refreshFailedRowsUnion();\n    }\n  }\n\n  _clearFailedRows() {\n    if (this.state.autoWarningRows instanceof Set) {\n      this.state.autoWarningRows.clear();\n    }\n    if (this.state.volumeWarningRows instanceof Set) {\n      this.state.volumeWarningRows.clear();\n    }\n    if (this.state.failedRows instanceof Set) {\n      this.state.failedRows.clear();\n    }\n    if (this.state.saveErrorRows instanceof Set) {\n      this.state.saveErrorRows.clear();\n    }\n    this._refreshFailedRowsUnion();\n  }\n\n  _getRowVolume(pekerjaanId) {\n    const volumeMap = this.state?.volumeMap;\n    const numericId = Number(pekerjaanId);\n    if (volumeMap instanceof Map && volumeMap.has(numericId)) {\n      return Number(volumeMap.get(numericId)) || 0;\n    }\n    if (volumeMap && typeof volumeMap === 'object') {\n      const key = String(numericId);\n      if (Object.prototype.hasOwnProperty.call(volumeMap, key)) {\n        return Number(volumeMap[key]) || 0;\n      }\n    }\n    const fallbackNode =\n      Array.isArray(this.state.flatPekerjaan) &&\n      this.state.flatPekerjaan.find((node) => Number(node.id) === numericId);\n    if (fallbackNode && typeof fallbackNode.volume !== 'undefined') {\n      return Number(fallbackNode.volume) || 0;\n    }\n    return 0;\n  }\n\n  _validateRowTotalsBeforeSave() {\n    if (!(this.state.progressTotals instanceof Map)) {\n      return true;\n    }\n    if (!this.state.showCompletionWarnings) {\n      this.state.showCompletionWarnings = true;\n    }\n    this._recomputeCompletionWarnings();\n    const percentTolerance = 0.01;\n    const percentViolations = [];\n\n    this.state.progressTotals.forEach((totalPercent, pekerjaanId) => {\n      if (!Number.isFinite(totalPercent)) {\n        return;\n      }\n      if (totalPercent > 100 + percentTolerance) {\n        percentViolations.push({\n          type: 'percent',\n          pekerjaan_id: pekerjaanId,\n          total: totalPercent,\n        });\n      }\n    });\n\n    const volumeViolations = [];\n    if (this.state.volumeTotals instanceof Map) {\n      this.state.volumeTotals.forEach((totalVolume, pekerjaanId) => {\n        const capacity = this._getRowVolume(pekerjaanId);\n        const volumeTolerance = Number.isFinite(capacity) && capacity > 0 ? Math.max(capacity * 0.001, 0.01) : 0.01;\n        const percentTotal =\n          this.state.progressTotals instanceof Map && this.state.progressTotals.has(pekerjaanId)\n            ? this.state.progressTotals.get(pekerjaanId)\n            : null;\n        const effectivePercent =\n          Number.isFinite(percentTotal) && percentTotal !== null\n            ? Number(percentTotal)\n            : Number.isFinite(totalVolume) && Number.isFinite(capacity) && capacity > 0\n              ? (Number(totalVolume) / Number(capacity)) * 100\n              : null;\n        if (Number.isFinite(capacity) && capacity > 0) {\n          if (Number.isFinite(totalVolume) && totalVolume > capacity + volumeTolerance) {\n            volumeViolations.push({\n              type: 'volume',\n              pekerjaan_id: pekerjaanId,\n              total: totalVolume,\n              capacity,\n            });\n          }\n        } else {\n          if (Number.isFinite(effectivePercent) && effectivePercent > volumeTolerance) {\n            volumeViolations.push({\n              type: 'volume',\n              pekerjaan_id: pekerjaanId,\n              total: totalVolume,\n              capacity: capacity || 0,\n              missingCapacity: true,\n            });\n          }\n        }\n      });\n    }\n\n    if (percentViolations.length === 0 && volumeViolations.length === 0) {\n      this._clearFailedRows();\n      this._clearSaveErrorRows();\n      return true;\n    }\n\n    const ids = new Set();\n    const combined = percentViolations.concat(volumeViolations);\n    const messages = combined.slice(0, 3).map((item) => {\n      ids.add(Number(item.pekerjaan_id));\n      if (item.type === 'volume') {\n        if (item.missingCapacity) {\n          return `- Pekerjaan ${item.pekerjaan_id}: volume tidak dapat disimpan karena master volume 0`;\n        }\n        return `- Pekerjaan ${item.pekerjaan_id}: total volume ${item.total.toFixed(3)} > kapasitas ${item.capacity.toFixed(3)}`;\n      }\n      return `- Pekerjaan ${item.pekerjaan_id}: total ${item.total.toFixed(2)}% > 100%`;\n    });\n\n    if (combined.length > 3) {\n      messages.push(`(+${combined.length - 3} lagi)`);\n    }\n\n    this._markFailedRowsFromIds(ids);\n    this._setSaveErrorRows(ids);\n    this.showToast(`Tidak dapat menyimpan:\\n${messages.join('\\n')}`, 'danger', 5000);\n    return false;\n  }\n\n  _updateStatusBar(message = 'Ready') {\n    const domRefs = this.state?.domRefs || {};\n    const hasElements =\n      domRefs.statusMessageEl || domRefs.itemCountEl || domRefs.modifiedCountEl || domRefs.totalProgressEl;\n    if (!hasElements) {\n      return;\n    }\n\n    if (domRefs.statusMessageEl && typeof message === 'string') {\n      domRefs.statusMessageEl.textContent = message;\n    }\n\n    if (domRefs.itemCountEl) {\n      const pekerjaanCount = Array.isArray(this.state?.flatPekerjaan)\n        ? this.state.flatPekerjaan.filter((node) => node?.type === 'pekerjaan').length\n        : 0;\n      domRefs.itemCountEl.textContent = pekerjaanCount.toLocaleString('id-ID');\n    }\n\n    if (domRefs.modifiedCountEl) {\n      const modifiedCount = this.state?.modifiedCells instanceof Map ? this.state.modifiedCells.size : 0;\n      domRefs.modifiedCountEl.textContent = modifiedCount.toLocaleString('id-ID');\n    }\n\n    if (domRefs.totalProgressEl) {\n      const totalProgress = this._calculateProjectProgress();\n      domRefs.totalProgressEl.textContent =\n        totalProgress === null\n          ? '-'\n          : `${totalProgress.toLocaleString('id-ID', { maximumFractionDigits: 1 })}%`;\n    }\n  }\n\n  _calculateProjectProgress() {\n    if (this.state?.progressTotals instanceof Map && this.state.progressTotals.size > 0) {\n      let aggregate = 0;\n      this.state.progressTotals.forEach((value) => {\n        aggregate += Number(value) || 0;\n      });\n      const avg = aggregate / this.state.progressTotals.size;\n      return Math.round(avg * 10) / 10;\n    }\n\n    if (this.state?.assignmentMap instanceof Map && this.state.assignmentMap.size > 0) {\n      const pekerjaanTotals = new Map();\n      this.state.assignmentMap.forEach((value, cellKey) => {\n        const [pekerjaanId] = `${cellKey}`.split('-');\n        const numericValue = Number(value) || 0;\n        const current = pekerjaanTotals.get(pekerjaanId) || 0;\n        pekerjaanTotals.set(pekerjaanId, current + numericValue);\n      });\n\n      if (pekerjaanTotals.size > 0) {\n        let sum = 0;\n        pekerjaanTotals.forEach((value) => {\n          sum += value;\n        });\n        const avg = sum / pekerjaanTotals.size;\n        return Math.round(avg * 10) / 10;\n      }\n    }\n\n    return null;\n  }\n\n  _buildAssignmentsPayload() {\n    if (!this.state.modifiedCells || this.state.modifiedCells.size === 0) {\n      return [];\n    }\n\n    const assignments = [];\n    const columnIndex = this.state.timeColumnIndex || {};\n\n    this.state.modifiedCells.forEach((value, cellKey) => {\n      const parsed = this._parseCellKey(cellKey);\n      if (!parsed?.pekerjaanId || !parsed.fieldId) {\n        return;\n      }\n\n      const columnMeta = columnIndex[parsed.fieldId];\n      if (!columnMeta) {\n        console.warn('[JadwalKegiatanApp] Column metadata not found for', parsed.fieldId);\n        return;\n      }\n\n      const proportion = parseFloat(value);\n      if (Number.isNaN(proportion)) {\n        return;\n      }\n\n      const weekNumber = columnMeta.weekNumber || columnMeta.order + 1 || 1;\n\n      assignments.push({\n        pekerjaan_id: Number(parsed.pekerjaanId),\n        week_number: weekNumber,\n        proportion: Number(proportion.toFixed(2)),\n        tahapan_id: columnMeta.id || null,\n      });\n    });\n\n    return assignments;\n  }\n\n  _getSaveMode() {\n    const normalized = (this.state?.saveMode || 'weekly').toLowerCase();\n    const allowed = new Set(['daily', 'weekly', 'monthly', 'custom']);\n    return allowed.has(normalized) ? normalized : 'weekly';\n  }\n\n  _normalizePythonWeekday(value, fallback = 0) {\n    const fallbackSafe = Number.isFinite(fallback) ? ((fallback % 7) + 7) % 7 : 0;\n    const parsed = Number(value);\n    if (!Number.isFinite(parsed)) {\n      return fallbackSafe;\n    }\n    const normalized = parsed % 7;\n    return normalized < 0 ? normalized + 7 : normalized;\n  }\n\n  _getWeekStartDay() {\n    if (Number.isFinite(Number(this.state?.weekStartDay))) {\n      return this._normalizePythonWeekday(this.state.weekStartDay, (this._getWeekEndDay() + 1) % 7);\n    }\n    return (this._getWeekEndDay() + 1) % 7;\n  }\n\n  _getWeekEndDay() {\n    return this._normalizePythonWeekday(this.state?.weekEndDay, 6);\n  }\n\n  _getDisplayTimeColumns() {\n    const baseColumns = Array.isArray(this.state.timeColumns) ? this.state.timeColumns : [];\n    const scale = (this.state.displayScale || this.state.timeScale || 'weekly').toLowerCase();\n    if (scale !== 'monthly') {\n      return baseColumns;\n    }\n\n    const isWeeklyColumn = (col) => {\n      const mode = (col.generationMode || col.type || '').toLowerCase();\n      if (mode === 'monthly') {\n        return false;\n      }\n      if (mode === 'weekly' || mode === 'week' || mode === 'wk') {\n        return true;\n      }\n      if (Number.isFinite(Number(col.weekNumber ?? col.week_number))) {\n        return true;\n      }\n      const label = (col.label || '').toLowerCase();\n      return label.includes('week') || label.includes('minggu');\n    };\n\n    const weeklyColumns = baseColumns.filter((col) => isWeeklyColumn(col));\n    const sourceColumns = weeklyColumns.length > 0 ? weeklyColumns : baseColumns;\n\n    const blockSize = 4;\n    const aggregated = [];\n    for (let i = 0; i < sourceColumns.length; i += blockSize) {\n      const blockColumns = sourceColumns.slice(i, i + blockSize);\n      if (!blockColumns.length) {\n        continue;\n      }\n      const blockIndex = aggregated.length;\n      const startWeek = blockColumns[0]?.weekNumber ?? blockColumns[0]?.order ?? i + 1;\n      const endWeek = blockColumns[blockColumns.length - 1]?.weekNumber ?? startWeek + blockColumns.length - 1;\n      const startLabel = blockColumns[0]?.rangeLabel || blockColumns[0]?.label || '';\n      const endLabel = blockColumns[blockColumns.length - 1]?.rangeLabel || blockColumns[blockColumns.length - 1]?.label || '';\n      const label = `Month ${blockIndex + 1}`;\n      const rangeLabel = `Week ${startWeek}-${endWeek}`;\n\n      aggregated.push({\n        id: `month-${blockIndex + 1}`,\n        fieldId: `month_${blockIndex + 1}`,\n        label,\n        rangeLabel,\n        tooltip: startLabel && endLabel ? `${startLabel} ‚Üí ${endLabel}` : `${label}: Week ${startWeek}-${endWeek}`,\n        generationMode: 'monthly',\n        type: 'monthly',\n        index: blockIndex,\n        childColumns: blockColumns,\n      });\n    }\n\n    return aggregated;\n  }\n\n  _parseCellKey(cellKey) {\n    if (!cellKey || typeof cellKey !== 'string') {\n      return null;\n    }\n    const separatorIndex = cellKey.indexOf('-');\n    if (separatorIndex === -1) {\n      return { pekerjaanId: cellKey, fieldId: null };\n    }\n\n    return {\n      pekerjaanId: cellKey.slice(0, separatorIndex),\n      fieldId: cellKey.slice(separatorIndex + 1),\n    };\n  }\n\n  /**\n   * Get CSRF token from cookie\n   */\n  _getCsrfToken() {\n    const name = 'csrftoken';\n    let cookieValue = null;\n\n    if (document.cookie && document.cookie !== '') {\n      const cookies = document.cookie.split(';');\n      for (let i = 0; i < cookies.length; i++) {\n        const cookie = cookies[i].trim();\n        if (cookie.substring(0, name.length + 1) === name + '=') {\n          cookieValue = decodeURIComponent(cookie.substring(name.length + 1));\n          break;\n        }\n      }\n    }\n\n    return cookieValue;\n  }\n\n  /**\n   * Handle AG Grid cell change\n   */\n  _handleAgGridCellChange({\n    cellKey,\n    value,\n    columnMeta,\n    displayValue,\n    isVolumeMode,\n    validation,\n    pekerjaanId,\n    columnId,\n    valueType = 'percentage',\n  }) {\n    if (!cellKey) {\n      return;\n    }\n\n    if (validation) {\n      this._updateCellValidationState(cellKey, validation);\n    }\n\n    let normalizedValue = value;\n    if (typeof normalizedValue === 'string') {\n      normalizedValue = parseFloat(normalizedValue);\n    }\n    if (Number.isNaN(normalizedValue)) {\n      normalizedValue = 0;\n    }\n\n    // Phase 2E.1: Get current mode's state for isolated data tracking\n    const modeState = this._getCurrentModeState();\n    const progressMode = this.state.progressMode || 'planned';\n    const normalizedValueType = (valueType || (isVolumeMode ? 'volume' : 'percentage')).toLowerCase();\n    const isCostMode = normalizedValueType === 'cost';\n\n    console.log(`[CellChange] Mode: ${progressMode.toUpperCase()}, Cell: ${cellKey}, Value: ${normalizedValue}`);\n\n    if (isCostMode) {\n      if (progressMode !== 'actual') {\n        this.showToast('Biaya aktual hanya bisa diedit pada mode Realisasi', 'warning', 2600);\n        return;\n      }\n      modeState.costModifiedCells.set(cellKey, normalizedValue);\n      modeState.isDirty = true;\n    } else {\n      // Write to mode-specific state (isolated from other mode)\n      modeState.modifiedCells.set(cellKey, normalizedValue);\n      modeState.isDirty = true;\n    }\n\n    if (columnMeta?.fieldId && this.state.timeColumnIndex) {\n      this.state.timeColumnIndex[columnMeta.fieldId] =\n        columnMeta || this.state.timeColumnIndex[columnMeta.fieldId];\n    }\n\n    if (isVolumeMode) {\n      this._setCellVolumeOverride(cellKey, displayValue);\n    } else {\n      this._clearCellVolumeOverride(cellKey);\n    }\n\n    const parsed = this._parseCellKey(cellKey);\n    const resolvedPekerjaanId = pekerjaanId || parsed?.pekerjaanId;\n    if (resolvedPekerjaanId) {\n      this._clearSaveErrorForRow(Number(resolvedPekerjaanId));\n      const percentTotal = this._updateProgressTotals(Number(resolvedPekerjaanId));\n      this._updateVolumeTotals(Number(resolvedPekerjaanId), percentTotal);\n    }\n\n    if (!isCostMode) {\n      console.log(`[CellChange] ${progressMode.toUpperCase()} modifiedCells size: ${modeState.modifiedCells.size}`);\n      // Phase 2F.0: Real-time Kurva S update on cell change (before save)\n      // This allows users to see chart changes immediately as they type\n      this._updateCharts();\n      console.log(`[CellChange] Real-time Kurva-S chart updated`);\n    } else {\n      console.log(`[CellChange] Cost map size: ${modeState.costModifiedCells.size}`);\n    }\n  }\n\n  /**\n   * Cleanup and destroy the application\n   */\n  destroy() {\n    if (this.eventManager) {\n      this.eventManager.cleanup();\n      this.eventManager = null;\n    }\n\n    if (this.agGridManager) {\n      this.agGridManager.destroy();\n      this.agGridManager = null;\n    }\n\n    this.state = null;\n    this.initialized = false;\n\n    console.log('JadwalKegiatanApp destroyed');\n  }\n}\n\n// Auto-initialize when DOM is ready\nif (document.readyState === 'loading') {\n  document.addEventListener('DOMContentLoaded', () => {\n    const app = new JadwalKegiatanApp();\n    app.initialize();\n  });\n} else {\n  // DOM already loaded\n  const app = new JadwalKegiatanApp();\n  app.initialize();\n}\n\n// Export for manual initialization\nexport default JadwalKegiatanApp;\n"],"names":["JadwalKegiatanApp","constructor","this","state","eventManager","initialized","agGridManager","stateManager","StateManager","getInstance","dataLoader","timeColumnGenerator","gridRenderer","saveHandler","kurvaSChart","ganttChart","_weekBoundarySaveTimer","_pendingWeekBoundary","_isRegeneratingTimeline","_queuedRegeneratePayload","_isEnforcingWeekly","_exportManagerInstance","_exportBindingsAttached","_getProjectDateRange","start","end","_a","projectStart","parsed","Date","Number","isNaN","getTime","_b","projectEnd","parsedEnd","getFullYear","_estimateExpectedWeeklyColumns","diffDays","Math","max","floor","ceil","_countWeeklyColumns","Array","isArray","timeColumns","filter","col","mode","generationMode","type","toLowerCase","isFinite","weekNumber","week_number","length","initialize","__async","arguments","config","console","warn","log","_setupState","_setupDomRefs","_attachEvents","_loadInitialData","window","error","existingState","kelolaTahapanPageState","JadwalPekerjaanApp","Object","assign","pekerjaanTree","tahapanList","timeColumnIndex","expandedNodes","Set","volumeMap","Map","isLoading","domRefs","apiEndpoints","projectId","projectName","useAgGrid","timeScale","inputMode","saveMode","weekStartDay","weekEndDay","displayScale","progressMode","displayMode","plannedState","progressTotals","volumeTotals","cellVolumeOverrides","cellValidationMap","failedRows","autoWarningRows","volumeWarningRows","validationWarningRows","saveErrorRows","apiFailedRows","showCompletionWarnings","isDirty","actualState","initialState","_createTimeColumnIndex","_ensureStateCollections","_setupStateDelegation","getCurrentState","defineProperty","get","states","modifiedCells","configurable","assignmentMap","costAssignmentMap","costModifiedCells","hasUnsavedChanges","set","value","_getCurrentModeState","_updateSaveButtonState","saveButton","hasFailures","_c","size","disabled","classList","toggle","Boolean","setAttribute","removeAttribute","root","document","getElementById","leftThead","rightThead","leftTbody","rightTbody","leftPanelScroll","querySelector","rightPanelScroll","rightTable","horizontalScrollTop","horizontalScrollInner","timeHeaderRow","refreshButton","resetButton","agGridContainer","agGridTopScroll","agGridTopScrollInner","scurveChart","statusBar","statusMessageEl","itemCountEl","modifiedCountEl","totalProgressEl","weekStartSelect","weekEndSelect","Error","_applyDataset","rootElement","dataset","allowedTimeScales","datasetScale","defaultTimeScale","toString","has","datasetInputMode","defaultInputMode","allowedInputModes","parsedWeekEndDay","parseInt","_d","weekend","weekEnd","week_end_day","parsedWeekStartDay","_f","_e","week_start_day","normalized","endpoints","base","apiBase","tahapan","apiTahapan","listPekerjaan","apiListPekerjaan","volume","apiVolume","assignmentsBase","apiAssignmentsBase","save","apiSave","_getDefaultSaveEndpoint","weekBoundary","apiWeekBoundary","regenerateTahapan","apiRegenerateTahapan","reset","apiResetProgress","enableAgGrid","helpers","updateProgressIndicator","pekerjaanId","total","showToast","bind","cleanup","attachGridEvents","_attachToolbarEvents","_initAgGridIfNeeded","addEventListener","saveChanges","refresh","_handleResetProgress","_syncToolbarRadios","_attachRadioGroupHandler","_handleDisplayModeChange","_handleProgressModeChange","_handleTimeScaleChange","_setupWeekBoundaryControls","_setupExportButtons","_setupCostViewToggle","ExportManager","forEach","format","button","exportAs","toggleBtn","toggleBtnText","toggleBtnSpinner","remove","toggleView","viewMode","textContent","innerHTML","add","groupName","handler","radios","querySelectorAll","radio","event","target","checked","_syncWeekBoundaryControls","nextStart","_normalizePythonWeekday","_getWeekStartDay","derivedEnd","_handleWeekBoundaryChange","source","nextEnd","_getWeekEndDay","derivedStart","endpoint","modeLabel","confirm","_updateStatusBar","response","fetch","method","credentials","headers","_getCsrfToken","body","JSON","stringify","ok","text","catch","status","result","json","_resetEditedCellsState","clear","_clearFailedRows","message","forceReload","String","normalizedEnd","normalizedStart","label","_formatWeekdayLabel","prefix","_regenerateColumnsForWeekBoundary","_persistWeekBoundarySettings","TimeColumnGenerator","generate","_syncGridViews","_recalculateAllProgressTotals","_invalidateCachedDataset","flatPekerjaan","clearTimeout","setTimeout","payload","then","data","resolvedStart","resolvedEnd","_regenerateTimeline","options","statusLabel","toastLabel","__spreadValues","successMessage","next","pyDay","_updateCostToggleAvailability","setInputMode","oldMode","oldStats","getStats","switchMode","newStats","toUpperCase","modifiedCount","assignmentCount","indicator","bgClass","className","style","cssText","costRadio","isActual","percentageRadio","nextScale","_renderGrid","_updateCharts","container","AGGridManager","onCellChange","_handleAgGridCellChange","getCellValidationState","cellKey","_getCellValidationState","mount","DataLoader","GridRenderer","SaveHandler","apiUrl","onSuccess","_onSaveSuccess","onError","_onSaveError","msg","loadAllData","skipIfLoaded","normalizedDisplayScale","weeklyCount","expectedWeeks","firstColumnMode","_g","_i","_h","loadAssignments","_loadKurvaSData","_j","_k","_l","_initializeCharts","statusText","hargaMap","entries","map","k","v","parseFloat","totalBiayaProject","pekerjaanMeta","keys","hargaCount","totalBiaya","totalBiayaFormatted","toLocaleString","activeTimeColumns","_getDisplayTimeColumns","rendered","renderTables","leftHTML","rightHTML","renderTimeHeader","syncRowHeights","_updateLegacyHorizontalScroll","KurvaSChart","useIdealCurve","steepnessFactor","smoothCurves","showArea","GanttChart","enableThemeObserver","update","_validateRowTotalsBeforeSave","success","_clearSaveErrorRows","_clearApiFailedRows","_markFailedRowsFromError","duration","toast","createElement","appendChild","_buildTimeColumns","tahap","index","rawId","id","fieldId","replace","nama","name","order","urutan","startDate","tanggal_mulai","start_date","endDate","tanggal_selesai","end_date","isAutoGenerated","is_auto_generated","generation_mode","columns","key","_fetchJson","_0","url","errorText","displayColumns","updateData","tree","updateTopScrollMetrics","scrollTop","scrollInner","requestAnimationFrame","width","scrollWidth","_refreshFailedRowsUnion","_markFailedRowsFromIds","idSet","from","_setSaveErrorRows","refreshRowStyles","_clearSaveErrorForRow","delete","ids","_extractPekerjaanIdsFromError","collect","items","item","pekerjaan_id","validationErrors","details","_getContainerValue","prototype","hasOwnProperty","call","_calculateRowTotalPercent","fieldKey","numeric","toFixed","_calculateRowTotalVolume","kapasitas","_getRowVolume","overrides","totalVolume","volumeValue","overrideValue","percentValue","_setCellVolumeOverride","_clearCellVolumeOverride","_updateCellValidationState","validationResult","current","nextState","isValid","level","changed","refreshCells","_updateProgressTotals","_updateAutoWarningRows","_updateCompletionWarningRows","_updateVolumeTotals","percentOverride","percentTotal","derivedPercent","_updateVolumeWarningRows","deferRefresh","node","union","totalPercent","_recomputeCompletionWarnings","capacity","percentReference","tolerance","shouldWarn","numericId","fallbackNode","find","percentViolations","push","volumeViolations","volumeTolerance","effectivePercent","missingCapacity","combined","concat","messages","slice","join","pekerjaanCount","totalProgress","_calculateProjectProgress","maximumFractionDigits","aggregate","avg","round","pekerjaanTotals","split","numericValue","sum","_buildAssignmentsPayload","assignments","columnIndex","_parseCellKey","columnMeta","proportion","tahapan_id","_getSaveMode","fallback","fallbackSafe","baseColumns","weeklyColumns","includes","isWeeklyColumn","sourceColumns","aggregated","i","blockColumns","blockIndex","startWeek","endWeek","startLabel","rangeLabel","endLabel","tooltip","childColumns","separatorIndex","indexOf","cookieValue","cookie","cookies","trim","substring","decodeURIComponent","displayValue","isVolumeMode","validation","columnId","valueType","normalizedValue","modeState","isCostMode","resolvedPekerjaanId","destroy","readyState"],"mappings":"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"}