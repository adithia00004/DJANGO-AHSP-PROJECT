var t=Object.defineProperty,e=Object.defineProperties,l=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,a=Math.pow,o=(e,l,n)=>l in e?t(e,l,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[l]=n,r=(t,e)=>{for(var l in e||(e={}))i.call(e,l)&&o(t,l,e[l]);if(n)for(var l of n(e))s.call(e,l)&&o(t,l,e[l]);return t},u=(t,n)=>e(t,l(n)),c=(t,e,l)=>new Promise((n,i)=>{var s=t=>{try{o(l.next(t))}catch(e){i(e)}},a=t=>{try{o(l.throw(t))}catch(e){i(e)}},o=t=>t.done?n(t.value):Promise.resolve(t.value).then(s,a);o((l=l.apply(t,e)).next())});import"./core-modules-mQGIJkxg.js";function h(t){try{const e=document.documentElement,l=getComputedStyle(e).getPropertyValue(t);return l&&l.trim().length?l.trim():null}catch(e){return null}}function d(t){var e,l,n;try{const i=document.querySelector(t);if(!i)return null;const s=getComputedStyle(i);return(null==(e=s.getPropertyValue("background-color"))?void 0:e.trim())||(null==(l=s.getPropertyValue("border-color"))?void 0:l.trim())||(null==(n=s.getPropertyValue("color"))?void 0:n.trim())||null}catch(i){return null}}class f{constructor(t={}){var e;this.tooltip=null,this.zIndex=null!=(e=t.zIndex)?e:50}ensureTooltip(){return this.tooltip||(this.tooltip=document.createElement("div"),this.tooltip.className="kurva-s-tooltip",this.tooltip.style.cssText=`\n      position: fixed;\n      padding: 8px 12px;\n      background: rgba(17, 24, 39, 0.95);\n      color: #f8fafc;\n      border-radius: 6px;\n      font-size: 12px;\n      pointer-events: none;\n      z-index: ${this.zIndex};\n      display: none;\n      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n      line-height: 1.5;\n    `,document.body.appendChild(this.tooltip)),this.tooltip}show(t,e,l){const n=this.ensureTooltip(),i=l.weekNumber?`Week ${l.weekNumber}`:l.columnId,s=Number.isFinite(l.progress)?`${l.progress.toFixed(1)}%`:"-",a=Number.isFinite(l.weekProgress)?`${l.weekProgress.toFixed(1)}%`:"-";n.innerHTML=`\n      <div style="font-weight: 600; margin-bottom: 4px; color: ${l.color};">${l.label}</div>\n      <div><strong>${i}</strong></div>\n      <div>Cumulative: ${s}</div>\n      <div>Week Progress: ${a}</div>\n    `,n.style.left=`${t+12}px`,n.style.top=`${e+12}px`,n.style.display="block"}hide(){this.tooltip&&(this.tooltip.style.display="none")}destroy(){this.tooltip&&(this.tooltip.remove(),this.tooltip=null)}}class p{constructor(t){var e,l,n,i,s;this.tableManager=t,this.debug=Boolean((null==(l=null==(e=this.tableManager)?void 0:e.options)?void 0:l.debugUnifiedTable)||(null==(i=null==(n=this.tableManager)?void 0:n.state)?void 0:i.debugUnifiedTable)||window.DEBUG_UNIFIED_TABLE),this.canvas=document.createElement("canvas"),this.canvas.className="gantt-canvas-overlay",this.canvas.style.cssText="\n      position: absolute;\n      top: 0;\n      left: 0;\n      pointer-events: auto;\n    ",this.ctx=this.canvas.getContext("2d"),this.clipViewport=document.createElement("div"),this.clipViewport.className="gantt-clip-viewport",this.clipViewport.style.cssText="\n      position: absolute;\n      overflow: hidden;\n      pointer-events: none;\n      z-index: 1;\n    ",this.canvas.style.pointerEvents="auto",this.clipViewport.appendChild(this.canvas),this.visible=!1,this.barData=[],this.dependencies=[],this.barRects=[],this.tooltipManager=new f({zIndex:20}),this.pinnedWidth=0,this.scrollLeft=0,this.scrollTop=0,this.lastDrawMetrics={barsDrawn:0,barsSkipped:0};const a=null==(s=this.tableManager)?void 0:s.bodyScroll;a&&(a.addEventListener("scroll",()=>{this.visible&&this._updateTransform()},{passive:!0}),a.addEventListener("wheel",t=>{const{scrollTop:e,scrollHeight:l,clientHeight:n,scrollLeft:i,scrollWidth:s,clientWidth:o}=a,r=e<=0,u=e+n>=l,c=i<=0,h=i+o>=s,d=t.deltaY<0,f=t.deltaY>0,p=t.deltaX<0,m=t.deltaX>0;r&&d&&Math.abs(t.deltaY)>Math.abs(t.deltaX)||u&&f&&Math.abs(t.deltaY)>Math.abs(t.deltaX)||c&&p&&Math.abs(t.deltaX)>Math.abs(t.deltaY)||h&&m&&Math.abs(t.deltaX)>Math.abs(t.deltaY)||t.stopPropagation()},{passive:!0})),this.canvas.addEventListener("wheel",t=>{var e;const l=null==(e=this.tableManager)?void 0:e.bodyScroll;l&&(l.scrollLeft+=t.deltaX,l.scrollTop+=t.deltaY,t.preventDefault(),t.stopPropagation())},{passive:!1}),this._bindPointerEvents()}show(){var t;if(this.visible)return;const e=null==(t=this.tableManager)?void 0:t.bodyScroll;if(!e)return;e.style.position=e.style.position||"relative";const l=e.parentElement;l&&!this.clipViewport.parentNode&&l.appendChild(this.clipViewport),this._updatePinnedClip(),this.visible=!0,this._log("show",{clipping:!0,container:"sibling-of-bodyScroll"}),this.syncWithTable()}hide(){this.visible&&(this.clipViewport.parentNode&&this.clipViewport.parentNode.removeChild(this.clipViewport),this.visible=!1,this._log("hide"),this.tooltipManager.hide())}_updateTransform(){var t;const e=null==(t=this.tableManager)?void 0:t.bodyScroll;e&&(this.scrollLeft=e.scrollLeft||0,this.scrollTop=e.scrollTop||0,this.canvas.style.transform=`translate(${-this.scrollLeft}px, ${-this.scrollTop}px)`)}syncWithTable(){var t;const e=null==(t=this.tableManager)?void 0:t.bodyScroll,l=null==e?void 0:e.parentElement;if(!e||!l)return;this._updatePinnedClip(),this.scrollLeft=e.scrollLeft||0,this.scrollTop=e.scrollTop||0;const n=l.querySelector(".tanstack-grid-header"),i=(null==n?void 0:n.offsetHeight)||0,s=l.getBoundingClientRect(),a=e.getBoundingClientRect(),o=s.width-this.pinnedWidth-10-20,r=a.height-5-10;this.clipViewport.style.left=`${this.pinnedWidth+10}px`,this.clipViewport.style.top=`${i+5}px`,this.clipViewport.style.width=`${o}px`,this.clipViewport.style.height=`${r}px`;const u=Math.max(e.scrollWidth,100),c=e.scrollHeight||e.clientHeight;this.canvas.width=Math.min(u,32e3),this.canvas.height=Math.min(c,16e3),this.canvas.style.position="absolute",this.canvas.style.left="0px",this.canvas.style.top="0px",this.canvas.style.transform=`translate(${-this.scrollLeft}px, ${-this.scrollTop}px)`;const h="function"==typeof this.tableManager.getAllCellBoundingRects?this.tableManager.getAllCellBoundingRects():"function"==typeof this.tableManager.getCellBoundingRects?this.tableManager.getCellBoundingRects():[];this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.save(),this.barRects=[],this._log("sync-debug",{canvasSize:{w:this.canvas.width,h:this.canvas.height},scrollAreaSize:{w:e.scrollWidth,h:e.scrollHeight},visibleSize:{w:e.clientWidth,h:e.clientHeight},scroll:{left:e.scrollLeft,top:e.scrollTop},cellRects:h.length,bars:this.barData.length});const d=[...new Set(h.map(t=>t.columnId))],f=h.length>0?Math.max(...h.map(t=>t.x+t.width)):0;console.log("[GanttOverlay] ðŸ“ CellRects analysis:",{totalCells:h.length,uniqueColumns:d.length,sampleColumnIds:d.slice(0,10),maxX:f,canvasWidth:this.canvas.width,scrollWidth:e.scrollWidth}),this._log("sync",{cells:h.length,bars:this.barData.length,deps:this.dependencies.length,size:{w:this.canvas.width,h:this.canvas.height},scroll:{left:e.scrollLeft,top:e.scrollTop}}),this.barData.length>0&&0===h.length&&this._log("warn-no-cell-rects",{bars:this.barData.length}),this.debug&&(this.ctx.strokeStyle="#e2e8f0",h.forEach(t=>{const e=t.x-this.pinnedWidth;this.ctx.strokeRect(e,t.y,t.width,t.height)})),this._drawBars(h),this._publishMetrics(h,e),this._drawDependencies(h),this.ctx.restore()}renderBars(t){this.barData=Array.isArray(t)?t:[],this._log("renderBars",{bars:this.barData.length}),this.visible&&this.syncWithTable()}renderDependencies(t){this.dependencies=Array.isArray(t)?t:[],this._log("renderDependencies",{deps:this.dependencies.length}),this.visible&&this.syncWithTable()}_updatePinnedClip(){var t,e;const l=null==(t=this.tableManager)?void 0:t.bodyScroll,n="function"==typeof(null==(e=this.tableManager)?void 0:e.getPinnedColumnsWidth)&&Number(this.tableManager.getPinnedColumnsWidth())||0;return this.pinnedWidth=Math.max(0,n),this.canvas.style.clipPath="",this.canvas.style.webkitClipPath="",(null==l?void 0:l.style)&&l.style.setProperty("--gantt-overlay-pinned-width",`${this.pinnedWidth}px`),this._log("clip",{pinnedWidth:this.pinnedWidth}),this.pinnedWidth}_publishMetrics(t,e){const l="number"==typeof(null==e?void 0:e.scrollLeft)?e.scrollLeft:0,n="number"==typeof(null==e?void 0:e.clientWidth)?e.clientWidth:0,i=n?l+n:null,s={timestamp:Date.now(),pinnedWidth:this.pinnedWidth,clipLeft:Math.max(this.pinnedWidth,l),viewportLeft:l,viewportWidth:n,viewportRight:i,scrollWidth:(null==e?void 0:e.scrollWidth)||0,scrollHeight:(null==e?void 0:e.scrollHeight)||0,barsDrawn:this.lastDrawMetrics.barsDrawn||0,barsSkipped:this.lastDrawMetrics.barsSkipped||0,cellRects:Array.isArray(t)?t.length:0};return"undefined"!=typeof window&&(window.GanttOverlayMetrics=s),this._log("metrics",s),s}_drawBars(t){var e;if(!Array.isArray(t)||0===t.length||0===this.barData.length)return void(this.lastDrawMetrics={barsDrawn:0,barsSkipped:0});const l=null==(e=this.tableManager)?void 0:e.bodyScroll,n="number"==typeof(null==l?void 0:l.scrollLeft)?l.scrollLeft:0;"number"==typeof(null==l?void 0:l.clientWidth)&&l.clientWidth,Math.max(this.pinnedWidth,n);const i=new Map;t.forEach(t=>{const e=String(t.pekerjaanId);i.has(e)||i.set(e,[]),i.get(e).push(t)}),i.forEach(t=>t.sort((t,e)=>t.x-e.x));const s=new Map;this.barData.forEach(t=>{const e=String(t.pekerjaanId);s.has(e)||s.set(e,[]),s.get(e).push(t)});let a=0,o=0;s.forEach((t,e)=>{const l=i.get(e)||[],n=new Map(l.map(t=>[String(t.columnId),t]));t.forEach(t=>{const e=n.get(String(t.columnId));if(!e)return void(o+=1);const l=e.width-0,i=e.x-this.pinnedWidth+0,s=e.y+3+7;if(i<-e.width)return void(o+=1);const r=Math.max(8,e.height-6-7),u=r/2,c=Number.isFinite(t.planned)?Math.max(0,Math.min(100,t.planned)):0,h=Number.isFinite(t.actual)?Math.max(0,Math.min(100,t.actual)):Math.max(0,Math.min(100,t.value||0)),d=l>0&&c>0?l:0;this.ctx.fillStyle=this._getPlannedColor(),d>0&&this.ctx.fillRect(i,s+u,d,u-1);const f=l>0&&h>0?l:0,p=t.color||this._resolveActualColor(t.variance);this.ctx.fillStyle=p,f>0&&this.ctx.fillRect(i,s,f,u-1),this.barRects.push({x:i,y:s,width:Math.max(f,d),height:r,pekerjaanId:t.pekerjaanId,columnId:t.columnId,value:h,planned:c,variance:t.variance,label:t.label,color:p}),a+=1})}),this.lastDrawMetrics={barsDrawn:a,barsSkipped:o},this._log("bars:drawn",{drawn:a,skipped:o,total:this.barData.length})}_drawDependencies(t){Array.isArray(t)&&0!==t.length&&0!==this.dependencies.length&&this.dependencies.forEach(e=>{const l=t.find(t=>t.pekerjaanId===e.fromPekerjaanId&&t.columnId===e.fromColumnId),n=t.find(t=>t.pekerjaanId===e.toPekerjaanId&&t.columnId===e.toColumnId);if(!l||!n)return;const i=l.x-this.pinnedWidth+l.width,s=l.y+l.height/2,a=n.x-this.pinnedWidth,o=n.y+n.height/2;this.ctx.strokeStyle=e.color||"#94a3b8",this.ctx.lineWidth=1.5,this.ctx.beginPath(),this.ctx.moveTo(i,s),this.ctx.lineTo(a,o),this.ctx.stroke();const r=Math.atan2(o-s,a-i);this.ctx.beginPath(),this.ctx.moveTo(a,o),this.ctx.lineTo(a-5*Math.cos(r-Math.PI/6),o-5*Math.sin(r-Math.PI/6)),this.ctx.lineTo(a-5*Math.cos(r+Math.PI/6),o-5*Math.sin(r+Math.PI/6)),this.ctx.closePath(),this.ctx.fillStyle=e.color||"#94a3b8",this.ctx.fill()})}_resolveVarianceColor(t){return Number.isFinite(t)?t<-.1?"#ef4444":t>.1?"#22c55e":"#3b82f6":"#3b82f6"}_resolveActualColor(t){const e=h("--gantt-actual-fill")||h("--bs-warning")||d(".progress-mode-tabs .btn-outline-warning")||d(".progress-mode-tabs .btn-warning");return e||this._resolveVarianceColor(t)}_getPlannedColor(){return h("--gantt-bar-fill")||h("--bs-info")||d(".progress-mode-tabs .btn-outline-info")||d(".progress-mode-tabs .btn-info")||"#e2e8f0"}_bindPointerEvents(){this.canvas.addEventListener("mousemove",t=>{if(!this.visible||!this.barRects.length)return;const e=this.canvas.getBoundingClientRect(),l=t.clientX-e.left,n=t.clientY-e.top,i=this._hitTest(l,n);if(i){const e={label:`Pekerjaan: ${i.label||i.pekerjaanId}`,color:i.color||"#3b82f6",weekNumber:null,columnId:i.columnId,progress:i.value,weekProgress:i.planned};this.tooltipManager.show(t.clientX,t.clientY,e)}else this.tooltipManager.hide()}),this.canvas.addEventListener("mouseleave",()=>{this.tooltipManager.hide()})}_hitTest(t,e){return this.barRects.find(l=>t>=l.x&&t<=l.x+l.width&&e>=l.y&&e<=l.y+l.height)}_log(t,e){this.debug&&console.log(`[GanttOverlay] ${t}`,e||{})}}function m(t){if(!t)return null;if(t instanceof Date)return Number.isNaN(t.getTime())?null:t;if("string"==typeof t){const e=new Date(t);return Number.isNaN(e.getTime())?null:e}if("number"==typeof t&&Number.isFinite(t)){const e=new Date(t);return Number.isNaN(e.getTime())?null:e}return null}function g(t,e,l=1){const n=[String(e),String(Number(e))];for(const i of n)if(t.has(i))return t.get(i);return l}function b(t){const e=new Map,l=(t,l)=>{const n=Number(t),i=Number.isFinite(l)&&l>=0?l:null;null!==i&&(e.set(String(t),i),Number.isNaN(n)||e.set(String(n),i))};return t.hargaMap instanceof Map?t.hargaMap.forEach((t,e)=>{const n=parseFloat(t);l(e,n)}):t.hargaMap&&"object"==typeof t.hargaMap&&Object.entries(t.hargaMap).forEach(([t,e])=>{const n=parseFloat(e);l(t,n)}),e}function v(t,e,l=0){const n=[String(e),String(Number(e))];for(const i of n)if(t.has(i))return t.get(i);return l}function w(t){console.warn("[chart-utils] buildCellValueMap() is deprecated. Use StateManager.getAllCellsForMode() instead.");const e=new Map,l=(t,l)=>{const n=parseFloat(l);e.set(String(t),Number.isFinite(n)?n:0)};return t.assignmentMap instanceof Map?t.assignmentMap.forEach((t,e)=>l(e,t)):t.assignmentMap&&"object"==typeof t.assignmentMap&&Object.entries(t.assignmentMap).forEach(([t,e])=>l(t,e)),t.modifiedCells instanceof Map?t.modifiedCells.forEach((t,e)=>l(e,t)):t.modifiedCells&&"object"==typeof t.modifiedCells&&Object.entries(t.modifiedCells).forEach(([t,e])=>l(t,e)),e}function y(t,e){const l=new Set;return Array.isArray(t.flatPekerjaan)&&t.flatPekerjaan.forEach(t=>{!t||"pekerjaan"!==t.type&&void 0!==t.type||l.add(String(t.id))}),e.forEach((t,e)=>{const[n]=String(e).split("-");n&&l.add(n)}),l}function x(t,e=1){if(!Number.isFinite(t))return"0%";return`${0===e?Math.round(t):parseFloat(t.toFixed(e))}%`}function _(t){if(!Number.isFinite(t))return"Rp 0";return`Rp ${Math.round(t).toLocaleString("id-ID")}`}function k(t){if(!t||!Array.isArray(t.labels)||0===t.labels.length)return t;const e=String(t.labels[0]||"").toLowerCase();if(e.includes("week 0")||"w0"===e)return t;const l="cost"===t.viewMode?"W0":"Week 0",n=Array.isArray(t.planned)?t.planned:[],i=Array.isArray(t.actual)?t.actual:[],s=u(r({},t),{labels:[l,...t.labels],planned:[0,...n],actual:[0,...i]});return Array.isArray(t.acSeries)&&(s.acSeries=[0,...t.acSeries]),s.details=function(t,e,l){if(Array.isArray(t))return[{label:e,planned:0,actual:0,variance:0,start:null,end:null,tooltip:e,weekNumber:0},...t];if(l&&t&&"object"==typeof t){const e={week_number:0,week_start:null,week_end:null,cost:0,cumulative_cost:0,cumulative_percent:0,pekerjaan_breakdown:{}};return u(r({},t),{weeks:Array.isArray(t.weeks)?[e,...t.weeks]:t.weeks,actualWeeks:Array.isArray(t.actualWeeks)?[e,...t.actualWeeks]:t.actualWeeks})}return t}(t.details,l,"cost"===t.viewMode),s}const M="[KurvaSDataset]";function S(t){const e=function(t){return Array.isArray(t)?t.slice().sort((t,e)=>{const l=m(t.startDate),n=m(e.startDate);return l&&n?l.getTime()-n.getTime():(t.index||0)-(e.index||0)}):[]}(null==t?void 0:t.timeColumns);if(!e||0===e.length)return console.warn(M,"No time columns available"),null;const l=function(t){const e=new Map,l=(t,l)=>{const n=Number(t),i=Number.isFinite(l)&&l>0?l:null;null!==i&&(e.set(String(t),i),Number.isNaN(n)||e.set(String(n),i))};return t.volumeMap instanceof Map?t.volumeMap.forEach((t,e)=>{const n=parseFloat(t);l(e,n)}):t.volumeMap&&"object"==typeof t.volumeMap&&Object.entries(t.volumeMap).forEach(([t,e])=>{const n=parseFloat(e);l(t,n)}),e}(t),n=b(t),i=null==t?void 0:t.stateManager;let s,a;if(i)s=i.getAllCellsForMode("planned")||new Map,a=i.getAllCellsForMode("actual")||new Map;else{const e=(null==t?void 0:t.plannedState)||t,l=(null==t?void 0:t.actualState)||t;s=w(e),a=w(l)}s&&s instanceof Map||(s=new Map),a&&a instanceof Map||(a=new Map);const o=new Set([...y(t,s),...y(t,a)]);let r=parseFloat((null==t?void 0:t.totalBiayaProject)||0);(!r||r<=0)&&o.forEach(t=>{r+=v(n,t,0)});const u=r>0&&n.size>0;let c=0;u||(o.forEach(t=>{c+=g(l,t,1)}),(!Number.isFinite(c)||c<=0)&&(c=o.size||1));const h=new Map;e.forEach((t,e)=>{h.set(String(t.id),e)});const d=function(t){return t.map((t,e)=>{const l=(null==t?void 0:t.label)||(null==t?void 0:t.displayLabel)||(null==t?void 0:t.display_name)||(null==t?void 0:t.name)||`Week ${e+1}`;return(null==t?void 0:t.start_date)&&(null==t?void 0:t.end_date)?`${l} (${t.start_date} - ${t.end_date})`:l})}(e),f=function(t,e,l,n,i,s,a){const o=Array(t.length).fill(0);n.forEach((t,n)=>{const[i,r]=n.split("-");if(!s.has(r))return;const u=s.get(r);if(void 0===u)return;const c=Number(t)||0;if(a){const t=v(l,i,0)*c/100;o[u]+=t}else{const t=g(e,i,1)*c/100;o[u]+=t}});let r=0;return o.map(t=>(r+=t,!Number.isFinite(i)||i<=0?0:Number((r/i*100).toFixed(2))))}(e,l,n,s,u?r:c,h,u),p=function(t,e,l,n,i,s){const a=Array(t.length).fill(0);return e.forEach((t,e)=>{const[o,r]=e.split("-"),u=i.get(r);if(void 0===u)return;const c=Number(t)||0;if(s){const t=v(n,o,0)*c/100;a[u]+=t}else{const t=g(l,o,1)*c/100;a[u]+=t}}),a}(e,a,l,n,h,u),x=function(t,e,l){let n=0;return t.map((t,i)=>(n+=e[i]||0,!Number.isFinite(l)||l<=0?0:Number((n/l*100).toFixed(2))))}(e,p,u?r:c),_=function(t,e,l,n,i=0,s=!1){return t.map((t,a)=>{const o=e[a]||`Week ${a+1}`,r=l[a]||0,u=n[a]||0,c=a>0&&l[a-1]||0,h=a>0&&n[a-1]||0,d=Number((r-c).toFixed(2)),f=Number((u-h).toFixed(2)),p=Number((u-r).toFixed(2));let g=null,b=null,v=null;return s&&(g=Number((r/100*(i||0)).toFixed(2)),b=Number((u/100*(i||0)).toFixed(2)),v=Number((b-g).toFixed(2))),{label:o,planned:r,actual:u,plannedWeekProgress:d,actualWeekProgress:f,variance:p,start:m((null==t?void 0:t.startDate)||(null==t?void 0:t.start_date)||(null==t?void 0:t.start)),end:m((null==t?void 0:t.endDate)||(null==t?void 0:t.end_date)||(null==t?void 0:t.end)),metadata:t,plannedCostValue:g,actualCostValue:b,varianceCostValue:v,weekNumber:(null==t?void 0:t.weekNumber)||(null==t?void 0:t.week_number)||a+1}})}(e,d,f,x,u?r:c,u);return k({labels:d,planned:f,actual:x,details:_,totalVolume:c,totalBiaya:r,columnTotals:p,useHargaCalculation:u,viewMode:"progress"})}function T(t){var e;if(!t)return console.error(M,"No cost data available"),null;const l=t.weeklyData||{},n=t.summary||{},i=t.evm;if(i&&Array.isArray(i.labels)&&i.labels.length>0){const t=(null==(e=i.summary)?void 0:e.bac)||(null==n?void 0:n.total_project_cost)||0,s=C((null==l?void 0:l.planned)||[],(null==l?void 0:l.actual)||[],t,i.labels),a=i.pv_percent||[],o=i.ev_percent||[],r=i.ac_percent||o,u=a.map((t,e)=>Number(((r[e]||o[e]||0)-(t||0)).toFixed(2))),c=s.map(t=>t.varianceCostValue||0);return k({labels:i.labels,planned:a,actual:o,acSeries:r,varianceSeries:u,varianceCostSeries:c,details:{totalCost:t,weeks:(null==l?void 0:l.planned)||[],actualWeeks:(null==l?void 0:l.actual)||[],weeklySummary:s,evmSummary:i.summary,evm:i},evm:i,totalBiaya:t,useHargaCalculation:!0,viewMode:"cost"})}const s=(l.planned||[]).map(t=>`W${t.week_number}`),a=(l.planned||[]).map(t=>t.cumulative_percent),o=(l.actual||[]).map(t=>t.cumulative_percent),c=o.length?o:(l.earned||[]).map(t=>t.cumulative_percent),h=a.map((t,e)=>Number(((c[e]||o[e]||0)-(t||0)).toFixed(2))),d={totalCost:(null==n?void 0:n.total_project_cost)||0,plannedCost:(null==n?void 0:n.planned_cost)||0,actualCost:(null==n?void 0:n.actual_cost)||0,weeks:l.planned||[],actualWeeks:l.actual||[],viewMode:"cost"},f=C(l.planned||[],l.actual||[],d.totalCost,s);return console.log(M,"Cost dataset built:",{labels:s.length,plannedPoints:a.length,actualPoints:o.length,totalCost:_(d.totalCost)}),k({labels:s,planned:a,actual:o,acSeries:c,varianceSeries:h,varianceCostSeries:f.map(t=>t.varianceCostValue||0),details:u(r({},d),{weeklySummary:f}),totalBiaya:d.totalCost,useHargaCalculation:!0,viewMode:"cost"})}function C(t=[],e=[],l=0,n=[]){var i,s,a,o,r,u,c,h,d,f;const p=Math.max(t.length,e.length,n.length),g=[];for(let b=0;b<p;b+=1){const p=t[b]||{},v=e[b]||{},w=n[b]||p.label||v.label||`W${p.week_number||v.week_number||b+1}`,y=Number(null!=(o=null!=(a=null!=(s=null!=(i=p.cumulative_percent)?i:p.percent)?s:p.value)?a:p.cumulative)?o:0),x=Number(null!=(h=null!=(c=null!=(u=null!=(r=v.cumulative_percent)?r:v.percent)?u:v.value)?c:v.cumulative)?h:0),_=D(p,y,l),k=D(v,x,l),M=Number((x-y).toFixed(2)),S=Number((k-_).toFixed(2));g.push({label:w,weekNumber:null!=(f=null!=(d=p.week_number)?d:v.week_number)?f:b+1,plannedPercent:Number.isFinite(y)?y:0,actualPercent:Number.isFinite(x)?x:0,plannedCostValue:_,actualCostValue:k,variancePercent:M,varianceCostValue:S,range:{start:m(p.week_start||p.start_date||v.week_start||v.start_date),end:m(p.week_end||p.end_date||v.week_end||v.end_date)}})}return g}function D(t,e,l){var n,i,s,a,o,r;const u=Number(null!=(s=null!=(i=null!=(n=null!=e?e:null==t?void 0:t.cumulative_percent)?n:null==t?void 0:t.percent)?i:null==t?void 0:t.value)?s:0),c=A(null!=(r=null!=(o=null!=(a=null==t?void 0:t.cumulative_cost)?a:null==t?void 0:t.cumulative)?o:null==t?void 0:t.accumulated_cost)?r:null==t?void 0:t.acc_cost);if(Number.isFinite(c)&&c>0)return c;const h=A(null==t?void 0:t.cost);return Number.isFinite(h)&&h>0&&!(null==t?void 0:t.cumulative_cost)?h:!Number.isFinite(l)||l<=0?0:Number(((u||0)/100*l).toFixed(2))}function A(t){if("number"==typeof t)return t;if("string"==typeof t){const e=Number(t);return Number.isFinite(e)?e:NaN}return NaN}const E=Object.freeze(Object.defineProperty({__proto__:null,buildCostDataset:T,buildProgressDataset:S},Symbol.toStringTag,{value:"Module"}));class N{constructor(){this.shortcuts=new Map,this.enabled=!0,this._boundHandler=this._handleKeyDown.bind(this),this.init()}init(){document.addEventListener("keydown",this._boundHandler),console.log("âŒ¨ï¸ Keyboard shortcuts initialized")}register(t,e,l={}){const{description:n="",preventDefault:i=!0}=l;this.shortcuts.set(t.toLowerCase(),{callback:e,description:n,preventDefault:i})}unregister(t){this.shortcuts.delete(t.toLowerCase())}_handleKeyDown(t){if(!this.enabled)return;const e=document.activeElement,l="INPUT"===e.tagName||"TEXTAREA"===e.tagName||e.isContentEditable,n=[];t.ctrlKey&&n.push("ctrl"),t.altKey&&n.push("alt"),t.shiftKey&&n.push("shift"),t.metaKey&&n.push("meta");const i=t.key.toLowerCase();["control","alt","shift","meta"].includes(i)||n.push(i);const s=n.join("+"),a=this.shortcuts.get(s);if(a){if(l&&!["ctrl+a","ctrl+c","ctrl+v","ctrl+x","ctrl+z"].includes(s))return;a.preventDefault&&t.preventDefault(),a.callback(t),console.log(`âŒ¨ï¸ Shortcut triggered: ${s}`)}}enable(){this.enabled=!0}disable(){this.enabled=!1}getShortcuts(){return Array.from(this.shortcuts.entries()).map(([t,e])=>({key:t,description:e.description}))}destroy(){document.removeEventListener("keydown",this._boundHandler),this.shortcuts.clear()}}class P{static add(t){t&&(t.classList.add("btn-ripple"),t.addEventListener("click",function(t){const e=document.createElement("span");e.classList.add("ripple-circle");const l=this.getBoundingClientRect(),n=Math.max(l.width,l.height),i=t.clientX-l.left-n/2,s=t.clientY-l.top-n/2;e.style.width=e.style.height=n+"px",e.style.left=i+"px",e.style.top=s+"px",this.appendChild(e),setTimeout(()=>e.remove(),600)}))}static addToAll(t){document.querySelectorAll(t).forEach(t=>{P.add(t)})}}class L{static setLoading(t,e="Loading..."){if(!t)return;t.dataset.originalText=t.innerHTML,t.disabled=!0,t.classList.add("loading");t.innerHTML='<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>'+e}static setSuccess(t,e=2e3){t&&(t.disabled=!1,t.classList.remove("loading"),t.classList.add("success"),t.dataset.originalText&&(t.innerHTML=t.dataset.originalText),setTimeout(()=>{t.classList.remove("success")},e))}static setError(t,e=2e3){t&&(t.disabled=!1,t.classList.remove("loading"),t.classList.add("error"),t.dataset.originalText&&(t.innerHTML=t.dataset.originalText),setTimeout(()=>{t.classList.remove("error")},e))}static reset(t){t&&(t.disabled=!1,t.classList.remove("loading","success","error"),t.dataset.originalText&&(t.innerHTML=t.dataset.originalText))}static markChanges(t,e){t&&(e?(t.classList.add("has-changes"),t.setAttribute("data-tooltip","You have unsaved changes")):(t.classList.remove("has-changes"),t.removeAttribute("data-tooltip")))}}class W{static success(t,e=1600){var l,n;(null==(n=null==(l=window.DP)?void 0:l.core)?void 0:n.toast)?window.DP.core.toast.show(t,"success",e):console.log(`âœ… ${t}`)}static error(t,e=3e3){var l,n;(null==(n=null==(l=window.DP)?void 0:l.core)?void 0:n.toast)?window.DP.core.toast.show(t,"danger",e):console.error(`âŒ ${t}`)}static warning(t,e=2e3){var l,n;(null==(n=null==(l=window.DP)?void 0:l.core)?void 0:n.toast)?window.DP.core.toast.show(t,"warning",e):console.warn(`âš ï¸ ${t}`)}static info(t,e=1600){var l,n;(null==(n=null==(l=window.DP)?void 0:l.core)?void 0:n.toast)?window.DP.core.toast.show(t,"info",e):console.info(`â„¹ï¸ ${t}`)}}function I(){console.log("ðŸŽ¨ Initializing UX enhancements..."),P.addToAll(".btn-primary, .btn-save, .btn-danger"),document.querySelectorAll("button[title]").forEach(t=>{t.hasAttribute("data-tooltip")||t.setAttribute("data-tooltip",t.getAttribute("title"))}),console.log("âœ… UX enhancements initialized")}const z="u-off",F="u-label",$="width",V="height",R="top",j="bottom",H="left",O="right",B="#000",Y=B+"0",G="mousemove",U="mousedown",K="mouseup",X="mouseenter",q="mouseleave",J="dblclick",Z="change",Q="dppxchange",tt="--",et="undefined"!=typeof window,lt=et?document:null,nt=et?window:null,it=et?navigator:null;let st,at;function ot(t,e){if(null!=e){let l=t.classList;!l.contains(e)&&l.add(e)}}function rt(t,e){let l=t.classList;l.contains(e)&&l.remove(e)}function ut(t,e,l){t.style[e]=l+"px"}function ct(t,e,l,n){let i=lt.createElement(t);return null!=e&&ot(i,e),null!=l&&l.insertBefore(i,n),i}function ht(t,e){return ct("div",t,e)}const dt=new WeakMap;function ft(t,e,l,n,i){let s="translate("+e+"px,"+l+"px)";s!=dt.get(t)&&(t.style.transform=s,dt.set(t,s),e<0||l<0||e>n||l>i?ot(t,z):rt(t,z))}const pt=new WeakMap;function mt(t,e,l){let n=e+l;n!=pt.get(t)&&(pt.set(t,n),t.style.background=e,t.style.borderColor=l)}const gt=new WeakMap;function bt(t,e,l,n){let i=e+""+l;i!=gt.get(t)&&(gt.set(t,i),t.style.height=l+"px",t.style.width=e+"px",t.style.marginLeft=n?-e/2+"px":0,t.style.marginTop=n?-l/2+"px":0)}const vt={passive:!0},wt=u(r({},vt),{capture:!0});function yt(t,e,l,n){e.addEventListener(t,l,n?wt:vt)}function xt(t,e,l,n){e.removeEventListener(t,l,vt)}function _t(t,e,l,n){let i;l=l||0;let s=(n=n||e.length-1)<=2147483647;for(;n-l>1;)i=s?l+n>>1:jt((l+n)/2),e[i]<t?l=i:n=i;return t-e[l]<=e[n]-t?l:n}function kt(t){return(e,l,n)=>{let i=-1,s=-1;for(let a=l;a<=n;a++)if(t(e[a])){i=a;break}for(let a=n;a>=l;a--)if(t(e[a])){s=a;break}return[i,s]}}et&&function t(){let e=devicePixelRatio;st!=e&&(st=e,at&&xt(Z,at,t),at=matchMedia(`(min-resolution: ${st-.001}dppx) and (max-resolution: ${st+.001}dppx)`),yt(Z,at,t),nt.dispatchEvent(new CustomEvent(Q)))}();const Mt=t=>null!=t,St=t=>null!=t&&t>0,Tt=kt(Mt),Ct=kt(St);function Dt(t,e,l,n){let i=Ut(t),s=Ut(e);t==e&&(-1==i?(t*=l,e/=l):(t/=l,e*=l));let a=10==l?Kt:Xt,o=1==s?Ot:jt,r=(1==i?jt:Ot)(a(Rt(t))),u=o(a(Rt(e))),c=Gt(l,r),h=Gt(l,u);return 10==l&&(r<0&&(c=de(c,-r)),u<0&&(h=de(h,-u))),n||2==l?(t=c*i,e=h*s):(t=he(t,c),e=ce(e,h)),[t,e]}function At(t,e,l,n){let i=Dt(t,e,l,n);return 0==t&&(i[0]=0),0==e&&(i[1]=0),i}const Et={mode:3,pad:.1},Nt={pad:0,soft:null,mode:0},Pt={min:Nt,max:Nt};function Lt(t,e,l,n){return _e(l)?It(t,e,l):(Nt.pad=l,Nt.soft=n?0:null,Nt.mode=n?3:0,It(t,e,Pt))}function Wt(t,e){return null==t?e:t}function It(t,e,l){let n=l.min,i=l.max,s=Wt(n.pad,0),a=Wt(i.pad,0),o=Wt(n.hard,-Jt),r=Wt(i.hard,Jt),u=Wt(n.soft,Jt),c=Wt(i.soft,-Jt),h=Wt(n.mode,0),d=Wt(i.mode,0),f=e-t,p=Kt(f),m=Yt(Rt(t),Rt(e)),g=Kt(m),b=Rt(g-p);(f<1e-24||b>10)&&(f=0,0!=t&&0!=e||(f=1e-24,2==h&&u!=Jt&&(s=0),2==d&&c!=-Jt&&(a=0)));let v=f||m||1e3,w=Kt(v),y=Gt(10,jt(w)),x=de(he(t-v*(0==f?0==t?.1:1:s),y/10),24),_=t>=u&&(1==h||3==h&&x<=u||2==h&&x>=u)?u:Jt,k=Yt(o,x<_&&t>=_?_:Bt(_,x)),M=de(ce(e+v*(0==f?0==e?.1:1:a),y/10),24),S=e<=c&&(1==d||3==d&&M>=c||2==d&&M<=c)?c:-Jt,T=Bt(r,M>S&&e<=S?S:Yt(S,M));return k==T&&0==k&&(T=100),[k,T]}const zt=new Intl.NumberFormat(et?it.language:"en-US"),Ft=t=>zt.format(t),$t=Math,Vt=$t.PI,Rt=$t.abs,jt=$t.floor,Ht=$t.round,Ot=$t.ceil,Bt=$t.min,Yt=$t.max,Gt=$t.pow,Ut=$t.sign,Kt=$t.log10,Xt=$t.log2,qt=(t,e=1)=>$t.asinh(t/e),Jt=1/0;function Zt(t){return 1+(0|Kt((t^t>>31)-(t>>31)))}function Qt(t,e,l){return Bt(Yt(t,e),l)}function te(t){return"function"==typeof t}function ee(t){return te(t)?t:()=>t}const le=t=>t,ne=(t,e)=>e,ie=t=>null,se=t=>!0,ae=(t,e)=>t==e,oe=/\.\d*?(?=9{6,}|0{6,})/gm,re=t=>{if(ye(t)||fe.has(t))return t;const e=`${t}`,l=e.match(oe);if(null==l)return t;let n=l[0].length-1;if(-1!=e.indexOf("e-")){let[t,l]=e.split("e");return+`${re(t)}e${l}`}return de(t,n)};function ue(t,e){return re(de(re(t/e))*e)}function ce(t,e){return re(Ot(re(t/e))*e)}function he(t,e){return re(jt(re(t/e))*e)}function de(t,e=0){if(ye(t))return t;let l=a(10,e),n=t*l*(1+Number.EPSILON);return Ht(n)/l}const fe=new Map;function pe(t){return((""+t).split(".")[1]||"").length}function me(t,e,l,n){let i=[],s=n.map(pe);for(let a=e;a<l;a++){let e=Rt(a),l=de(Gt(t,a),e);for(let o=0;o<n.length;o++){let r=10==t?+`${n[o]}e${a}`:n[o]*l,u=(a>=0?0:e)+(a>=s[o]?0:s[o]),c=10==t?r:de(r,u);i.push(c),fe.set(c,u)}}return i}const ge={},be=[],ve=[null,null],we=Array.isArray,ye=Number.isInteger;function xe(t){return"string"==typeof t}function _e(t){let e=!1;if(null!=t){let l=t.constructor;e=null==l||l==Object}return e}function ke(t){return null!=t&&"object"==typeof t}const Me=Object.getPrototypeOf(Uint8Array),Se="__proto__";function Te(t,e=_e){let l;if(we(t)){let n=t.find(t=>null!=t);if(we(n)||e(n)){l=Array(t.length);for(let n=0;n<t.length;n++)l[n]=Te(t[n],e)}else l=t.slice()}else if(t instanceof Me)l=t.slice();else if(e(t)){l={};for(let n in t)n!=Se&&(l[n]=Te(t[n],e))}else l=t;return l}function Ce(t){let e=arguments;for(let l=1;l<e.length;l++){let n=e[l];for(let e in n)e!=Se&&(_e(t[e])?Ce(t[e],Te(n[e])):t[e]=Te(n[e]))}return t}function De(t,e,l){for(let n,i=0,s=-1;i<e.length;i++){let a=e[i];if(a>s){for(n=a-1;n>=0&&null==t[n];)t[n--]=null;for(n=a+1;n<l&&null==t[n];)t[s=n++]=null}}}const Ae="undefined"==typeof queueMicrotask?t=>Promise.resolve().then(t):queueMicrotask;const Ee=["January","February","March","April","May","June","July","August","September","October","November","December"],Ne=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function Pe(t){return t.slice(0,3)}const Le=Ne.map(Pe),We=Ee.map(Pe),Ie={MMMM:Ee,MMM:We,WWWW:Ne,WWW:Le};function ze(t){return(t<10?"0":"")+t}const Fe={YYYY:t=>t.getFullYear(),YY:t=>(t.getFullYear()+"").slice(2),MMMM:(t,e)=>e.MMMM[t.getMonth()],MMM:(t,e)=>e.MMM[t.getMonth()],MM:t=>ze(t.getMonth()+1),M:t=>t.getMonth()+1,DD:t=>ze(t.getDate()),D:t=>t.getDate(),WWWW:(t,e)=>e.WWWW[t.getDay()],WWW:(t,e)=>e.WWW[t.getDay()],HH:t=>ze(t.getHours()),H:t=>t.getHours(),h:t=>{let e=t.getHours();return 0==e?12:e>12?e-12:e},AA:t=>t.getHours()>=12?"PM":"AM",aa:t=>t.getHours()>=12?"pm":"am",a:t=>t.getHours()>=12?"p":"a",mm:t=>ze(t.getMinutes()),m:t=>t.getMinutes(),ss:t=>ze(t.getSeconds()),s:t=>t.getSeconds(),fff:t=>{return((e=t.getMilliseconds())<10?"00":e<100?"0":"")+e;var e}};function $e(t,e){e=e||Ie;let l,n=[],i=/\{([a-z]+)\}|[^{]+/gi;for(;l=i.exec(t);)n.push("{"==l[0][0]?Fe[l[1]]:l[0]);return t=>{let l="";for(let i=0;i<n.length;i++)l+="string"==typeof n[i]?n[i]:n[i](t,e);return l}}const Ve=(new Intl.DateTimeFormat).resolvedOptions().timeZone;const Re=t=>t%1==0,je=[1,2,2.5,5],He=me(10,-32,0,je),Oe=me(10,0,32,je),Be=Oe.filter(Re),Ye=He.concat(Oe),Ge="{YYYY}",Ue="\n"+Ge,Ke="{M}/{D}",Xe="\n"+Ke,qe=Xe+"/{YY}",Je="{aa}",Ze="{h}:{mm}"+Je,Qe="\n"+Ze,tl=":{ss}",el=null;function ll(t){let e=1e3*t,l=60*e,n=60*l,i=24*n,s=30*i,a=365*i;return[(1==t?me(10,0,3,je).filter(Re):me(10,-3,0,je)).concat([e,5*e,10*e,15*e,30*e,l,5*l,10*l,15*l,30*l,n,2*n,3*n,4*n,6*n,8*n,12*n,i,2*i,3*i,4*i,5*i,6*i,7*i,8*i,9*i,10*i,15*i,s,2*s,3*s,4*s,6*s,a,2*a,5*a,10*a,25*a,50*a,100*a]),[[a,Ge,el,el,el,el,el,el,1],[28*i,"{MMM}",Ue,el,el,el,el,el,1],[i,Ke,Ue,el,el,el,el,el,1],[n,"{h}"+Je,qe,el,Xe,el,el,el,1],[l,Ze,qe,el,Xe,el,el,el,1],[e,tl,qe+" "+Ze,el,Xe+" "+Ze,el,Qe,el,1],[t,tl+".{fff}",qe+" "+Ze,el,Xe+" "+Ze,el,Qe,el,1]],function(e){return(o,r,u,c,h,d)=>{let f=[],p=h>=a,m=h>=s&&h<a,g=e(u),b=de(g*t,3),v=hl(g.getFullYear(),p?0:g.getMonth(),m||p?1:g.getDate()),w=de(v*t,3);if(m||p){let l=m?h/s:0,n=p?h/a:0,i=b==w?b:de(hl(v.getFullYear()+n,v.getMonth()+l,1)*t,3),o=new Date(Ht(i/t)),r=o.getFullYear(),u=o.getMonth();for(let s=0;i<=c;s++){let a=hl(r+n*s,u+l*s,1),o=a-e(de(a*t,3));i=de((+a+o)*t,3),i<=c&&f.push(i)}}else{let s=h>=i?i:h,a=w+(jt(u)-jt(b))+ce(b-w,s);f.push(a);let p=e(a),m=p.getHours()+p.getMinutes()/l+p.getSeconds()/n,g=h/n,v=d/o.axes[r]._space;for(;a=de(a+h,1==t?0:3),!(a>c);)if(g>1){let t=jt(de(m+g,6))%24,l=e(a).getHours()-t;l>1&&(l=-1),a-=l*n,m=(m+g)%24,de((a-f[f.length-1])/h,3)*v>=.7&&f.push(a)}else f.push(a)}return f}}]}const[nl,il,sl]=ll(1),[al,ol,rl]=ll(.001);function ul(t,e){return t.map(t=>t.map((l,n)=>0==n||8==n||null==l?l:e(1==n||0==t[8]?l:t[1]+l)))}function cl(t,e){return(l,n,i,s,a)=>{let o,r,u,c,h,d,f=e.find(t=>a>=t[0])||e[e.length-1];return n.map(e=>{let l=t(e),n=l.getFullYear(),i=l.getMonth(),s=l.getDate(),a=l.getHours(),p=l.getMinutes(),m=l.getSeconds(),g=n!=o&&f[2]||i!=r&&f[3]||s!=u&&f[4]||a!=c&&f[5]||p!=h&&f[6]||m!=d&&f[7]||f[1];return o=n,r=i,u=s,c=a,h=p,d=m,g(l)})}}function hl(t,e,l){return new Date(t,e,l)}function dl(t,e){return e(t)}me(2,-53,53,[1]);function fl(t,e){return(l,n,i,s)=>null==s?tt:e(t(n))}const pl={show:!0,live:!0,isolate:!1,mount:()=>{},markers:{show:!0,width:2,stroke:function(t,e){let l=t.series[e];return l.width?l.stroke(t,e):l.points.width?l.points.stroke(t,e):null},fill:function(t,e){return t.series[e].fill(t,e)},dash:"solid"},idx:null,idxs:null,values:[]};const ml=[0,0];function gl(t,e,l,n=!0){return t=>{0==t.button&&(!n||t.target==e)&&l(t)}}function bl(t,e,l,n=!0){return t=>{(!n||t.target==e)&&l(t)}}const vl={show:!0,x:!0,y:!0,lock:!1,move:function(t,e,l){return ml[0]=e,ml[1]=l,ml},points:{one:!1,show:function(t,e){let l=t.cursor.points,n=ht(),i=l.size(t,e);ut(n,$,i),ut(n,V,i);let s=i/-2;ut(n,"marginLeft",s),ut(n,"marginTop",s);let a=l.width(t,e,i);return a&&ut(n,"borderWidth",a),n},size:function(t,e){return t.series[e].points.size},width:0,stroke:function(t,e){let l=t.series[e].points;return l._stroke||l._fill},fill:function(t,e){let l=t.series[e].points;return l._fill||l._stroke}},bind:{mousedown:gl,mouseup:gl,click:gl,dblclick:gl,mousemove:bl,mouseleave:bl,mouseenter:bl},drag:{setScale:!0,x:!0,y:!1,dist:0,uni:null,click:(t,e)=>{e.stopPropagation(),e.stopImmediatePropagation()},_x:!1,_y:!1},focus:{dist:(t,e,l,n,i)=>n-i,prox:-1,bias:0},hover:{skip:[void 0],prox:null,bias:0},left:-10,top:-10,idx:null,dataIdx:null,idxs:null,event:null},wl={show:!0,stroke:"rgba(0,0,0,0.07)",width:2},yl=Ce({},wl,{filter:ne}),xl=Ce({},yl,{size:10}),_l=Ce({},wl,{show:!1}),kl='12px system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"',Ml="bold "+kl,Sl={show:!0,scale:"x",stroke:B,space:50,gap:5,alignTo:1,size:50,labelGap:0,labelSize:30,labelFont:Ml,side:2,grid:yl,ticks:xl,border:_l,font:kl,lineGap:1.5,rotate:0},Tl={show:!0,scale:"x",auto:!1,sorted:1,min:Jt,max:-Jt,idxs:[]};function Cl(t,e,l,n,i){return e.map(t=>null==t?"":Ft(t))}function Dl(t,e,l,n,i,s,a){let o=[],r=fe.get(i)||0;for(let u=l=a?l:de(ce(l,i),r);u<=n;u=de(u+i,r))o.push(Object.is(u,-0)?0:u);return o}function Al(t,e,l,n,i,s,a){const o=[],r=t.scales[t.axes[e].scale].log,u=jt((10==r?Kt:Xt)(l));i=Gt(r,u),10==r&&(i=Ye[_t(i,Ye)]);let c=l,h=i*r;10==r&&(h=Ye[_t(h,Ye)]);do{o.push(c),c+=i,10!=r||fe.has(c)||(c=de(c,fe.get(i))),c>=h&&(h=(i=c)*r,10==r&&(h=Ye[_t(h,Ye)]))}while(c<=n);return o}function El(t,e,l,n,i,s,a){let o=t.scales[t.axes[e].scale].asinh,r=n>o?Al(t,e,Yt(o,l),n,i):[o],u=n>=0&&l<=0?[0]:[];return(l<-o?Al(t,e,Yt(o,-n),-l,i):[o]).reverse().map(t=>-t).concat(u,r)}const Nl=/./,Pl=/[12357]/,Ll=/[125]/,Wl=/1/,Il=(t,e,l,n)=>t.map((t,i)=>4==e&&0==t||i%n==0&&l.test(t.toExponential()[t<0?1:0])?t:null);function zl(t,e,l,n,i){let s=t.axes[l],a=s.scale,o=t.scales[a],r=t.valToPos,u=s._space,c=r(10,a),h=r(9,a)-c>=u?Nl:r(7,a)-c>=u?Pl:r(5,a)-c>=u?Ll:Wl;if(h==Wl){let t=Rt(r(1,a)-c);if(t<u)return Il(e.slice().reverse(),o.distr,h,Ot(u/t)).reverse()}return Il(e,o.distr,h,1)}function Fl(t,e,l,n,i){let s=t.axes[l],a=s.scale,o=s._space,r=t.valToPos,u=Rt(r(1,a)-r(2,a));return u<o?Il(e.slice().reverse(),3,Nl,Ot(o/u)).reverse():e}function $l(t,e,l,n){return null==n?tt:null==e?"":Ft(e)}const Vl={show:!0,scale:"y",stroke:B,space:30,gap:5,alignTo:1,size:50,labelGap:0,labelSize:30,labelFont:Ml,side:3,grid:yl,ticks:xl,border:_l,font:kl,lineGap:1.5,rotate:0};const Rl={scale:null,auto:!0,sorted:0,min:Jt,max:-Jt},jl=(t,e,l,n,i)=>i,Hl={show:!0,auto:!0,sorted:0,gaps:jl,alpha:1,facets:[Ce({},Rl,{scale:"x"}),Ce({},Rl,{scale:"y"})]},Ol={scale:"y",auto:!0,sorted:0,show:!0,spanGaps:!1,gaps:jl,alpha:1,points:{show:function(t,e){let{scale:l,idxs:n}=t.series[0],i=t._data[0],s=t.valToPos(i[n[0]],l,!0),a=t.valToPos(i[n[1]],l,!0),o=Rt(a-s)/(t.series[e].points.space*st);return n[1]-n[0]<=o},filter:null},values:null,min:Jt,max:-Jt,idxs:[],path:null,clip:null};function Bl(t,e,l,n,i){return l/10}const Yl={time:!0,auto:!0,distr:1,log:10,asinh:1,min:null,max:null,dir:1,ori:0},Gl=Ce({},Yl,{time:!1,ori:1}),Ul={};function Kl(t,e){let l=Ul[t];return l||(l={key:t,plots:[],sub(t){l.plots.push(t)},unsub(t){l.plots=l.plots.filter(e=>e!=t)},pub(t,e,n,i,s,a,o){for(let r=0;r<l.plots.length;r++)l.plots[r]!=e&&l.plots[r].pub(t,e,n,i,s,a,o)}},null!=t&&(Ul[t]=l)),l}function Xl(t,e,l){const n=t.mode,i=t.series[e],s=2==n?t._data[e]:t._data,a=t.scales,o=t.bbox;let r=s[0],u=2==n?s[1]:s[e],c=2==n?a[i.facets[0].scale]:a[t.series[0].scale],h=2==n?a[i.facets[1].scale]:a[i.scale],d=o.left,f=o.top,p=o.width,m=o.height,g=t.valToPosH,b=t.valToPosV;return 0==c.ori?l(i,r,u,c,h,g,b,d,f,p,m,nn,an,rn,cn,dn):l(i,r,u,c,h,b,g,f,d,m,p,sn,on,un,hn,fn)}function ql(t,e){let l=0,n=0,i=Wt(t.bands,be);for(let s=0;s<i.length;s++){let t=i[s];t.series[0]==e?l=t.dir:t.series[1]==e&&(1==t.dir?n|=1:n|=2)}return[l,1==n?-1:2==n?1:3==n?2:0]}function Jl(t,e,l,n,i){let s=t.mode,a=t.series[e],o=2==s?a.facets[1].scale:a.scale,r=t.scales[o];return-1==i?r.min:1==i?r.max:3==r.distr?1==r.dir?r.min:r.max:0}function Zl(t,e,l,n,i,s){return Xl(t,e,(t,e,a,o,r,u,c,h,d,f,p)=>{let m=t.pxRound;const g=o.dir*(0==o.ori?1:-1),b=0==o.ori?an:on;let v,w;1==g?(v=l,w=n):(v=n,w=l);let y=m(u(e[v],o,f,h)),x=m(c(a[v],r,p,d)),_=m(u(e[w],o,f,h)),k=m(c(1==s?r.max:r.min,r,p,d)),M=new Path2D(i);return b(M,_,k),b(M,y,k),b(M,y,x),M})}function Ql(t,e,l,n,i,s){let a=null;if(t.length>0){a=new Path2D;const o=0==e?rn:un;let r=l;for(let e=0;e<t.length;e++){let l=t[e];if(l[1]>l[0]){let t=l[0]-r;t>0&&o(a,r,n,t,n+s),r=l[1]}}let u=l+i-r,c=10;u>0&&o(a,r,n-c/2,u,n+s+c)}return a}function tn(t,e,l,n,i,s,a){let o=[],r=t.length;for(let u=1==i?l:n;u>=l&&u<=n;u+=i){if(null===e[u]){let c=u,h=u;if(1==i)for(;++u<=n&&null===e[u];)h=u;else for(;--u>=l&&null===e[u];)h=u;let d=s(t[c]),f=h==c?d:s(t[h]),p=c-i;d=a<=0&&p>=0&&p<r?s(t[p]):d;let m=h+i;f=a>=0&&m>=0&&m<r?s(t[m]):f,f>=d&&o.push([d,f])}}return o}function en(t){return 0==t?le:1==t?Ht:e=>ue(e,t)}function ln(t){let e=0==t?nn:sn,l=0==t?(t,e,l,n,i,s)=>{t.arcTo(e,l,n,i,s)}:(t,e,l,n,i,s)=>{t.arcTo(l,e,i,n,s)},n=0==t?(t,e,l,n,i)=>{t.rect(e,l,n,i)}:(t,e,l,n,i)=>{t.rect(l,e,i,n)};return(t,i,s,a,o,r=0,u=0)=>{0==r&&0==u?n(t,i,s,a,o):(r=Bt(r,a/2,o/2),u=Bt(u,a/2,o/2),e(t,i+r,s),l(t,i+a,s,i+a,s+o,r),l(t,i+a,s+o,i,s+o,u),l(t,i,s+o,i,s,u),l(t,i,s,i+a,s,r),t.closePath())}}const nn=(t,e,l)=>{t.moveTo(e,l)},sn=(t,e,l)=>{t.moveTo(l,e)},an=(t,e,l)=>{t.lineTo(e,l)},on=(t,e,l)=>{t.lineTo(l,e)},rn=ln(0),un=ln(1),cn=(t,e,l,n,i,s)=>{t.arc(e,l,n,i,s)},hn=(t,e,l,n,i,s)=>{t.arc(l,e,n,i,s)},dn=(t,e,l,n,i,s,a)=>{t.bezierCurveTo(e,l,n,i,s,a)},fn=(t,e,l,n,i,s,a)=>{t.bezierCurveTo(l,e,i,n,a,s)};function pn(t){return(t,e,l,n,i)=>Xl(t,e,(e,s,a,o,r,u,c,h,d,f,p)=>{let m,g,{pxRound:b,points:v}=e;0==o.ori?(m=nn,g=cn):(m=sn,g=hn);const w=de(v.width*st,3);let y=(v.size-v.width)/2*st,x=de(2*y,3),_=new Path2D,k=new Path2D,{left:M,top:S,width:T,height:C}=t.bbox;rn(k,M-x,S-x,T+2*x,C+2*x);const D=t=>{if(null!=a[t]){let e=b(u(s[t],o,f,h)),l=b(c(a[t],r,p,d));m(_,e+y,l),g(_,e,l,y,0,2*Vt)}};if(i)i.forEach(D);else for(let t=l;t<=n;t++)D(t);return{stroke:w>0?_:null,fill:_,clip:k,flags:3}})}function mn(t){return(e,l,n,i,s,a)=>{n!=i&&(s!=n&&a!=n&&t(e,l,n),s!=i&&a!=i&&t(e,l,i),t(e,l,a))}}const gn=mn(an),bn=mn(on);function vn(t){const e=Wt(null==t?void 0:t.alignGaps,0);return(t,l,n,i)=>Xl(t,l,(s,a,o,r,u,c,h,d,f,p,m)=>{[n,i]=Tt(o,n,i);let g,b,v=s.pxRound,w=t=>v(c(t,r,p,d)),y=t=>v(h(t,u,m,f));0==r.ori?(g=an,b=gn):(g=on,b=bn);const x=r.dir*(0==r.ori?1:-1),_={stroke:new Path2D,fill:null,clip:null,band:null,gaps:null,flags:1},k=_.stroke;let M=!1;if(i-n>=4*p){let e,l,s,u=e=>t.posToVal(e,r.key,!0),c=null,h=null,d=w(a[1==x?n:i]),f=w(a[n]),p=w(a[i]),m=u(1==x?f+1:p-1);for(let t=1==x?n:i;t>=n&&t<=i;t+=x){let n=a[t],i=(1==x?n<m:n>m)?d:w(n),s=o[t];i==d?null!=s?(l=s,null==c?(g(k,i,y(l)),e=c=h=l):l<c?c=l:l>h&&(h=l)):null===s&&(M=!0):(null!=c&&b(k,d,y(c),y(h),y(e),y(l)),null!=s?(l=s,g(k,i,y(l)),c=h=e=l):(c=h=null,null===s&&(M=!0)),d=i,m=u(d+x))}null!=c&&c!=h&&s!=d&&b(k,d,y(c),y(h),y(e),y(l))}else for(let t=1==x?n:i;t>=n&&t<=i;t+=x){let e=o[t];null===e?M=!0:null!=e&&g(k,w(a[t]),y(e))}let[S,T]=ql(t,l);if(null!=s.fill||0!=S){let e=_.fill=new Path2D(k),o=y(s.fillTo(t,l,s.min,s.max,S)),r=w(a[n]),u=w(a[i]);-1==x&&([u,r]=[r,u]),g(e,u,o),g(e,r,o)}if(!s.spanGaps){let u=[];M&&u.push(...tn(a,o,n,i,x,w,e)),_.gaps=u=s.gaps(t,l,n,i,u),_.clip=Ql(u,r.ori,d,f,p,m)}return 0!=T&&(_.band=2==T?[Zl(t,l,n,i,k,-1),Zl(t,l,n,i,k,1)]:Zl(t,l,n,i,k,T)),_})}function wn(t,e,l,n,i,s,a=Jt){if(t.length>1){let o=null;for(let r=0,u=1/0;r<t.length;r++)if(void 0!==e[r]){if(null!=o){let e=Rt(t[r]-t[o]);e<u&&(u=e,a=Rt(l(t[r],n,i,s)-l(t[o],n,i,s)))}o=r}}return a}function yn(t,e,l,n,i,s){const a=t.length;if(a<2)return null;const o=new Path2D;if(l(o,t[0],e[0]),2==a)n(o,t[1],e[1]);else{let l=Array(a),n=Array(a-1),s=Array(a-1),r=Array(a-1);for(let i=0;i<a-1;i++)s[i]=e[i+1]-e[i],r[i]=t[i+1]-t[i],n[i]=s[i]/r[i];l[0]=n[0];for(let t=1;t<a-1;t++)0===n[t]||0===n[t-1]||n[t-1]>0!=n[t]>0?l[t]=0:(l[t]=3*(r[t-1]+r[t])/((2*r[t]+r[t-1])/n[t-1]+(r[t]+2*r[t-1])/n[t]),isFinite(l[t])||(l[t]=0));l[a-1]=n[a-2];for(let u=0;u<a-1;u++)i(o,t[u]+r[u]/3,e[u]+l[u]*r[u]/3,t[u+1]-r[u]/3,e[u+1]-l[u+1]*r[u]/3,t[u+1],e[u+1])}return o}const xn=new Set;function _n(){for(let t of xn)t.syncRect(!0)}et&&(yt("resize",nt,_n),yt("scroll",nt,_n,!0),yt(Q,nt,()=>{zn.pxRatio=st}));const kn=vn(),Mn=pn();function Sn(t,e,l,n){return(n?[t[0],t[1]].concat(t.slice(2)):[t[0]].concat(t.slice(1))).map((t,n)=>Tn(t,n,e,l))}function Tn(t,e,l,n){return Ce({},0==e?l:n,t)}function Cn(t,e,l){return null==e?ve:[e,l]}const Dn=Cn;function An(t,e,l){return null==e?ve:Lt(e,l,.1,!0)}function En(t,e,l,n){return null==e?ve:Dt(e,l,t.scales[n].log,!1)}const Nn=En;function Pn(t,e,l,n){return null==e?ve:At(e,l,t.scales[n].log,!1)}const Ln=Pn;function Wn(t){let e,l;return[t=t.replace(/(\d+)px/,(t,n)=>(e=Ht((l=+n)*st))+"px"),e,l]}function In(t){t.show&&[t.font,t.labelFont].forEach(t=>{let e=de(t[2]*st,1);t[0]=t[0].replace(/[0-9.]+px/,e+"px"),t[1]=e})}function zn(t,e,l){var n,i;const s={mode:Wt(t.mode,1)},a=s.mode;function o(t,e,l,n){let i=e.valToPct(t);return n+l*(-1==e.dir?1-i:i)}function r(t,e,l,n){let i=e.valToPct(t);return n+l*(-1==e.dir?i:1-i)}function u(t,e,l,n){return 0==e.ori?o(t,e,l,n):r(t,e,l,n)}s.valToPosH=o,s.valToPosV=r;let c=!1;s.status=0;const h=s.root=ht("uplot");if(null!=t.id&&(h.id=t.id),ot(h,t.class),t.title){ht("u-title",h).textContent=t.title}const d=ct("canvas"),f=s.ctx=d.getContext("2d"),p=ht("u-wrap",h);yt("click",p,t=>{if(t.target===g){(Gn!=Hn||Un!=On)&&li.click(s,t)}},!0);const m=s.under=ht("u-under",p);p.appendChild(d);const g=s.over=ht("u-over",p),b=+Wt((t=Te(t)).pxAlign,1),v=en(b);(t.plugins||[]).forEach(e=>{e.opts&&(t=e.opts(s,t)||t)});const w=t.ms||.001,y=s.series=1==a?Sn(t.series||[],Tl,Ol,!1):(x=t.series||[null],_=Hl,x.map((t,e)=>0==e?{}:Ce({},_,t)));var x,_;const k=s.axes=Sn(t.axes||[],Sl,Vl,!0),M=s.scales={},S=s.bands=t.bands||[];S.forEach(t=>{t.fill=ee(t.fill||null),t.dir=Wt(t.dir,-1)});const T=2==a?y[1].facets[0].scale:y[0].scale,C={axes:function(){for(let t=0;t<k.length;t++){let e=k[t];if(!e.show||!e._show)continue;let l,n,i=e.side,a=i%2,o=e.stroke(s,t),r=0==i||3==i?-1:1,[c,h]=e._found;if(null!=e.label){let u=e.labelGap*r,d=Ht((e._lpos+u)*st);rn(e.labelFont[0],o,"center",2==i?R:j),f.save(),1==a?(l=n=0,f.translate(d,Ht(Fe+Re/2)),f.rotate((3==i?-Vt:Vt)/2)):(l=Ht(ze+Ve/2),n=d);let p=te(e.label)?e.label(s,t,c,h):e.label;f.fillText(p,l,n),f.restore()}if(0==h)continue;let d=M[e.scale],p=0==a?Ve:Re,m=0==a?ze:Fe,g=e._splits,b=2==d.distr?g.map(t=>ln[t]):g,w=2==d.distr?ln[g[1]]-ln[g[0]]:c,y=e.ticks,x=e.border,_=y.show?y.size:0,S=Ht(_*st),T=Ht((2==e.alignTo?e._size-_-e.gap:e.gap)*st),C=e._rotate*-Vt/180,D=v(e._pos*st),A=D+(S+T)*r;n=0==a?A:0,l=1==a?A:0,rn(e.font[0],o,1==e.align?H:2==e.align?O:C>0?H:C<0?O:0==a?"center":3==i?O:H,C||1==a?"middle":2==i?R:j);let E=e.font[1]*e.lineGap,N=g.map(t=>v(u(t,d,p,m))),P=e._values;for(let t=0;t<P.length;t++){let e=P[t];if(null!=e){0==a?l=N[t]:n=N[t],e=""+e;let i=-1==e.indexOf("\n")?[e]:e.split(/\n/gm);for(let t=0;t<i.length;t++){let e=i[t];C?(f.save(),f.translate(l,n+t*E),f.rotate(C),f.fillText(e,0,0),f.restore()):f.fillText(e,l,n+t*E)}}}y.show&&vn(N,y.filter(s,b,t,h,w),a,i,D,S,de(y.width*st,3),y.stroke(s,t),y.dash,y.cap);let L=e.grid;L.show&&vn(N,L.filter(s,b,t,h,w),a,0==a?2:1,0==a?Fe:ze,0==a?Re:Ve,de(L.width*st,3),L.stroke(s,t),L.dash,L.cap),x.show&&vn([D],[1],0==a?1:0,0==a?1:2,1==a?Fe:ze,1==a?Re:Ve,de(x.width*st,3),x.stroke(s,t),x.dash,x.cap)}$i("drawAxes")},series:function(){if(Ml>0){let t=y.some(t=>t._focus)&&tn!=tl.alpha;t&&(f.globalAlpha=tn=tl.alpha),y.forEach((t,l)=>{if(l>0&&t.show&&(hn(l,!1),hn(l,!0),null==t._paths)){let n=tn;tn!=t.alpha&&(f.globalAlpha=tn=t.alpha);let i=2==a?[0,e[l][0].length-1]:function(t){let e=Qt(Nl-1,0,Ml-1),l=Qt(Pl+1,0,Ml-1);for(;null==t[e]&&e>0;)e--;for(;null==t[l]&&l<Ml-1;)l++;return[e,l]}(e[l]);t._paths=t.paths(s,l,i[0],i[1]),tn!=n&&(f.globalAlpha=tn=n)}}),y.forEach((t,e)=>{if(e>0&&t.show){let l=tn;tn!=t.alpha&&(f.globalAlpha=tn=t.alpha),null!=t._paths&&dn(e,!1);{let l=null!=t._paths?t._paths.gaps:null,n=t.points.show(s,e,Nl,Pl,l),i=t.points.filter(s,e,n,l);(n||i)&&(t.points._paths=t.points.paths(s,e,Nl,Pl,i),dn(e,!0))}tn!=l&&(f.globalAlpha=tn=l),$i("drawSeries",e)}}),t&&(f.globalAlpha=tn=1)}}},D=(t.drawOrder||["axes","series"]).map(t=>C[t]);function A(t){const e=3==t.distr?e=>Kt(e>0?e:t.clamp(s,e,t.min,t.max,t.key)):4==t.distr?e=>qt(e,t.asinh):100==t.distr?e=>t.fwd(e):t=>t;return l=>{let n=e(l),{_min:i,_max:s}=t;return(n-i)/(s-i)}}function E(e){let l=M[e];if(null==l){let n=(t.scales||ge)[e]||ge;if(null!=n.from){E(n.from);let t=Ce({},M[n.from],n,{key:e});t.valToPct=A(t),M[e]=t}else{l=M[e]=Ce({},e==T?Yl:Gl,n),l.key=e;let t=l.time,i=l.range,s=we(i);if((e!=T||2==a&&!t)&&(!s||null!=i[0]&&null!=i[1]||(i={min:null==i[0]?Et:{mode:1,hard:i[0],soft:i[0]},max:null==i[1]?Et:{mode:1,hard:i[1],soft:i[1]}},s=!1),!s&&_e(i))){let t=i;i=(e,l,n)=>null==l?ve:Lt(l,n,t)}l.range=ee(i||(t?Dn:e==T?3==l.distr?Nn:4==l.distr?Ln:Cn:3==l.distr?En:4==l.distr?Pn:An)),l.auto=ee(!s&&l.auto),l.clamp=ee(l.clamp||Bl),l._min=l._max=null,l.valToPct=A(l)}}}E("x"),E("y"),1==a&&y.forEach(t=>{E(t.scale)}),k.forEach(t=>{E(t.scale)});for(let z in t.scales)E(z);const N=M[T],P=N.distr;let L,W;0==N.ori?(ot(h,"u-hz"),L=o,W=r):(ot(h,"u-vt"),L=r,W=o);const I={};for(let z in M){let t=M[z];null==t.min&&null==t.max||(I[z]={min:t.min,max:t.max},t.min=t.max=null)}const B=t.tzDate||(t=>new Date(Ht(t/w))),Z=t.fmtDate||$e,et=1==w?sl(B):rl(B),it=cl(B,ul(1==w?il:ol,Z)),at=fl(B,dl("{YYYY}-{MM}-{DD} {h}:{mm}{aa}",Z)),dt=[],pt=s.legend=Ce({},pl,t.legend),gt=s.cursor=Ce({},vl,{drag:{y:2==a}},t.cursor),vt=pt.show,wt=gt.show,kt=pt.markers;let Nt,Pt,It;pt.idxs=dt,kt.width=ee(kt.width),kt.dash=ee(kt.dash),kt.stroke=ee(kt.stroke),kt.fill=ee(kt.fill);let zt,Ft=[],jt=[],Ut=!1,Xt={};if(pt.live){const t=y[1]?y[1].values:null;Ut=null!=t,zt=Ut?t(s,1,0):{_:0};for(let e in zt)Xt[e]=tt}if(vt)if(Nt=ct("table","u-legend",h),It=ct("tbody",null,Nt),pt.mount(s,Nt),Ut){Pt=ct("thead",null,Nt,It);let t=ct("tr",null,Pt);for(var le in ct("th",null,t),zt)ct("th",F,t).textContent=le}else ot(Nt,"u-inline"),pt.live&&ot(Nt,"u-live");const oe={show:!0},re={show:!1};const ce=new Map;function he(t,e,l,n=!0){const i=ce.get(e)||{},a=gt.bind[t](s,e,l,n);a&&(yt(t,e,i[t]=a),ce.set(e,i))}function me(t,e,l){const n=ce.get(e)||{};for(let i in n)null!=t&&i!=t||(xt(i,e,n[i]),delete n[i]);null==t&&ce.delete(e)}let ye=0,Me=0,Se=0,De=0,Ee=0,Ne=0,Pe=Ee,Le=Ne,We=Se,Ie=De,ze=0,Fe=0,Ve=0,Re=0;s.bbox={};let je=!1,He=!1,Oe=!1,Ge=!1,Ue=!1,Ke=!1;function Xe(t,e,l){(l||t!=s.width||e!=s.height)&&qe(t,e),_n(!1),Oe=!0,He=!0,Zn()}function qe(t,e){s.width=ye=Se=t,s.height=Me=De=e,Ee=Ne=0,function(){let t=!1,e=!1,l=!1,n=!1;k.forEach((i,s)=>{if(i.show&&i._show){let{side:s,_size:a}=i,o=s%2,r=a+(null!=i.label?i.labelSize:0);r>0&&(o?(Se-=r,3==s?(Ee+=r,n=!0):l=!0):(De-=r,0==s?(Ne+=r,t=!0):e=!0))}}),yl[0]=t,yl[1]=l,yl[2]=e,yl[3]=n,Se-=kl[1]+kl[3],Ee+=kl[3],De-=kl[2]+kl[0],Ne+=kl[0]}(),function(){let t=Ee+Se,e=Ne+De,l=Ee,n=Ne;function i(i,s){switch(i){case 1:return t+=s,t-s;case 2:return e+=s,e-s;case 3:return l-=s,l+s;case 0:return n-=s,n+s}}k.forEach((t,e)=>{if(t.show&&t._show){let e=t.side;t._pos=i(e,t._size),null!=t.label&&(t._lpos=i(e,t.labelSize))}})}();let l=s.bbox;ze=l.left=ue(Ee*st,.5),Fe=l.top=ue(Ne*st,.5),Ve=l.width=ue(Se*st,.5),Re=l.height=ue(De*st,.5)}const Je=3;if(s.setSize=function({width:t,height:e}){Xe(t,e)},null==gt.dataIdx){let t=gt.hover,l=t.skip=new Set(null!=(n=t.skip)?n:[]);l.add(void 0);let s=t.prox=ee(t.prox),a=null!=(i=t.bias)?i:t.bias=0;gt.dataIdx=(t,n,i,o)=>{var r;if(0==n)return i;let u=i,c=null!=(r=s(t,n,i,o))?r:Jt,h=c>=0&&c<Jt,d=0==N.ori?Se:De,f=gt.left,p=e[0],m=e[n];if(l.has(m[i])){u=null;let t,e=null,n=null;if(0==a||-1==a)for(t=i;null==e&&t-- >0;)l.has(m[t])||(e=t);if(0==a||1==a)for(t=i;null==n&&t++<m.length;)l.has(m[t])||(n=t);if(null!=e||null!=n)if(h){let t=f-(null==e?-1/0:L(p[e],N,d,0)),l=(null==n?1/0:L(p[n],N,d,0))-f;t<=l?t<=c&&(u=e):l<=c&&(u=n)}else u=null==n?e:null==e?n:i-e<=n-i?e:n}else if(h){Rt(f-L(p[i],N,d,0))>c&&(u=null)}return u}}const Ze=t=>{gt.event=t};gt.idxs=dt,gt._lock=!1;let Qe=gt.points;Qe.show=ee(Qe.show),Qe.size=ee(Qe.size),Qe.stroke=ee(Qe.stroke),Qe.width=ee(Qe.width),Qe.fill=ee(Qe.fill);const tl=s.focus=Ce({},t.focus||{alpha:.3},gt.focus),el=tl.prox>=0,ll=el&&Qe.one;let hl=[],ml=[],gl=[];function bl(t,e){let l=Qe.show(s,e);if(l instanceof HTMLElement)return ot(l,"u-cursor-pt"),ot(l,t.class),ft(l,-10,-10,Se,De),g.insertBefore(l,hl[e]),l}function wl(t,e){if(1==a||e>0){let e=1==a&&M[t.scale].time,l=t.value;t.value=e?xe(l)?fl(B,dl(l,Z)):l||at:l||$l,t.label=t.label||(e?"Time":"Value")}if(ll||e>0){t.width=null==t.width?1:t.width,t.paths=t.paths||kn||ie,t.fillTo=ee(t.fillTo||Jl),t.pxAlign=+Wt(t.pxAlign,b),t.pxRound=en(t.pxAlign),t.stroke=ee(t.stroke||null),t.fill=ee(t.fill||null),t._stroke=t._fill=t._paths=t._focus=null;let e=de((3+2*(Yt(1,t.width)||1))*1,3),l=t.points=Ce({},{size:e,width:Yt(1,.2*e),stroke:t.stroke,space:2*e,paths:Mn,_stroke:null,_fill:null},t.points);l.show=ee(l.show),l.filter=ee(l.filter),l.fill=ee(l.fill),l.stroke=ee(l.stroke),l.paths=ee(l.paths),l.pxAlign=t.pxAlign}if(vt){let l=function(t,e){if(0==e&&(Ut||!pt.live||2==a))return ve;let l=[],n=ct("tr","u-series",It,It.childNodes[e]);ot(n,t.class),t.show||ot(n,z);let i=ct("th",null,n);if(kt.show){let t=ht("u-marker",i);if(e>0){let l=kt.width(s,e);l&&(t.style.border=l+"px "+kt.dash(s,e)+" "+kt.stroke(s,e)),t.style.background=kt.fill(s,e)}}let o=ht(F,i);for(var r in t.label instanceof HTMLElement?o.appendChild(t.label):o.textContent=t.label,e>0&&(kt.show||(o.style.color=t.width>0?kt.stroke(s,e):kt.fill(s,e)),he("click",i,e=>{if(gt._lock)return;Ze(e);let l=y.indexOf(t);if((e.ctrlKey||e.metaKey)!=pt.isolate){let t=y.some((t,e)=>e>0&&e!=l&&t.show);y.forEach((e,n)=>{n>0&&ui(n,t?n==l?oe:re:oe,!0,Ri.setSeries)})}else ui(l,{show:!t.show},!0,Ri.setSeries)},!1),el&&he(X,i,e=>{gt._lock||(Ze(e),ui(y.indexOf(t),fi,!0,Ri.setSeries))},!1)),zt){let t=ct("td","u-value",n);t.textContent="--",l.push(t)}return[n,l]}(t,e);Ft.splice(e,0,l[0]),jt.splice(e,0,l[1]),pt.values.push(null)}if(wt){dt.splice(e,0,null);let l=null;ll?0==e&&(l=bl(t,e)):e>0&&(l=bl(t,e)),hl.splice(e,0,l),ml.splice(e,0,0),gl.splice(e,0,0)}$i("addSeries",e)}s.addSeries=function(t,e){e=null==e?y.length:e,t=1==a?Tn(t,e,Tl,Ol):Tn(t,e,{},Hl),y.splice(e,0,t),wl(y[e],e)},s.delSeries=function(t){if(y.splice(t,1),vt){pt.values.splice(t,1),jt.splice(t,1);let e=Ft.splice(t,1)[0];me(null,e.firstChild),e.remove()}wt&&(dt.splice(t,1),hl.splice(t,1)[0].remove(),ml.splice(t,1),gl.splice(t,1)),$i("delSeries",t)};const yl=[!1,!1,!1,!1];function xl(t,e,l,n){let[i,s,a,o]=l,r=e%2,u=0;return 0==r&&(o||s)&&(u=0==e&&!i||2==e&&!a?Ht(Sl.size/3):0),1==r&&(i||a)&&(u=1==e&&!s||3==e&&!o?Ht(Vl.size/2):0),u}const _l=s.padding=(t.padding||[xl,xl,xl,xl]).map(t=>ee(Wt(t,xl))),kl=s._padding=_l.map((t,e)=>t(s,e,yl,0));let Ml,Nl=null,Pl=null;const Ll=1==a?y[0].idxs:null;let Wl,Il,Rl,jl,Ul,Xl,ql,Zl,Ql,tn,ln=null,nn=!1;function sn(t,l){if(e=null==t?[]:t,s.data=s._data=e,2==a){Ml=0;for(let t=1;t<y.length;t++)Ml+=e[t][0].length}else{0==e.length&&(s.data=s._data=e=[[]]),ln=e[0],Ml=ln.length;let t=e;if(2==P){t=e.slice();let l=t[0]=Array(Ml);for(let t=0;t<Ml;t++)l[t]=t}s._data=e=t}if(_n(!0),$i("setData"),2==P&&(Oe=!0),!1!==l){let t=N;t.auto(s,nn)?an():ri(T,t.min,t.max),Ge=Ge||gt.left>=0,Ke=!0,Zn()}}function an(){let t,l;nn=!0,1==a&&(Ml>0?(Nl=Ll[0]=0,Pl=Ll[1]=Ml-1,t=e[0][Nl],l=e[0][Pl],2==P?(t=Nl,l=Pl):t==l&&(3==P?[t,l]=Dt(t,t,N.log,!1):4==P?[t,l]=At(t,t,N.log,!1):N.time?l=t+Ht(86400/w):[t,l]=Lt(t,l,.1,!0))):(Nl=Ll[0]=t=null,Pl=Ll[1]=l=null)),ri(T,t,l)}function on(t,e,l,n,i,s){null!=t||(t=Y),null!=l||(l=be),null!=n||(n="butt"),null!=i||(i=Y),null!=s||(s="round"),t!=Wl&&(f.strokeStyle=Wl=t),i!=Il&&(f.fillStyle=Il=i),e!=Rl&&(f.lineWidth=Rl=e),s!=Ul&&(f.lineJoin=Ul=s),n!=Xl&&(f.lineCap=Xl=n),l!=jl&&f.setLineDash(jl=l)}function rn(t,e,l,n){e!=Il&&(f.fillStyle=Il=e),t!=ql&&(f.font=ql=t),l!=Zl&&(f.textAlign=Zl=l),n!=Ql&&(f.textBaseline=Ql=n)}function un(t,e,l,n,i=0){if(n.length>0&&t.auto(s,nn)&&(null==e||null==e.min)){let e=Wt(Nl,0),s=Wt(Pl,n.length-1),a=null==l.min?function(t,e,l,n=0,i=!1){let s=i?Ct:Tt,a=i?St:Mt;[e,l]=s(t,e,l);let o=t[e],r=t[e];if(e>-1)if(1==n)o=t[e],r=t[l];else if(-1==n)o=t[l],r=t[e];else for(let u=e;u<=l;u++){let e=t[u];a(e)&&(e<o?o=e:e>r&&(r=e))}return[null!=o?o:Jt,null!=r?r:-Jt]}(n,e,s,i,3==t.distr):[l.min,l.max];t.min=Bt(t.min,l.min=a[0]),t.max=Yt(t.max,l.max=a[1])}}s.setData=sn;const cn={min:null,max:null};function hn(t,e){let l=e?y[t].points:y[t];l._stroke=l.stroke(s,t),l._fill=l.fill(s,t)}function dn(t,l){let n=l?y[t].points:y[t],{stroke:i,fill:a,clip:o,flags:r,_stroke:u=n._stroke,_fill:c=n._fill,_width:h=n.width}=n._paths;h=de(h*st,3);let d=null,p=h%2/2;l&&null==c&&(c=h>0?"#fff":u);let m=1==n.pxAlign&&p>0;if(m&&f.translate(p,p),!l){let t=ze-h/2,e=Fe-h/2,l=Ve+h,n=Re+h;d=new Path2D,d.rect(t,e,l,n)}l?pn(u,h,n.dash,n.cap,c,i,a,r,o):function(t,l,n,i,a,o,r,u,c,h,d){let f=!1;0!=c&&S.forEach((p,m)=>{if(p.series[0]==t){let t,g=y[p.series[1]],b=e[p.series[1]],v=(g._paths||ge).band;we(v)&&(v=1==p.dir?v[0]:v[1]);let w=null;g.show&&v&&function(t,e,l){for(e=Wt(e,0),l=Wt(l,t.length-1);e<=l;){if(null!=t[e])return!0;e++}return!1}(b,Nl,Pl)?(w=p.fill(s,m)||o,t=g._paths.clip):v=null,pn(l,n,i,a,w,r,u,c,h,d,t,v),f=!0}}),f||pn(l,n,i,a,o,r,u,c,h,d)}(t,u,h,n.dash,n.cap,c,i,a,r,d,o),m&&f.translate(-p,-p)}const fn=3;function pn(t,e,l,n,i,s,a,o,r,u,c,h){on(t,e,l,n,i),(r||u||h)&&(f.save(),r&&f.clip(r),u&&f.clip(u)),h?(o&fn)==fn?(f.clip(h),c&&f.clip(c),gn(i,a),mn(t,s,e)):2&o?(gn(i,a),f.clip(h),mn(t,s,e)):1&o&&(f.save(),f.clip(h),c&&f.clip(c),gn(i,a),f.restore(),mn(t,s,e)):(gn(i,a),mn(t,s,e)),(r||u||h)&&f.restore()}function mn(t,e,l){l>0&&(e instanceof Map?e.forEach((t,e)=>{f.strokeStyle=Wl=e,f.stroke(t)}):null!=e&&t&&f.stroke(e))}function gn(t,e){e instanceof Map?e.forEach((t,e)=>{f.fillStyle=Il=e,f.fill(t)}):null!=e&&t&&f.fill(e)}function bn(t,e,l,n){let i,a=k[t];if(n<=0)i=[0,0];else{let o=a._space=a.space(s,t,e,l,n);i=function(t,e,l,n,i){let s=Yt(Zt(t),Zt(e)),a=e-t,o=_t(i/n*a,l);do{let t=l[o],e=n*t/a;if(e>=i&&s+(t<5?fe.get(t):0)<=17)return[t,e]}while(++o<l.length);return[0,0]}(e,l,a._incrs=a.incrs(s,t,e,l,n,o),n,o)}return a._found=i}function vn(t,e,l,n,i,s,a,o,r,u){let c=a%2/2;1==b&&f.translate(c,c),on(o,a,r,u,o),f.beginPath();let h,d,p,m,g=i+(0==n||3==n?-s:s);0==l?(d=i,m=g):(h=i,p=g);for(let b=0;b<t.length;b++)null!=e[b]&&(0==l?h=p=t[b]:d=m=t[b],f.moveTo(h,d),f.lineTo(p,m));f.stroke(),1==b&&f.translate(-c,-c)}function wn(t){let e=!0;return k.forEach((l,n)=>{if(!l.show)return;let i=M[l.scale];if(null==i.min)return void(l._show&&(e=!1,l._show=!1,_n(!1)));l._show||(e=!1,l._show=!0,_n(!1));let a=l.side,o=a%2,{min:r,max:u}=i,[c,h]=bn(n,r,u,0==o?Se:De);if(0==h)return;let d=2==i.distr,f=l._splits=l.splits(s,n,r,u,c,h,d),p=2==i.distr?f.map(t=>ln[t]):f,m=2==i.distr?ln[f[1]]-ln[f[0]]:c,g=l._values=l.values(s,l.filter(s,p,n,h,m),n,h,m);l._rotate=2==a?l.rotate(s,g,n,h):0;let b=l._size;l._size=Ot(l.size(s,g,n,t)),null!=b&&l._size!=b&&(e=!1)}),e}function yn(t){let e=!0;return _l.forEach((l,n)=>{let i=l(s,n,yl,t);i!=kl[n]&&(e=!1),kl[n]=i}),e}function _n(t){y.forEach((e,l)=>{l>0&&(e._paths=null,t&&(1==a?(e.min=null,e.max=null):e.facets.forEach(t=>{t.min=null,t.max=null})))})}let zn,Fn,$n,Vn,Rn,jn,Hn,On,Bn,Yn,Gn,Un,Kn=!1,Xn=!1,qn=[];function Jn(){Xn=!1;for(let t=0;t<qn.length;t++)$i(...qn[t]);qn.length=0}function Zn(){Kn||(Ae(Qn),Kn=!0)}function Qn(){if(je&&(!function(){for(let e in M){let t=M[e];null==I[e]&&(null==t.min||null!=I[T]&&t.auto(s,nn))&&(I[e]=cn)}for(let e in M){let t=M[e];null==I[e]&&null!=t.from&&null!=I[t.from]&&(I[e]=cn)}null!=I[T]&&_n(!0);let t={};for(let e in I){let l=I[e];if(null!=l){let n=t[e]=Te(M[e],ke);if(null!=l.min)Ce(n,l);else if(e!=T||2==a)if(0==Ml&&null==n.from){let t=n.range(s,null,null,e);n.min=t[0],n.max=t[1]}else n.min=Jt,n.max=-Jt}}if(Ml>0){y.forEach((l,n)=>{if(1==a){let i=l.scale,a=I[i];if(null==a)return;let o=t[i];if(0==n){let t=o.range(s,o.min,o.max,i);o.min=t[0],o.max=t[1],Nl=_t(o.min,e[0]),Pl=_t(o.max,e[0]),Pl-Nl>1&&(e[0][Nl]<o.min&&Nl++,e[0][Pl]>o.max&&Pl--),l.min=ln[Nl],l.max=ln[Pl]}else l.show&&l.auto&&un(o,a,l,e[n],l.sorted);l.idxs[0]=Nl,l.idxs[1]=Pl}else if(n>0&&l.show&&l.auto){let[i,s]=l.facets,a=i.scale,o=s.scale,[r,u]=e[n],c=t[a],h=t[o];null!=c&&un(c,I[a],i,r,i.sorted),null!=h&&un(h,I[o],s,u,s.sorted),l.min=s.min,l.max=s.max}});for(let e in t){let l=t[e],n=I[e];if(null==l.from&&(null==n||null==n.min)){let t=l.range(s,l.min==Jt?null:l.min,l.max==-Jt?null:l.max,e);l.min=t[0],l.max=t[1]}}}for(let e in t){let l=t[e];if(null!=l.from){let n=t[l.from];if(null==n.min)l.min=l.max=null;else{let t=l.range(s,n.min,n.max,e);l.min=t[0],l.max=t[1]}}}let l={},n=!1;for(let e in t){let i=t[e],s=M[e];if(s.min!=i.min||s.max!=i.max){s.min=i.min,s.max=i.max;let t=s.distr;s._min=3==t?Kt(s.min):4==t?qt(s.min,s.asinh):100==t?s.fwd(s.min):s.min,s._max=3==t?Kt(s.max):4==t?qt(s.max,s.asinh):100==t?s.fwd(s.max):s.max,l[e]=n=!0}}if(n){y.forEach((t,e)=>{2==a?e>0&&l.y&&(t._paths=null):l[t.scale]&&(t._paths=null)});for(let t in l)Oe=!0,$i("setScale",t);wt&&gt.left>=0&&(Ge=Ke=!0)}for(let e in I)I[e]=null}(),je=!1),Oe&&(!function(){let t=!1,e=0;for(;!t;){e++;let l=wn(e),n=yn(e);t=e==Je||l&&n,t||(qe(s.width,s.height),He=!0)}}(),Oe=!1),He){if(ut(m,H,Ee),ut(m,R,Ne),ut(m,$,Se),ut(m,V,De),ut(g,H,Ee),ut(g,R,Ne),ut(g,$,Se),ut(g,V,De),ut(p,$,ye),ut(p,V,Me),d.width=Ht(ye*st),d.height=Ht(Me*st),k.forEach(({_el:t,_show:e,_size:l,_pos:n,side:i})=>{if(null!=t)if(e){let e=i%2==1;ut(t,e?"left":"top",n-(3===i||0===i?l:0)),ut(t,e?"width":"height",l),ut(t,e?"top":"left",e?Ne:Ee),ut(t,e?"height":"width",e?De:Se),rt(t,z)}else ot(t,z)}),Wl=Il=Rl=Ul=Xl=ql=Zl=Ql=jl=null,tn=1,ki(!0),Ee!=Pe||Ne!=Le||Se!=We||De!=Ie){_n(!1);let t=Se/We,e=De/Ie;if(wt&&!Ge&&gt.left>=0){gt.left*=t,gt.top*=e,$n&&ft($n,Ht(gt.left),0,Se,De),Vn&&ft(Vn,0,Ht(gt.top),Se,De);for(let l=0;l<hl.length;l++){let n=hl[l];null!=n&&(ml[l]*=t,gl[l]*=e,ft(n,Ot(ml[l]),Ot(gl[l]),Se,De))}}if(si.show&&!Ue&&si.left>=0&&si.width>0){si.left*=t,si.width*=t,si.top*=e,si.height*=e;for(let t in Ti)ut(ai,t,si[t])}Pe=Ee,Le=Ne,We=Se,Ie=De}$i("setSize"),He=!1}ye>0&&Me>0&&(f.clearRect(0,0,d.width,d.height),$i("drawClear"),D.forEach(t=>t()),$i("draw")),si.show&&Ue&&(oi(si),Ue=!1),wt&&Ge&&(xi(null,!0,!1),Ge=!1),pt.show&&pt.live&&Ke&&(wi(),Ke=!1),c||(c=!0,s.status=1,$i("ready")),nn=!1,Kn=!1}function ti(t,l){let n=M[t];if(null==n.from){if(0==Ml){let e=n.range(s,l.min,l.max,t);l.min=e[0],l.max=e[1]}if(l.min>l.max){let t=l.min;l.min=l.max,l.max=t}if(Ml>1&&null!=l.min&&null!=l.max&&l.max-l.min<1e-16)return;t==T&&2==n.distr&&Ml>0&&(l.min=_t(l.min,e[0]),l.max=_t(l.max,e[0]),l.min==l.max&&l.max++),I[t]=l,je=!0,Zn()}}s.batch=function(t,e=!1){Kn=!0,Xn=e,t(s),Qn(),e&&qn.length>0&&queueMicrotask(Jn)},s.redraw=(t,e)=>{Oe=e||!1,!1!==t?ri(T,N.min,N.max):Zn()},s.setScale=ti;let ei=!1;const li=gt.drag;let ni=li.x,ii=li.y;wt&&(gt.x&&(zn=ht("u-cursor-x",g)),gt.y&&(Fn=ht("u-cursor-y",g)),0==N.ori?($n=zn,Vn=Fn):($n=Fn,Vn=zn),Gn=gt.left,Un=gt.top);const si=s.select=Ce({show:!0,over:!0,left:0,width:0,top:0,height:0},t.select),ai=si.show?ht("u-select",si.over?g:m):null;function oi(t,e){if(si.show){for(let e in t)si[e]=t[e],e in Ti&&ut(ai,e,t[e]);!1!==e&&$i("setSelect")}}function ri(t,e,l){ti(t,{min:e,max:l})}function ui(t,e,l,n){null!=e.focus&&function(t){if(t!=di){let e=null==t,l=1!=tl.alpha;y.forEach((n,i)=>{if(1==a||i>0){let s=e||0==i||i==t;n._focus=e?null:s,l&&function(t,e){y[t].alpha=e,wt&&null!=hl[t]&&(hl[t].style.opacity=e);vt&&Ft[t]&&(Ft[t].style.opacity=e)}(i,s?1:tl.alpha)}}),di=t,l&&Zn()}}(t),null!=e.show&&y.forEach((l,n)=>{n>0&&(t==n||null==t)&&(l.show=e.show,function(t){if(y[t].show)vt&&rt(Ft[t],z);else if(vt&&ot(Ft[t],z),wt){let e=ll?hl[0]:hl[t];null!=e&&ft(e,-10,-10,Se,De)}}(n),2==a?(ri(l.facets[0].scale,null,null),ri(l.facets[1].scale,null,null)):ri(l.scale,null,null),Zn())}),!1!==l&&$i("setSeries",t,e),n&&Oi("setSeries",s,t,e)}let ci,hi,di;s.setSelect=oi,s.setSeries=ui,s.addBand=function(t,e){t.fill=ee(t.fill||null),t.dir=Wt(t.dir,-1),e=null==e?S.length:e,S.splice(e,0,t)},s.setBand=function(t,e){Ce(S[t],e)},s.delBand=function(t){null==t?S.length=0:S.splice(t,1)};const fi={focus:!0};function pi(t,e,l){let n=M[e];l&&(t=t/st-(1==n.ori?Ne:Ee));let i=Se;1==n.ori&&(i=De,t=i-t),-1==n.dir&&(t=i-t);let s=n._min,a=s+(n._max-s)*(t/i),o=n.distr;return 3==o?Gt(10,a):4==o?((t,e=1)=>$t.sinh(t)*e)(a,n.asinh):100==o?n.bwd(a):a}function mi(t,e){ut(ai,H,si.left=t),ut(ai,$,si.width=e)}function gi(t,e){ut(ai,R,si.top=t),ut(ai,V,si.height=e)}vt&&el&&he(q,Nt,t=>{gt._lock||(Ze(t),null!=di&&ui(null,fi,!0,Ri.setSeries))}),s.valToIdx=t=>_t(t,e[0]),s.posToIdx=function(t,l){return _t(pi(t,T,l),e[0],Nl,Pl)},s.posToVal=pi,s.valToPos=(t,e,l)=>0==M[e].ori?o(t,M[e],l?Ve:Se,l?ze:0):r(t,M[e],l?Re:De,l?Fe:0),s.setCursor=(t,e,l)=>{Gn=t.left,Un=t.top,xi(null,e,l)};let bi=0==N.ori?mi:gi,vi=1==N.ori?mi:gi;function wi(t,e){if(null!=t&&(t.idxs?t.idxs.forEach((t,e)=>{dt[e]=t}):void 0!==t.idx&&dt.fill(t.idx),pt.idx=dt[0]),vt&&pt.live){for(let t=0;t<y.length;t++)(t>0||1==a&&!Ut)&&yi(t,dt[t]);!function(){if(vt&&pt.live)for(let t=2==a?1:0;t<y.length;t++){if(0==t&&Ut)continue;let e=pt.values[t],l=0;for(let n in e)jt[t][l++].firstChild.nodeValue=e[n]}}()}Ke=!1,!1!==e&&$i("setLegend")}function yi(t,l){var n;let i,a=y[t],o=0==t&&2==P?ln:e[t];Ut?i=null!=(n=a.values(s,t,l))?n:Xt:(i=a.value(s,null==l?null:o[l],t,l),i=null==i?Xt:{_:i}),pt.values[t]=i}function xi(t,l,n){let i;Bn=Gn,Yn=Un,[Gn,Un]=gt.move(s,Gn,Un),gt.left=Gn,gt.top=Un,wt&&($n&&ft($n,Ht(Gn),0,Se,De),Vn&&ft(Vn,0,Ht(Un),Se,De));let o=Nl>Pl;ci=Jt,hi=null;let r=0==N.ori?Se:De,u=1==N.ori?Se:De;if(Gn<0||0==Ml||o){i=gt.idx=null;for(let t=0;t<y.length;t++){let e=hl[t];null!=e&&ft(e,-10,-10,Se,De)}el&&ui(null,fi,!0,null==t&&Ri.setSeries),pt.live&&(dt.fill(i),Ke=!0)}else{let t,l,n;1==a&&(t=0==N.ori?Gn:Un,l=pi(t,T),i=gt.idx=_t(l,e[0],Nl,Pl),n=L(e[0][i],N,r,0));let o=-10,c=-10,h=0,d=0,f=!0,p="",m="";for(let g=2==a?1:0;g<y.length;g++){let t=y[g],b=dt[g],v=null==b?null:1==a?e[g][b]:e[g][1][b],w=gt.dataIdx(s,g,i,l),x=null==w?null:1==a?e[g][w]:e[g][1][w];if(Ke=Ke||x!=v||w!=b,dt[g]=w,g>0&&t.show){let l=null==w?-10:w==i?n:L(1==a?e[0][w]:e[g][0][w],N,r,0),b=null==x?-10:W(x,1==a?M[t.scale]:M[t.facets[1].scale],u,0);if(el&&null!=x){let e=1==N.ori?Gn:Un,l=Rt(tl.dist(s,g,w,b,e));if(l<ci){let n=tl.bias;if(0!=n){let i=pi(e,t.scale),s=i>=0?1:-1;s==(x>=0?1:-1)&&(1==s?1==n?x>=i:x<=i:1==n?x<=i:x>=i)&&(ci=l,hi=g)}else ci=l,hi=g}}if(Ke||ll){let t,e;0==N.ori?(t=l,e=b):(t=b,e=l);let n,i,a,r,u,v,w=!0,y=Qe.bbox;if(null!=y){w=!1;let t=y(s,g);a=t.left,r=t.top,n=t.width,i=t.height}else a=t,r=e,n=i=Qe.size(s,g);if(v=Qe.fill(s,g),u=Qe.stroke(s,g),ll)g==hi&&ci<=tl.prox&&(o=a,c=r,h=n,d=i,f=w,p=v,m=u);else{let t=hl[g];null!=t&&(ml[g]=a,gl[g]=r,bt(t,n,i,w),mt(t,v,u),ft(t,Ot(a),Ot(r),Se,De))}}}}if(ll){let t=tl.prox;if(Ke||(null==di?ci<=t:ci>t||hi!=di)){let t=hl[0];null!=t&&(ml[0]=o,gl[0]=c,bt(t,h,d,f),mt(t,p,m),ft(t,Ot(o),Ot(c),Se,De))}}}if(si.show&&ei)if(null!=t){let[e,l]=Ri.scales,[n,i]=Ri.match,[s,a]=t.cursor.sync.scales,o=t.cursor.drag;if(ni=o._x,ii=o._y,ni||ii){let o,c,h,d,f,{left:p,top:m,width:g,height:b}=t.select,v=t.scales[s].ori,w=t.posToVal,y=null!=e&&n(e,s),x=null!=l&&i(l,a);y&&ni?(0==v?(o=p,c=g):(o=m,c=b),h=M[e],d=L(w(o,s),h,r,0),f=L(w(o+c,s),h,r,0),bi(Bt(d,f),Rt(f-d))):bi(0,r),x&&ii?(1==v?(o=p,c=g):(o=m,c=b),h=M[l],d=W(w(o,a),h,u,0),f=W(w(o+c,a),h,u,0),vi(Bt(d,f),Rt(f-d))):vi(0,u)}else Ci()}else{let t=Rt(Bn-Rn),e=Rt(Yn-jn);if(1==N.ori){let l=t;t=e,e=l}ni=li.x&&t>=li.dist,ii=li.y&&e>=li.dist;let l,n,i=li.uni;null!=i?ni&&ii&&(ni=t>=i,ii=e>=i,ni||ii||(e>t?ii=!0:ni=!0)):li.x&&li.y&&(ni||ii)&&(ni=ii=!0),ni&&(0==N.ori?(l=Hn,n=Gn):(l=On,n=Un),bi(Bt(l,n),Rt(n-l)),ii||vi(0,u)),ii&&(1==N.ori?(l=Hn,n=Gn):(l=On,n=Un),vi(Bt(l,n),Rt(n-l)),ni||bi(0,r)),ni||ii||(bi(0,0),vi(0,0))}if(li._x=ni,li._y=ii,null==t){if(n){if(null!=ji){let[t,e]=Ri.scales;Ri.values[0]=null!=t?pi(0==N.ori?Gn:Un,t):null,Ri.values[1]=null!=e?pi(1==N.ori?Gn:Un,e):null}Oi(G,s,Gn,Un,Se,De,i)}if(el){let t=n&&Ri.setSeries,e=tl.prox;null==di?ci<=e&&ui(hi,fi,!0,t):ci>e?ui(null,fi,!0,t):hi!=di&&ui(hi,fi,!0,t)}}Ke&&(pt.idx=i,wi()),!1!==l&&$i("setCursor")}s.setLegend=wi;let _i=null;function ki(t=!1){t?_i=null:(_i=g.getBoundingClientRect(),$i("syncRect",_i))}function Mi(t,e,l,n,i,s,a){gt._lock||ei&&null!=t&&0==t.movementX&&0==t.movementY||(Si(t,e,l,n,i,s,a,!1,null!=t),null!=t?xi(null,!0,!0):xi(e,!0,!1))}function Si(t,e,l,n,i,a,o,r,c){if(null==_i&&ki(!1),Ze(t),null!=t)l=t.clientX-_i.left,n=t.clientY-_i.top;else{if(l<0||n<0)return Gn=-10,void(Un=-10);let[t,s]=Ri.scales,o=e.cursor.sync,[r,c]=o.values,[h,d]=o.scales,[f,p]=Ri.match,m=e.axes[0].side%2==1,g=0==N.ori?Se:De,b=1==N.ori?Se:De,v=m?a:i,w=m?i:a,y=m?n:l,x=m?l:n;if(l=null!=h?f(t,h)?u(r,M[t],g,0):-10:g*(y/v),n=null!=d?p(s,d)?u(c,M[s],b,0):-10:b*(x/w),1==N.ori){let t=l;l=n,n=t}}!c||null!=e&&e.cursor.event.type!=G||((l<=1||l>=Se-1)&&(l=ue(l,Se)),(n<=1||n>=De-1)&&(n=ue(n,De))),r?(Rn=l,jn=n,[Hn,On]=gt.move(s,l,n)):(Gn=l,Un=n)}Object.defineProperty(s,"rect",{get:()=>(null==_i&&ki(!1),_i)});const Ti={width:0,height:0,left:0,top:0};function Ci(){oi(Ti,!1)}let Di,Ai,Ei,Ni;function Pi(t,e,l,n,i,a,o){ei=!0,ni=ii=li._x=li._y=!1,Si(t,e,l,n,i,a,0,!0,!1),null!=t&&(he(K,lt,Li,!1),Oi(U,s,Hn,On,Se,De,null));let{left:r,top:u,width:c,height:h}=si;Di=r,Ai=u,Ei=c,Ni=h}function Li(t,e,l,n,i,a,o){ei=li._x=li._y=!1,Si(t,e,l,n,i,a,0,!1,!0);let{left:r,top:u,width:c,height:h}=si,d=c>0||h>0,f=Di!=r||Ai!=u||Ei!=c||Ni!=h;if(d&&f&&oi(si),li.setScale&&d&&f){let t=r,e=c,l=u,n=h;if(1==N.ori&&(t=u,e=h,l=r,n=c),ni&&ri(T,pi(t,T),pi(t+e,T)),ii)for(let i in M){let t=M[i];i!=T&&null==t.from&&t.min!=Jt&&ri(i,pi(l+n,i),pi(l,i))}Ci()}else gt.lock&&(gt._lock=!gt._lock,xi(e,!0,null!=t));null!=t&&(me(K,lt),Oi(K,s,Gn,Un,Se,De,null))}function Wi(t,e,l,n,i,a,o){gt._lock||(Ze(t),an(),Ci(),null!=t&&Oi(J,s,Gn,Un,Se,De,null))}function Ii(){k.forEach(In),Xe(s.width,s.height,!0)}yt(Q,nt,Ii);const zi={};zi.mousedown=Pi,zi.mousemove=Mi,zi.mouseup=Li,zi.dblclick=Wi,zi.setSeries=(t,e,l,n)=>{-1!=(l=(0,Ri.match[2])(s,e,l))&&ui(l,n,!0,!1)},wt&&(he(U,g,Pi),he(G,g,Mi),he(X,g,t=>{Ze(t),ki(!1)}),he(q,g,function(t,e,l,n,i,s,a){if(gt._lock)return;Ze(t);let o=ei;if(ei){let t,e,l=!0,n=!0,i=10;0==N.ori?(t=ni,e=ii):(t=ii,e=ni),t&&e&&(l=Gn<=i||Gn>=Se-i,n=Un<=i||Un>=De-i),t&&l&&(Gn=Gn<Hn?0:Se),e&&n&&(Un=Un<On?0:De),xi(null,!0,!0),ei=!1}Gn=-10,Un=-10,dt.fill(null),xi(null,!0,!0),o&&(ei=o)}),he(J,g,Wi),xn.add(s),s.syncRect=ki);const Fi=s.hooks=t.hooks||{};function $i(t,e,l){Xn?qn.push([t,e,l]):t in Fi&&Fi[t].forEach(t=>{t.call(null,s,e,l)})}(t.plugins||[]).forEach(t=>{for(let e in t.hooks)Fi[e]=(Fi[e]||[]).concat(t.hooks[e])});const Vi=(t,e,l)=>l,Ri=Ce({key:null,setSeries:!1,filters:{pub:se,sub:se},scales:[T,y[1]?y[1].scale:null],match:[ae,ae,Vi],values:[null,null]},gt.sync);2==Ri.match.length&&Ri.match.push(Vi),gt.sync=Ri;const ji=Ri.key,Hi=Kl(ji);function Oi(t,e,l,n,i,s,a){Ri.filters.pub(t,e,l,n,i,s,a)&&Hi.pub(t,e,l,n,i,s,a)}function Bi(){$i("init",t,e),sn(e||t.data,!1),I[T]?ti(T,I[T]):an(),Ue=si.show&&(si.width>0||si.height>0),Ge=Ke=!0,Xe(t.width,t.height)}return Hi.sub(s),s.pub=function(t,e,l,n,i,s,a){Ri.filters.sub(t,e,l,n,i,s,a)&&zi[t](null,e,l,n,i,s,a)},s.destroy=function(){Hi.unsub(s),xn.delete(s),ce.clear(),xt(Q,nt,Ii),h.remove(),null==Nt||Nt.remove(),$i("destroy")},y.forEach(wl),k.forEach(function(t,e){if(t._show=t.show,t.show){let l=t.side%2,n=M[t.scale];null==n&&(t.scale=l?y[1].scale:T,n=M[t.scale]);let i=n.time;t.size=ee(t.size),t.space=ee(t.space),t.rotate=ee(t.rotate),we(t.incrs)&&t.incrs.forEach(t=>{!fe.has(t)&&fe.set(t,pe(t))}),t.incrs=ee(t.incrs||(2==n.distr?Be:i?1==w?nl:al:Ye)),t.splits=ee(t.splits||(i&&1==n.distr?et:3==n.distr?Al:4==n.distr?El:Dl)),t.stroke=ee(t.stroke),t.grid.stroke=ee(t.grid.stroke),t.ticks.stroke=ee(t.ticks.stroke),t.border.stroke=ee(t.border.stroke);let a=t.values;t.values=we(a)&&!we(a[0])?ee(a):i?we(a)?cl(B,ul(a,Z)):xe(a)?function(t,e){let l=$e(e);return(e,n,i,s,a)=>n.map(e=>l(t(e)))}(B,a):a||it:a||Cl,t.filter=ee(t.filter||(n.distr>=3&&10==n.log?zl:3==n.distr&&2==n.log?Fl:ne)),t.font=Wn(t.font),t.labelFont=Wn(t.labelFont),t._size=t.size(s,null,e,0),t._space=t._rotate=t._incrs=t._found=t._splits=t._values=null,t._size>0&&(yl[e]=!0,t._el=ht("u-axis",p))}}),l?l instanceof HTMLElement?(l.appendChild(h),Bi()):l(s,Bi):Bi(),s}zn.assign=Ce,zn.fmtNum=Ft,zn.rangeNum=Lt,zn.rangeLog=Dt,zn.rangeAsinh=At,zn.orient=Xl,zn.pxRatio=st,zn.join=function(t,e){if(function(t){let e=t[0][0],l=e.length;for(let n=1;n<t.length;n++){let i=t[n][0];if(i.length!=l)return!1;if(i!=e)for(let t=0;t<l;t++)if(i[t]!=e[t])return!1}return!0}(t)){let e=t[0].slice();for(let l=1;l<t.length;l++)e.push(...t[l].slice(1));return function(t,e=100){const l=t.length;if(l<=1)return!0;let n=0,i=l-1;for(;n<=i&&null==t[n];)n++;for(;i>=n&&null==t[i];)i--;if(i<=n)return!0;const s=Yt(1,jt((i-n+1)/e));for(let a=t[n],o=n+s;o<=i;o+=s){const e=t[o];if(null!=e){if(e<=a)return!1;a=e}}return!0}(e[0])||(e=function(t){let e=t[0],l=e.length,n=Array(l);for(let s=0;s<n.length;s++)n[s]=s;n.sort((t,l)=>e[t]-e[l]);let i=[];for(let s=0;s<t.length;s++){let e=t[s],a=Array(l);for(let t=0;t<l;t++)a[t]=e[n[t]];i.push(a)}return i}(e)),e}let l=new Set;for(let a=0;a<t.length;a++){let e=t[a][0],n=e.length;for(let t=0;t<n;t++)l.add(e[t])}let n=[Array.from(l).sort((t,e)=>t-e)],i=n[0].length,s=new Map;for(let a=0;a<i;a++)s.set(n[0][a],a);for(let a=0;a<t.length;a++){let l=t[a],o=l[0];for(let t=1;t<l.length;t++){let r=l[t],u=Array(i).fill(void 0),c=e?e[a][t]:1,h=[];for(let t=0;t<r.length;t++){let e=r[t],l=s.get(o[t]);null===e?0!=c&&(u[l]=e,2==c&&h.push(l)):u[l]=e}De(u,h,i),n.push(u)}}return n},zn.fmtDate=$e,zn.tzDate=function(t,e){let l;return"UTC"==e||"Etc/UTC"==e?l=new Date(+t+6e4*t.getTimezoneOffset()):e==Ve?l=t:(l=new Date(t.toLocaleString("en-US",{timeZone:e})),l.setMilliseconds(t.getMilliseconds())),l},zn.sync=Kl;{zn.addGap=function(t,e,l){let n=t[t.length-1];n&&n[0]==e?n[1]=l:t.push([e,l])},zn.clipGaps=Ql;let t=zn.paths={points:pn};t.linear=vn,t.stepped=function(t){const e=Wt(t.align,1),l=Wt(t.ascDesc,!1),n=Wt(t.alignGaps,0),i=Wt(t.extend,!1);return(t,s,a,o)=>Xl(t,s,(r,u,c,h,d,f,p,m,g,b,v)=>{[a,o]=Tt(c,a,o);let w=r.pxRound,{left:y,width:x}=t.bbox,_=t=>w(f(t,h,b,m)),k=t=>w(p(t,d,v,g)),M=0==h.ori?an:on;const S={stroke:new Path2D,fill:null,clip:null,band:null,gaps:null,flags:1},T=S.stroke,C=h.dir*(0==h.ori?1:-1);let D=k(c[1==C?a:o]),A=_(u[1==C?a:o]),E=A,N=A;i&&-1==e&&(N=y,M(T,N,D)),M(T,A,D);for(let t=1==C?a:o;t>=a&&t<=o;t+=C){let l=c[t];if(null==l)continue;let n=_(u[t]),i=k(l);1==e?M(T,n,D):M(T,E,i),M(T,n,i),D=i,E=n}let P=E;i&&1==e&&(P=y+x,M(T,P,D));let[L,W]=ql(t,s);if(null!=r.fill||0!=L){let e=S.fill=new Path2D(T),l=k(r.fillTo(t,s,r.min,r.max,L));M(e,P,l),M(e,N,l)}if(!r.spanGaps){let i=[];i.push(...tn(u,c,a,o,C,_,n));let d=r.width*st/2,f=l||1==e?d:-d,p=l||-1==e?-d:d;i.forEach(t=>{t[0]+=f,t[1]+=p}),S.gaps=i=r.gaps(t,s,a,o,i),S.clip=Ql(i,h.ori,m,g,b,v)}return 0!=W&&(S.band=2==W?[Zl(t,s,a,o,T,-1),Zl(t,s,a,o,T,1)]:Zl(t,s,a,o,T,W)),S})},t.bars=function(t){const e=Wt((t=t||ge).size,[.6,Jt,1]),l=t.align||0,n=t.gap||0;let i=t.radius;i=null==i?[0,0]:"number"==typeof i?[i,0]:i;const s=ee(i),a=1-e[0],o=Wt(e[1],Jt),r=Wt(e[2],1),u=Wt(t.disp,ge),c=Wt(t.each,t=>{}),{fill:h,stroke:d}=u;return(t,e,i,f)=>Xl(t,e,(p,m,g,b,v,w,y,x,_,k,M)=>{var S,T;let C,D,A=p.pxRound,E=l,N=n*st,P=o*st,L=r*st;0==b.ori?[C,D]=s(t,e):[D,C]=s(t,e);const W=b.dir*(0==b.ori?1:-1);let I,z,F,$=0==b.ori?rn:un,V=0==b.ori?c:(t,e,l,n,i,s,a)=>{c(t,e,l,i,n,a,s)},R=Wt(t.bands,be).find(t=>t.series[0]==e),j=null!=R?R.dir:0,H=p.fillTo(t,e,p.min,p.max,j),O=A(y(H,v,M,_)),B=k,Y=A(p.width*st),G=!1,U=null,K=null,X=null,q=null;null==h||0!=Y&&null==d||(G=!0,U=h.values(t,e,i,f),K=new Map,new Set(U).forEach(t=>{null!=t&&K.set(t,new Path2D)}),Y>0&&(X=d.values(t,e,i,f),q=new Map,new Set(X).forEach(t=>{null!=t&&q.set(t,new Path2D)})));let{x0:J,size:Z}=u;if(null!=J&&null!=Z){E=1,m=J.values(t,e,i,f),2==J.unit&&(m=m.map(e=>t.posToVal(x+e*k,b.key,!0)));let l=Z.values(t,e,i,f);z=2==Z.unit?l[0]*k:w(l[0],b,k,x)-w(0,b,k,x),B=wn(m,g,w,b,k,x,B),F=B-z+N}else B=wn(m,g,w,b,k,x,B),F=B*a+N,z=B-F;F<1&&(F=0),Y>=z/2&&(Y=0),F<5&&(A=le);let Q=F>0;z=A(Qt(B-F-(Q?Y:0),L,P)),I=(0==E?z/2:E==W?0:z)-E*W*((0==E?N/2:0)+(Q?Y/2:0));const tt={stroke:null,fill:null,clip:null,band:null,gaps:null,flags:0},et=G?null:new Path2D;let lt=null;if(null!=R)lt=t.data[R.series[1]];else{let{y0:l,y1:n}=u;null!=l&&null!=n&&(g=n.values(t,e,i,f),lt=l.values(t,e,i,f))}let nt=C*z,it=D*z;for(let l=1==W?i:f;l>=i&&l<=f;l+=W){let n=g[l];if(null==n)continue;if(null!=lt){let t=null!=(S=lt[l])?S:0;if(n-t==0)continue;O=y(t,v,M,_)}let i=w(2!=b.distr||null!=u?m[l]:l,b,k,x),s=y(Wt(n,H),v,M,_),a=A(i-I),o=A(Yt(s,O)),r=A(Bt(s,O)),c=o-r;if(null!=n){let i=n<0?it:nt,s=n<0?nt:it;G?(Y>0&&null!=X[l]&&$(q.get(X[l]),a,r+jt(Y/2),z,Yt(0,c-Y),i,s),null!=U[l]&&$(K.get(U[l]),a,r+jt(Y/2),z,Yt(0,c-Y),i,s)):$(et,a,r+jt(Y/2),z,Yt(0,c-Y),i,s),V(t,e,l,a-Y/2,r,z+Y,c)}}return Y>0?tt.stroke=G?q:et:G||(tt._fill=0==p.width?p._fill:null!=(T=p._stroke)?T:p._fill,tt.width=0),tt.fill=G?K:et,tt})},t.spline=function(t){return function(t,e){const l=Wt(null==e?void 0:e.alignGaps,0);return(e,n,i,s)=>Xl(e,n,(a,o,r,u,c,h,d,f,p,m,g)=>{[i,s]=Tt(r,i,s);let b,v,w,y=a.pxRound,x=t=>y(h(t,u,m,f)),_=t=>y(d(t,c,g,p));0==u.ori?(b=nn,w=an,v=dn):(b=sn,w=on,v=fn);const k=u.dir*(0==u.ori?1:-1);let M=x(o[1==k?i:s]),S=M,T=[],C=[];for(let t=1==k?i:s;t>=i&&t<=s;t+=k)if(null!=r[t]){let e=x(o[t]);T.push(S=e),C.push(_(r[t]))}const D={stroke:t(T,C,b,w,v,y),fill:null,clip:null,band:null,gaps:null,flags:1},A=D.stroke;let[E,N]=ql(e,n);if(null!=a.fill||0!=E){let t=D.fill=new Path2D(A),l=_(a.fillTo(e,n,a.min,a.max,E));w(t,S,l),w(t,M,l)}if(!a.spanGaps){let t=[];t.push(...tn(o,r,i,s,k,x,l)),D.gaps=t=a.gaps(e,n,i,s,t),D.clip=Ql(t,u.ori,f,p,m,g)}return 0!=N&&(D.band=2==N?[Zl(e,n,i,s,A,-1),Zl(e,n,i,s,A,1)]:Zl(e,n,i,s,A,N)),D})}(yn,t)}}const Fn="[KurvaSUPlot]",$n={height:520,enableCostView:!0};class Vn{constructor(t,e={}){this.state=t,this.options=r(r({},$n),e),this.viewMode="progress",this.chartInstance=null,this.container=null,this.tooltipEl=null,this.resizeHandler=null,this.resizeObserver=null,this.themeObserver=null,this.currentDataset=null,this.costData=null,this.isLoadingCostData=!1,this._interactionAttached=!1,this._wheelHandler=null,this._interactionTarget=null,this._scaleBounds=null,this._dateFormatter=null}initialize(t){if(!t)return console.error(Fn,"Container element is required"),!1;this.container=t,"static"===getComputedStyle(t).position&&(this.container.style.position="relative"),this._createTooltip(),this.themeObserver=function(t){const e=new MutationObserver(e=>{e.forEach(e=>{if("attributes"===e.type&&"data-bs-theme"===e.attributeName){const e=document.documentElement.getAttribute("data-bs-theme");console.log("[ChartUtils] Theme changed to:",e),t(e)}})});return e.observe(document.documentElement,{attributes:!0,attributeFilter:["data-bs-theme"]}),e}(()=>this._rebuild()),this.resizeHandler=function(t,e=150){let l=null;return function(){l&&clearTimeout(l),l=setTimeout(()=>{t(),l=null},e)}}(()=>this.resize()),window.addEventListener("resize",this.resizeHandler),this.resizeObserver=function(t,e){if(!t||"undefined"==typeof ResizeObserver)return null;const l=new ResizeObserver(l=>{for(const n of l)n.target===t&&e(n.contentRect)});return l.observe(t),l}(t,()=>this.resize());return this.update()||console.warn(Fn,"Unable to render Kurva-S chart (no dataset)"),!0}update(t){const e=t||S(this.state);if(!e)return!1;this.currentDataset=e,this.viewMode=e.viewMode||this.viewMode||"progress";const l=this._transformDataset(e),n="dark"===(document.documentElement.getAttribute("data-bs-theme")||"light")?{text:"#f8fafc",axis:"#cbd5e1",plannedLine:"#60a5fa",plannedArea:"rgba(96, 165, 250, 0.15)",actualLine:"#34d399",actualArea:"rgba(52, 211, 153, 0.18)",costActualLine:"#f87171",costActualArea:"rgba(248, 113, 113, 0.18)",gridLine:"#334155",background:"#1e293b"}:{text:"#1f2937",axis:"#374151",plannedLine:"#0d6efd",plannedArea:"rgba(13, 110, 253, 0.12)",actualLine:"#198754",actualArea:"rgba(25, 135, 84, 0.12)",costActualLine:"#dc3545",costActualArea:"rgba(220, 53, 69, 0.12)",gridLine:"#e5e7eb",background:"#ffffff"};if(this.chartInstance)this.chartInstance.setData(l),this._updateScaleBounds();else{const t=this._buildChartOptions(e,n);this.chartInstance=new zn(t,l,this.container),this._updateScaleBounds(),this._attachInteractions()}return this._updateTooltipPosition(),!0}resize(){this.chartInstance&&this.container&&this.chartInstance.setSize({width:this.container.clientWidth||800,height:this.options.height})}toggleView(t){return c(this,null,function*(){const e=(t||("progress"===this.viewMode?"cost":"progress")).toLowerCase();if(e===this.viewMode)return!0;if("cost"===e){if(!this.options.enableCostView)return console.warn(Fn,"Cost view disabled on uPlot chart"),!1;if(!this.costData){if(!(yield this.fetchCostData()))return!1}const t=T(this.costData);return t?(this.viewMode="cost",this.update(t),!0):(console.warn(Fn,"Cost dataset not available"),!1)}return this.viewMode="progress",this.update(),!0})}renderMonthlyMode(t){if(!Array.isArray(t)||0===t.length)return console.warn(Fn,"Invalid monthly data"),!1;console.log(Fn,`Rendering monthly mode with ${t.length} months`);const e={labels:t.map(t=>t.label||`M${t.month}`),planned:t.map(t=>t.planned||0),actual:t.map(t=>t.actual||0),viewMode:"progress",granularity:"monthly"};return this.update(e)}renderWeeklyMode(t=null){if(console.log(Fn,"Restoring weekly mode"),t){const e={labels:t.map((t,e)=>`W${e+1}`),planned:t.map(t=>t.planned||0),actual:t.map(t=>t.actual||0),viewMode:"progress",granularity:"weekly"};return this.update(e)}return this.update()}dispose(){this._detachInteractions(),this.chartInstance&&(this.chartInstance.destroy(),this.chartInstance=null),this.resizeHandler&&(window.removeEventListener("resize",this.resizeHandler),this.resizeHandler=null),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),this.themeObserver&&(this.themeObserver.disconnect(),this.themeObserver=null),this.tooltipEl&&(this.tooltipEl.remove(),this.tooltipEl=null)}_rebuild(){this.container&&(this.chartInstance&&(this.chartInstance.destroy(),this.chartInstance=null),this.update(this.currentDataset))}fetchCostData(){return c(this,null,function*(){var t;if(!this.options.enableCostView)return console.log(Fn,"Cost view disabled"),null;const e=null==(t=this.state)?void 0:t.projectId;if(!e)return console.warn(Fn,"Cannot load cost data without project ID"),null;if(this.isLoadingCostData)return null;try{this.isLoadingCostData=!0;const t=`/detail_project/api/v2/project/${e}/kurva-s-harga/`,l=yield fetch(t,{method:"GET",headers:{"Content-Type":"application/json"}});if(!l.ok)throw new Error(`HTTP ${l.status}: ${l.statusText}`);const n=yield l.json();if(null==n?void 0:n.error)throw new Error(n.error);return this.costData=n,console.log(Fn,"Cost data loaded for uPlot chart"),n}catch(l){return console.error(Fn,"Failed to load cost data:",l),null}finally{this.isLoadingCostData=!1}})}_transformDataset(t){const e=t.labels.map((t,e)=>e),l=t.planned.map(t=>Number(t)||0);if("cost"===t.viewMode&&Array.isArray(t.acSeries)){return[e,l,t.acSeries.map(t=>Number(t)||0)]}return[e,l,t.actual.map(t=>Number(t)||0)]}_buildChartOptions(t,e){var l;const n="cost"===t.viewMode&&Array.isArray(t.acSeries);return{width:(null==(l=this.container)?void 0:l.clientWidth)||800,height:this.options.height,scales:{x:{time:!1},y:{auto:!0}},axes:[{stroke:e.axis,grid:{stroke:e.gridLine},values:(e,l)=>l.map(e=>{if(!Number.isFinite(e))return"";const l=Math.round(e);return Math.abs(e-l)>.01||l<0||l>=t.labels.length?"":t.labels[l]||`Week ${l+1}`})},{stroke:e.axis,grid:{stroke:e.gridLine},label:n?"% of Total Cost":"Progress %",values:(t,e)=>e.map(t=>`${Math.round(t)}%`)}],legend:{show:!0},series:[{},{label:n?"Rencana (PV)":"Rencana",stroke:e.plannedLine,width:2,fill:e.plannedArea},n?{label:"Realisasi (AC)",stroke:e.costActualLine||e.actualLine,width:3,fill:e.costActualArea||e.actualArea}:{label:"Realisasi",stroke:e.actualLine,width:2,fill:e.actualArea}],cursor:{drag:{x:!0,y:!1},focus:{prox:32}},select:{show:!0},hooks:{ready:[()=>{this._updateScaleBounds(),this._attachInteractions()}],setCursor:[t=>this._updateTooltip(t)],setScale:[()=>this._updateTooltipPosition()],dblclick:[t=>{const e=t.data[0][0],l=t.data[0][t.data[0].length-1];t.setScale("x",{min:e,max:l})}]}}}_attachInteractions(){if(this._interactionAttached||!this.chartInstance)return;const t=this.chartInstance.over||this.container;t&&(this._interactionTarget=t,this._wheelHandler=t=>this._handleWheelInteraction(t),t.addEventListener("wheel",this._wheelHandler,{passive:!1}),this._interactionAttached=!0)}_detachInteractions(){this._interactionAttached&&this._interactionTarget&&this._wheelHandler&&this._interactionTarget.removeEventListener("wheel",this._wheelHandler),this._interactionAttached=!1,this._wheelHandler=null,this._interactionTarget=null}_handleWheelInteraction(t){var e;if(!this.chartInstance||!this._scaleBounds)return;const l=t.ctrlKey||t.metaKey,n=!l&&t.shiftKey;if(!l&&!n)return;t.preventDefault();const i=this._scaleBounds,s=(null==(e=this.chartInstance.scales)?void 0:e.x)||{},a=Number.isFinite(s.min)?s.min:i.min,o=Number.isFinite(s.max)?s.max:i.max;if(l){const e=.12,l=t.deltaY>0?1:-1,n=Math.max(.2,1+e*l),i=(this.chartInstance.over||this.container).getBoundingClientRect(),s=t.clientX-i.left,r=this.chartInstance.posToVal(s,"x"),u=Number.isFinite(r)?r:(a+o)/2,c=u-(u-a)*n,h=u+(o-u)*n;return void this._setScaleBounded(c,h)}const r=o-a,u=Math.max(1,.15*r),c=t.deltaY>0?u:-u;this._setScaleBounded(a+c,o+c)}_setScaleBounded(t,e){if(!this.chartInstance||!this._scaleBounds)return;const l=this._scaleBounds,n=l.max-l.min;if(n<=0)return;let i=Math.min(t,e),s=Math.max(t,e),a=Math.max(1,s-i);a>n&&(a=n),i=Math.max(l.min,Math.min(i,l.max-a)),s=i+a,s>l.max&&(s=l.max,i=s-a),this.chartInstance.setScale("x",{min:i,max:s})}_updateScaleBounds(){var t;if(!this.chartInstance||!Array.isArray(null==(t=this.chartInstance.data)?void 0:t[0]))return;const e=this.chartInstance.data[0];e.length&&(this._scaleBounds={min:e[0],max:e[e.length-1]})}_createTooltip(){const t=document.createElement("div");t.className="kurva-s-tooltip",t.style.position="absolute",t.style.pointerEvents="none",t.style.padding="8px 10px",t.style.borderRadius="6px",t.style.background="rgba(15, 23, 42, 0.85)",t.style.color="#fff",t.style.fontSize="12px",t.style.transform="translate(-50%, -100%)",t.style.opacity="0",t.style.transition="opacity 0.15s ease",this.tooltipEl=t,this.container.appendChild(t)}_updateTooltip(t){var e,l,n,i,s,a,o;if(!this.tooltipEl||!this.currentDataset)return;const r=t.cursor.idx;if(null==r||r<0||r>=this.currentDataset.labels.length)return void(this.tooltipEl.style.opacity="0");const u=(this.currentDataset.labels||[])[r]||`Week ${r+1}`,c=null!=(e=this.currentDataset.planned[r])?e:0,h=Array.isArray(this.currentDataset.details)?this.currentDataset.details:null,d=!h&&this.currentDataset.details?this.currentDataset.details:{},f=Number(d.totalCost||this.currentDataset.totalBiaya||0)||0,p=Array.isArray(d.weeklySummary)?d.weeklySummary:null,m=p?p[r]:null,g=[`<div style="font-weight:600;margin-bottom:4px;">${u}</div>`];if("cost"===(this.viewMode||this.currentDataset.viewMode)){const t=null!=(l=(Array.isArray(this.currentDataset.acSeries)?this.currentDataset.acSeries:this.currentDataset.actual||[])[r])?l:0,e=null!=(n=null==m?void 0:m.variancePercent)?n:Number((t-c).toFixed(2)),i=Array.isArray(d.weeks)?d.weeks[r]:null,s=Array.isArray(d.actualWeeks)?d.actualWeeks[r]:null,a=this._formatWeekRange(i,s),o="number"==typeof(null==m?void 0:m.plannedCostValue)?_(m.plannedCostValue):this._resolveCostAmount(i,c,f),u="number"==typeof(null==m?void 0:m.actualCostValue)?_(m.actualCostValue):this._resolveCostAmount(s,t,f),h="number"==typeof(null==m?void 0:m.varianceCostValue)?_(m.varianceCostValue):"",p=this._getVarianceColor(e);a&&g.push(`<div style="font-size:0.85em;color:#cbd5e1;margin-bottom:4px;">Periode: ${a}</div>`),g.push(`<div>Rencana (PV): <strong>${x(c)}</strong> <span style="color:#cbd5e1;font-size:0.85em;">(${o})</span></div>`,`<div>Realisasi (AC): <strong>${x(t)}</strong> <span style="color:#cbd5e1;font-size:0.85em;">(${u})</span></div>`,`<div>Variance: <strong style="color:${p};">${e>=0?"+":""}${e.toFixed(1)}%</strong>${h?` <span style="color:${p};font-size:0.85em;">(${h})</span>`:""}</div>`)}else{const t=null!=(i=this.currentDataset.actual[r])?i:0,e=Number((t-c).toFixed(2)),l=h?h[r]:null,n=(null==l?void 0:l.start)?this._formatDateLabel(l.start):"",s=(null==l?void 0:l.end)?this._formatDateLabel(l.end):"",a=this._composeRangeText(n,s),o=Boolean(this.currentDataset.useHargaCalculation&&f>0),u="number"==typeof(null==l?void 0:l.plannedCostValue)?l.plannedCostValue:f*c/100,d="number"==typeof(null==l?void 0:l.actualCostValue)?l.actualCostValue:f*t/100,p=o?_(u||0):"",m=o?_(d||0):"",b=o&&"number"==typeof(null==l?void 0:l.varianceCostValue)?_(l.varianceCostValue):o?_((d||0)-(u||0)):"",v=this._getVarianceColor(e);a&&g.push(`<div style="font-size:0.85em;color:#cbd5e1;margin-bottom:4px;">Periode: ${a}</div>`),g.push(`<div>Rencana: <strong>${x(c)}</strong>${o?` <span style="color:#cbd5e1;font-size:0.85em;">(${p})</span>`:""}</div>`),g.push(`<div>Realisasi: <strong>${x(t)}</strong>${o?` <span style="color:#cbd5e1;font-size:0.85em;">(${m})</span>`:""}</div>`),g.push(`<div>Variance: <strong style="color:${v};">${e>=0?"+":""}${e.toFixed(1)}%</strong>${o?` <span style="color:${v};font-size:0.85em;">(${b})</span>`:""}</div>`)}this.tooltipEl.innerHTML=g.join("");const b=t.data[0][r],v=t.valToPos(b,"x"),w=Math.min(2,t.data.length-1);let y=null==(s=t.data[w])?void 0:s[r];Number.isFinite(y)||(y=null!=(o=null==(a=t.data[1])?void 0:a[r])?o:0);const k=t.valToPos(y,"y");this.tooltipEl.style.left=`${v}px`,this.tooltipEl.style.top=`${k}px`,this.tooltipEl.style.opacity="1"}_updateTooltipPosition(){if(!this.chartInstance||!this.tooltipEl)return;const{idx:t}=this.chartInstance.cursor;null!=t&&this._updateTooltip(this.chartInstance)}_formatDateLabel(t){if(!t)return"";let e=t;if(t instanceof Date||(e=new Date(t)),!(e instanceof Date)||Number.isNaN(e.getTime()))return"";if(!this._dateFormatter&&"undefined"!=typeof Intl&&"function"==typeof Intl.DateTimeFormat)try{this._dateFormatter=new Intl.DateTimeFormat("id-ID",{day:"2-digit",month:"short",year:"numeric"})}catch(l){console.warn(Fn,"Intl.DateTimeFormat unavailable, falling back to basic formatter:",l),this._dateFormatter=null}if(this._dateFormatter)return this._dateFormatter.format(e);return`${String(e.getDate()).padStart(2,"0")}/${String(e.getMonth()+1).padStart(2,"0")}/${e.getFullYear()}`}_formatWeekRange(t,e){const l=(null==t?void 0:t.week_start)||(null==e?void 0:e.week_start),n=(null==t?void 0:t.week_end)||(null==e?void 0:e.week_end),i=l?this._formatDateLabel(new Date(l)):"",s=n?this._formatDateLabel(new Date(n)):"";return this._composeRangeText(i,s)}_composeRangeText(t,e){return t&&e?`${t} - ${e}`:t||e||""}_getVarianceColor(t){return t>.1?"#f87171":t<-.1?"#22c55e":"#cbd5e1"}_resolveCostAmount(t,e,l){if(t){const e=this._parseNumber(t.cumulative_cost);if(Number.isFinite(e)&&e>0)return _(e);const l=this._parseNumber(t.cost);if(Number.isFinite(l)&&l>0)return _(l)}return!Number.isFinite(l)||l<=0?_(0):_(l*e/100)}_parseNumber(t){if("number"==typeof t)return t;if("string"==typeof t){const e=Number(t);return Number.isFinite(e)?e:NaN}return NaN}}const Rn=Object.freeze(Object.defineProperty({__proto__:null,KurvaSUPlotChart:Vn,default:Vn},Symbol.toStringTag,{value:"Module"}));export{L as B,p as G,N as K,W as T,b as a,S as b,Rn as c,E as d,v as g,I as i,zn as u};
