[pytest]
DJANGO_SETTINGS_MODULE = config.settings.test
python_files = tests.py test_*.py *_tests.py

# Addopts: Fokus pada detail_project (core business logic)
# Target coverage 60% (realistis untuk saat ini, akan ditingkatkan bertahap)
addopts =
    -q
    -rs
    -ra
    --cov=detail_project
    --cov-report=term-missing:skip-covered
    --cov-fail-under=60
    --tb=short
    --strict-markers
    # NOTE: --reuse-db removed because it causes database lock issues
    # with file-based SQLite. Database is recreated for each test run.

# Test markers untuk selective testing
markers =
    e2e: end-to-end tests (selenium)
    slow: marks tests as slow (deselect with '-m "not slow"')
    integration: integration tests requiring full setup
    unit: unit tests (fast, isolated)
    api: API endpoint tests
    ui: UI/template tests
    security: security-related tests
    deprecated: tests for deprecated features (will be removed)

# Filter warnings
filterwarnings =
    ignore:'maxsplit' is passed as positional argument:DeprecationWarning:widget_tweaks.templatetags.widget_tweaks
    ignore:ast.NameConstant is deprecated:DeprecationWarning:reportlab
    ignore:datetime.datetime.utcnow:DeprecationWarning

